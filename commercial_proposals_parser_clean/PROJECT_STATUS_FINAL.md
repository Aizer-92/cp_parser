# üìã –§–ò–ù–ê–õ–¨–ù–´–ô –°–¢–ê–¢–£–° –ü–†–û–ï–ö–¢–ê COMMERCIAL PROPOSALS PARSER

## üéØ –¢–ï–ö–£–©–ï–ï –°–û–°–¢–û–Ø–ù–ò–ï (–Ω–∞ 24.09.2025)

### ‚úÖ –ó–ê–í–ï–†–®–ï–ù–ù–´–ï –ó–ê–î–ê–ß–ò

#### 1. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫ –ø–∞—Ä—Å–∏–Ω–≥–∞
- ‚úÖ **–¢–æ–≤–∞—Ä ID 444**: –£—Å—Ç—Ä–∞–Ω–µ–Ω—ã —Ñ–∞–Ω—Ç–æ–º–Ω—ã–µ —Ç–∏—Ä–∞–∂–∏ –∏ —Ü–µ–Ω—ã
- ‚úÖ **–ú–∞—Å—Å–æ–≤–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**: 6 —Ç–æ–≤–∞—Ä–æ–≤ —Å –ø–æ—Ö–æ–∂–∏–º–∏ –ø—Ä–æ–±–ª–µ–º–∞–º–∏ (ID 112, 113, 441, 442, 454, 455)
- ‚úÖ **10 —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫**: –í—Å–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã (ID 436, 367, 22, 460, 458, 427, 50, 51, 303, 423, 444, 452)

#### 2. –£–ª—É—á—à–µ–Ω–∏–µ –ø–∞—Ä—Å–µ—Ä–∞
- ‚úÖ **–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–æ–ª–æ–Ω–æ–∫ –ø–æ –∑–∞–≥–æ–ª–æ–≤–∫–∞–º** –≤–º–µ—Å—Ç–æ —Ç–æ–ª—å–∫–æ –ø–æ–∑–∏—Ü–∏–∏
- ‚úÖ **–í–∞–ª–∏–¥–∞—Ü–∏—è –∑–Ω–∞—á–µ–Ω–∏–π** (—Ç–∏—Ä–∞–∂–∏ 10-100000, —Ü–µ–Ω—ã $0.1-500)
- ‚úÖ **–û–±—Ä–∞–±–æ—Ç–∫–∞ Custom –ø–æ–ª–µ–π** –∏–∑ –∞–Ω–≥–ª–∏–π—Å–∫–∏—Ö —Ç–∞–±–ª–∏—Ü
- ‚úÖ **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –ø—É—Ç–µ–π** –≤ `local_file_path`

#### 3. –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
- ‚úÖ **–î–µ—Ç–∞–ª—å–Ω—ã–µ –∫–∞—Ä—Ç–æ—á–∫–∏ —Ç–æ–≤–∞—Ä–æ–≤**: —É–±—Ä–∞–Ω—ã —ç–º–æ–¥–∑–∏, –¥–æ–±–∞–≤–ª–µ–Ω—ã Custom –ø–æ–ª—è
- ‚úÖ **–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç–æ–≤**: –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π, —Å—Å—ã–ª–æ–∫ –Ω–∞ Google Sheets
- ‚úÖ **–§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**: –¥–æ–ª–ª–∞—Ä—ã —Å 1 –∑–Ω–∞–∫–æ–º, —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫

---

## üìä –°–¢–ê–¢–ò–°–¢–ò–ö–ê –ë–ê–ó–´ –î–ê–ù–ù–´–•

```
üìà –û–ë–©–ê–Ø –°–¢–ê–¢–ò–°–¢–ò–ö–ê:
   ‚Ä¢ –í—Å–µ–≥–æ —Ç–æ–≤–∞—Ä–æ–≤: 128
   ‚Ä¢ –í—Å–µ–≥–æ —Ç–∞–±–ª–∏—Ü: 40
   ‚Ä¢ –í—Å–µ–≥–æ —Ü–µ–Ω: 365
   ‚Ä¢ –í—Å–µ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π: 410

üí∞ –ü–û–ö–†–´–¢–ò–ï –¶–ï–ù–ê–ú–ò:
   ‚Ä¢ –¢–æ–≤–∞—Ä—ã —Å —Ü–µ–Ω–∞–º–∏: 121 (94.5%)
   ‚Ä¢ –¢–æ–≤–∞—Ä—ã –±–µ–∑ —Ü–µ–Ω: 7

üñºÔ∏è –ü–û–ö–†–´–¢–ò–ï –ò–ó–û–ë–†–ê–ñ–ï–ù–ò–Ø–ú–ò:
   ‚Ä¢ –¢–æ–≤–∞—Ä—ã —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏: 125 (97.7%)
   ‚Ä¢ –¢–æ–≤–∞—Ä—ã –±–µ–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π: 3

üîç –ö–ê–ß–ï–°–¢–í–û –î–ê–ù–ù–´–•:
   ‚Ä¢ –¢–æ–≤–∞—Ä—ã —Å –∞–Ω–æ–º–∞–ª—å–Ω—ã–º–∏ —Ç–∏—Ä–∞–∂–∞–º–∏ (>50k): 0
   ‚Ä¢ –¢–æ–≤–∞—Ä—ã —Å –∞–Ω–æ–º–∞–ª—å–Ω—ã–º–∏ —Ü–µ–Ω–∞–º–∏ (>$500): 0
   ‚Ä¢ –¢–æ–≤–∞—Ä—ã —Å–æ —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–∏–º –∫–æ–ª-–≤–æ–º —Ü–µ–Ω (>10): 1
```

---

## üîß –§–ò–ù–ê–õ–¨–ù–´–ô –ü–ê–†–°–ï–†

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ–∞–π–ª—ã:
1. **`scripts/improved_parser_v5.py`** - –£–ª—É—á—à–µ–Ω–Ω—ã–π –ø–∞—Ä—Å–µ—Ä —Å –≥–∏–±–∫–∏–º –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ–º –∫–æ–ª–æ–Ω–æ–∫
2. **`scripts/complete_parsing_pipeline_v5.py`** - –û—Å–Ω–æ–≤–Ω–æ–π –ø–∞–π–ø–ª–∞–π–Ω –ø–∞—Ä—Å–∏–Ω–≥–∞
3. **`database/models_v4.py`** - –ú–æ–¥–µ–ª–∏ –ë–î —Å –ø–æ–ª–µ–º `custom_design`
4. **`web_app_v4/main.py`** - –í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º

### –ö–ª—é—á–µ–≤—ã–µ —É–ª—É—á—à–µ–Ω–∏—è:
```python
# –ì–∏–±–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–æ–ª–æ–Ω–æ–∫ –ø–æ –∑–∞–≥–æ–ª–æ–≤–∫–∞–º
def find_columns_by_headers(worksheet, max_header_rows=5):
    column_mapping = {
        'name': ['–Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ', '–Ω–∞–∑–≤–∞–Ω–∏–µ', '—Ç–æ–≤–∞—Ä', 'item', 'title', 'description', 'goods'],
        'quantity': ['—Ç–∏—Ä–∞–∂', '–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ', '—à—Ç', 'quantity', 'qty', 'pieces'],
        'price_usd': ['—Ü–µ–Ω–∞', 'price', 'usd', '$', '—Å—Ç–æ–∏–º–æ—Å—Ç—å', 'cost'],
        'delivery': ['—Å—Ä–æ–∫', '–¥–æ—Å—Ç–∞–≤–∫–∞', 'delivery', '–¥–Ω–∏', 'days', '–∫.–¥'],
        'material': ['–º–∞—Ç–µ—Ä–∏–∞–ª', 'material', '—Å–æ—Å—Ç–∞–≤'],
        'custom': ['–∫–∞—Å—Ç–æ–º', 'custom', '–¥–∏–∑–∞–π–Ω']
    }
```

---

## üöÄ –ò–ù–°–¢–†–£–ö–¶–ò–ò –î–õ–Ø –ü–†–û–î–û–õ–ñ–ï–ù–ò–Ø –ü–ê–†–°–ò–ù–ì–ê

### 1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Å—Ä–µ–¥—ã
```bash
cd /path/to/projects/commercial_proposals_parser_clean
source venv/bin/activate
```

### 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ë–î
python3 scripts/final_validation_report.py

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–∞–∫–∏–µ —Ç–∞–±–ª–∏—Ü—ã —É–∂–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã
python3 -c "
from database.manager_v4 import DatabaseManager
from database.models_v4 import SheetMetadata
session = DatabaseManager.get_session()
processed = session.query(SheetMetadata).filter(SheetMetadata.parsing_status == 'completed').count()
total = session.query(SheetMetadata).count()
print(f'–û–±—Ä–∞–±–æ—Ç–∞–Ω–æ: {processed}/{total} —Ç–∞–±–ª–∏—Ü')
session.close()
"
```

### 3. –ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ –ø–∞—Ä—Å–∏–Ω–≥–∞
```bash
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —É–ª—É—á—à–µ–Ω–Ω—ã–π –ø–∞—Ä—Å–µ—Ä –¥–ª—è –æ—Å—Ç–∞–≤—à–∏—Ö—Å—è —Ç–∞–±–ª–∏—Ü
python3 scripts/complete_parsing_pipeline_v5.py

# –ò–ª–∏ –ø–∞—Ä—Å–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é —Ç–∞–±–ª–∏—Ü—É
python3 -c "
from scripts.complete_parsing_pipeline_v5 import parse_single_sheet
parse_single_sheet('URL_GOOGLE_SHEETS')
"
```

### 4. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∫–∞—á–µ—Å—Ç–≤–∞
```bash
# –ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–π –ø–∞—Ä—Ç–∏–∏ –ø–∞—Ä—Å–∏–Ω–≥–∞ –ø—Ä–æ–≤–µ—Ä—è—Ç—å –∫–∞—á–µ—Å—Ç–≤–æ
python3 scripts/database_validation_analysis.py
```

---

## üìã –û–°–¢–ê–í–®–ò–ï–°–Ø –ó–ê–î–ê–ß–ò

### üîÑ –ü–†–ò–û–†–ò–¢–ï–¢ 1: –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –ø–∞—Ä—Å–∏–Ω–≥
- **–°—Ç–∞—Ç—É—Å**: ~40 —Ç–∞–±–ª–∏—Ü –≤ –º–∞—Å—Ç–µ—Ä-–ª–∏—Å—Ç–µ, –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ —á–∞—Å—Ç–∏—á–Ω–æ
- **–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç**: `scripts/complete_parsing_pipeline_v5.py`
- **–¶–µ–ª—å**: –î–æ–≤–µ—Å—Ç–∏ –ø–æ–∫—Ä—ã—Ç–∏–µ —Ü–µ–Ω–∞–º–∏ –¥–æ 98%+

### üîç –ü–†–ò–û–†–ò–¢–ï–¢ 2: –í–∞–ª–∏–¥–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å 7 —Ç–æ–≤–∞—Ä–æ–≤ –±–µ–∑ —Ü–µ–Ω
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å 3 —Ç–æ–≤–∞—Ä–∞ –±–µ–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- –£–±–µ–¥–∏—Ç—å—Å—è –≤ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –Ω–æ–≤—ã—Ö –∞–Ω–æ–º–∞–ª–∏–π

### üé® –ü–†–ò–û–†–ò–¢–ï–¢ 3: –§–∏–Ω–∞–ª—å–Ω–∞—è –ø–æ–ª–∏—Ä–æ–≤–∫–∞
- –î–æ–±–∞–≤–∏—Ç—å –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–µ Custom –ø–æ–ª—è
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –≤—Å–µ—Ö —Å—Å—ã–ª–æ–∫ –Ω–∞ Google Sheets
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

---

## üóÇÔ∏è –°–¢–†–£–ö–¢–£–†–ê –ü–†–û–ï–ö–¢–ê

```
commercial_proposals_parser_clean/
‚îú‚îÄ‚îÄ database/
‚îÇ   ‚îú‚îÄ‚îÄ models_v4.py          # ‚úÖ –§–∏–Ω–∞–ª—å–Ω—ã–µ –º–æ–¥–µ–ª–∏ –ë–î
‚îÇ   ‚îî‚îÄ‚îÄ manager_v4.py         # ‚úÖ –ú–µ–Ω–µ–¥–∂–µ—Ä –ë–î
‚îú‚îÄ‚îÄ scripts/
‚îÇ   ‚îú‚îÄ‚îÄ complete_parsing_pipeline_v5.py  # üîß –û–°–ù–û–í–ù–û–ô –ü–ê–†–°–ï–†
‚îÇ   ‚îú‚îÄ‚îÄ improved_parser_v5.py           # üîß –£–õ–£–ß–®–ï–ù–ù–´–ô –ü–ê–†–°–ï–†
‚îÇ   ‚îú‚îÄ‚îÄ final_validation_report.py      # üìä –û—Ç—á–µ—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ database_validation_analysis.py # üîç –í–∞–ª–∏–¥–∞—Ü–∏—è
‚îú‚îÄ‚îÄ web_app_v4/
‚îÇ   ‚îú‚îÄ‚îÄ main.py              # ‚úÖ –í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îÇ   ‚îî‚îÄ‚îÄ templates/           # ‚úÖ –®–∞–±–ª–æ–Ω—ã —Å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è–º–∏
‚îî‚îÄ‚îÄ storage/
    ‚îî‚îÄ‚îÄ excel_files/         # üìÅ –°–∫–∞—á–∞–Ω–Ω—ã–µ Excel —Ñ–∞–π–ª—ã
```

---

## üö® –í–ê–ñ–ù–´–ï –ó–ê–ú–ï–ß–ê–ù–ò–Ø

### ‚ö†Ô∏è –ü—Ä–æ–±–ª–µ–º—ã, –∫–æ—Ç–æ—Ä—ã–µ –†–ï–®–ï–ù–´:
1. ‚úÖ –§–∞–Ω—Ç–æ–º–Ω—ã–µ —Ç–∏—Ä–∞–∂–∏ –∏ —Ü–µ–Ω—ã (—Ç–æ–≤–∞—Ä ID 444 –∏ –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã–µ)
2. ‚úÖ –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–æ–ª–æ–Ω–æ–∫ –ø–æ –ø–æ–∑–∏—Ü–∏–∏
3. ‚úÖ –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö
4. ‚úÖ –ü—Ä–æ–±–ª–µ–º—ã —Å Custom –ø–æ–ª—è–º–∏ –∏–∑ –∞–Ω–≥–ª–∏–π—Å–∫–∏—Ö —Ç–∞–±–ª–∏—Ü
5. ‚úÖ –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—É—Ç–µ–π –≤ `local_file_path`

### ‚úÖ –ü–∞—Ä—Å–µ—Ä –≥–æ—Ç–æ–≤ –∫ –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—é —Ä–∞–±–æ—Ç—ã:
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –∑–∞–≥–æ–ª–æ–≤–∫–∏ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∫–æ–ª–æ–Ω–æ–∫
- –í–∞–ª–∏–¥–∏—Ä—É–µ—Ç –≤—Å–µ –∏–∑–≤–ª–µ–∫–∞–µ–º—ã–µ –¥–∞–Ω–Ω—ã–µ
- –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã —Ç–∞–±–ª–∏—Ü
- –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∏–∑–≤–ª–µ–∫–∞–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏ —Ü–µ–Ω—ã

### üéØ –°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:
**–ó–∞–ø—É—Å—Ç–∏—Ç—å `python3 scripts/complete_parsing_pipeline_v5.py` –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è –ø–∞—Ä—Å–∏–Ω–≥–∞ –æ—Å—Ç–∞–≤—à–∏—Ö—Å—è —Ç–∞–±–ª–∏—Ü –∏–∑ –º–∞—Å—Ç–µ—Ä-–ª–∏—Å—Ç–∞.**

---

## üìû –ö–û–ù–¢–ï–ö–°–¢ –î–õ–Ø –ù–û–í–û–ì–û –ß–ê–¢–ê

**–°–∏—Ç—É–∞—Ü–∏—è**: –ü—Ä–æ–µ–∫—Ç –ø–∞—Ä—Å–∏–Ω–≥–∞ –∫–æ–º–º–µ—Ä—á–µ—Å–∫–∏—Ö –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π –∏–∑ Google Sheets –≤ —Å—Ç–∞–¥–∏–∏ —Ñ–∏–Ω–∞–ª–∏–∑–∞—Ü–∏–∏. –û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã —Ä–µ—à–µ–Ω—ã, –ø–∞—Ä—Å–µ—Ä —É–ª—É—á—à–µ–Ω –∏ –≥–æ—Ç–æ–≤ –∫ –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—é —Ä–∞–±–æ—Ç—ã.

**–ó–∞–¥–∞—á–∞**: –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –ø–∞—Ä—Å–∏–Ω–≥ –æ—Å—Ç–∞–≤—à–∏—Ö—Å—è ~30 —Ç–∞–±–ª–∏—Ü –∏–∑ –º–∞—Å—Ç–µ—Ä-–ª–∏—Å—Ç–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —É–ª—É—á—à–µ–Ω–Ω–æ–≥–æ –ø–∞—Ä—Å–µ—Ä–∞ `complete_parsing_pipeline_v5.py`.

**–¶–µ–ª—å**: –î–æ–≤–µ—Å—Ç–∏ –ø–æ–∫—Ä—ã—Ç–∏–µ —Ç–æ–≤–∞—Ä–æ–≤ —Ü–µ–Ω–∞–º–∏ —Å 94.5% –¥–æ 98%+ –∏ –∑–∞–≤–µ—Ä—à–∏—Ç—å –ø–∞—Ä—Å–∏–Ω–≥ –≤—Å–µ—Ö –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü.

---

*–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ: 24.09.2025*
*–°—Ç–∞—Ç—É—Å: –ì–æ—Ç–æ–≤ –∫ –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—é –ø–∞—Ä—Å–∏–Ω–≥–∞*
