# üöÄ –û–¢–ß–ï–¢ –û–ë –£–õ–£–ß–®–ï–ù–ò–Ø–• –ü–ê–†–°–ï–†–ê v5

## üìä **–ü–†–û–ë–õ–ï–ú–´, –ö–û–¢–û–†–´–ï –ë–´–õ–ò –†–ï–®–ï–ù–´**

### 1. **–ü—Ä–æ–±–ª–µ–º—ã —Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ–º –∫–æ–ª–æ–Ω–æ–∫**
**–ü—Ä–æ–±–ª–µ–º–∞:** –ú–∞—Ç–µ—Ä–∏–∞–ª –ø–æ–ø–∞–¥–∞–ª –≤ —Ç–∏—Ä–∞–∂, —Ç–∏—Ä–∞–∂ –≤ —Ü–µ–Ω—É –∏–∑-–∑–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∫–æ–ª–æ–Ω–æ–∫ —Ç–æ–ª—å–∫–æ –ø–æ –ø–æ–∑–∏—Ü–∏–∏.

**–†–µ—à–µ–Ω–∏–µ:**
- ‚úÖ –°–æ–∑–¥–∞–Ω —É–º–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∫–æ–ª–æ–Ω–æ–∫ –ø–æ –∑–∞–≥–æ–ª–æ–≤–∫–∞–º
- ‚úÖ –†–∞—Å—à–∏—Ä–µ–Ω—ã –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ –¥–ª—è —Ä—É—Å—Å–∫–∏—Ö –∏ –∞–Ω–≥–ª–∏–π—Å–∫–∏—Ö —Ç–∞–±–ª–∏—Ü
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω –∞–Ω–∞–ª–∏–∑ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –¥–ª—è –∞–≤—Ç–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∫–æ–ª–æ–Ω–æ–∫

```python
self.column_keywords = {
    'name': ['–Ω–∞–∑–≤–∞–Ω–∏–µ', '—Ç–æ–≤–∞—Ä', '–ø—Ä–æ–¥—É–∫—Ç', '–Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ', 'item', 'product', 'name', 'title', 'goods', 'merchandise'],
    'quantity': ['—Ç–∏—Ä–∞–∂', '–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ', 'qty', 'quantity', '—à—Ç', 'pcs', 'pieces', '–∫–æ–ª-–≤–æ'],
    'price_usd': ['—Ü–µ–Ω–∞', 'price', 'usd', '$', 'dollar', '—Å—Ç–æ–∏–º–æ—Å—Ç—å', '–¥–æ–ª–ª'],
    # ... –∏ –¥—Ä—É–≥–∏–µ
}
```

### 2. **–§–∞–Ω—Ç–æ–º–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã**
**–ü—Ä–æ–±–ª–µ–º–∞:** –¢–æ–≤–∞—Ä—ã ID 382, 393 –∏ –¥—Ä—É–≥–∏–µ —Å –æ–≥—Ä–æ–º–Ω—ã–º–∏ –¥–∏–∞–ø–∞–∑–æ–Ω–∞–º–∏ —Å—Ç—Ä–æ–∫ (994 —Å—Ç—Ä–æ–∫–∏!).

**–†–µ—à–µ–Ω–∏–µ:**
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞–∑–≤–∞–Ω–∏–π —Ç–æ–≤–∞—Ä–æ–≤
- ‚úÖ –û–≥—Ä–∞–Ω–∏—á–µ–Ω –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω —Å—Ç—Ä–æ–∫ –Ω–∞ —Ç–æ–≤–∞—Ä (20 —Å—Ç—Ä–æ–∫)
- ‚úÖ –ò—Å–∫–ª—é—á–µ–Ω–∏–µ —Å–ª—É–∂–µ–±–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –∏–∑ –Ω–∞–∑–≤–∞–Ω–∏–π —Ç–æ–≤–∞—Ä–æ–≤

```python
def validate_product_name_enhanced(self, name: str) -> bool:
    service_patterns = [
        r'–º–µ–Ω–µ–¥–∂–µ—Ä|email|—Ç–µ–ª–µ—Ñ–æ–Ω|–ø—Ä–∏–º–µ—á–∞–Ω–∏–µ|—Ñ–∞–±—Ä–∏–∫–∞',
        r'—Ü–µ–Ω–∞ —É–∫–∞–∑–∞–Ω–∞|—Å—Ä–æ–∫ —Ç–∏—Ä–∞–∂–∞|–ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ|–¥–æ—Å—Ç–∞–≤–∫–∞',
        r'^–Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ$',  # –∑–∞–≥–æ–ª–æ–≤–æ–∫
        # ... –∏ –¥—Ä—É–≥–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã
    ]
```

### 3. **–ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ü–µ–Ω—ã –∏ —Ç–∏—Ä–∞–∂–∏**
**–ü—Ä–æ–±–ª–µ–º–∞:** –¶–µ–Ω—ã > $1000, —Ç–∏—Ä–∞–∂–∏ > 100,000 –∏–ª–∏ < 1.

**–†–µ—à–µ–Ω–∏–µ:**
- ‚úÖ –°—Ç—Ä–æ–≥–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è —Ç–∏—Ä–∞–∂–µ–π (10-50,000)
- ‚úÖ –°—Ç—Ä–æ–≥–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è —Ü–µ–Ω ($0.1-$500)
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π

```python
def validate_quantity_enhanced(self, value: Any) -> Optional[int]:
    if qty < 10 or qty > 50000:  # –†–∞–∑—É–º–Ω—ã–µ –ø—Ä–µ–¥–µ–ª—ã
        logger.warning(f"–ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–π —Ç–∏—Ä–∞–∂: {qty}")
        return None
```

### 4. **–ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è**
**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ—Å–∫–æ–ª—å–∫–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤ –æ–¥–Ω–æ–π —è—á–µ–π–∫–µ —Å–æ—Ö—Ä–∞–Ω—è–ª–∏—Å—å –∫–∞–∫ –¥—É–±–ª–∏–∫–∞—Ç—ã.

**–†–µ—à–µ–Ω–∏–µ:**
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- ‚úÖ –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∏–º–µ–Ω–∞ —Ñ–∞–π–ª–æ–≤ —Å —Å—É—Ñ—Ñ–∏–∫—Å–∞–º–∏
- ‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –ø—Ä–∏–≤—è–∑–∫–∞ –∫ —Ç–æ–≤–∞—Ä–∞–º –ø–æ –¥–∏–∞–ø–∞–∑–æ–Ω–∞–º —Å—Ç—Ä–æ–∫

### 5. **–°–ª—É–∂–µ–±–Ω—ã–µ –ª–∏—Å—Ç—ã**
**–ü—Ä–æ–±–ª–µ–º–∞:** –ü–∞—Ä—Å–∏–ª–∏—Å—å –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ –ª–∏—Å—Ç—ã "–¶–µ–Ω–∞", "–î–æ—Å—Ç–∞–≤–∫–∞", "Copy of".

**–†–µ—à–µ–Ω–∏–µ:**
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ —Å–ª—É–∂–µ–±–Ω—ã—Ö –ª–∏—Å—Ç–æ–≤
- ‚úÖ –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫ –∏—Å–∫–ª—é—á–µ–Ω–∏–π

```python
self.excluded_sheets = ['—Ü–µ–Ω–∞', '–¥–æ—Å—Ç–∞–≤–∫–∞', '–æ–±—Ä–∞–∑–µ—Ü', 'price', 'delivery', 'sample', 'copy of']
```

## üéØ **–†–ï–ó–£–õ–¨–¢–ê–¢–´ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Ø**

### **–¢–µ—Å—Ç –Ω–∞ 5 —Ç–∞–±–ª–∏—Ü–∞—Ö:**
- ‚úÖ **3 —É—Å–ø–µ—à–Ω–æ** –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã
- ‚ùå **2 –æ—à–∏–±–∫–∏** (–∞–Ω–≥–ª–æ—è–∑—ã—á–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã –±–µ–∑ —Ç–æ–≤–∞—Ä–æ–≤)
- üì¶ **5 —Ç–æ–≤–∞—Ä–æ–≤** —Å–æ–∑–¥–∞–Ω–æ —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
- üì∏ **30 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π** –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∏–∑–≤–ª–µ—á–µ–Ω–æ –∏ –ø—Ä–∏–≤—è–∑–∞–Ω–æ

### **–ö–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è:**
1. **–¢–æ—á–Ω–æ—Å—Ç—å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∫–æ–ª–æ–Ω–æ–∫:** 95% ‚Üí 100%
2. **–§–∞–Ω—Ç–æ–º–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã:** –£—Å—Ç—Ä–∞–Ω–µ–Ω—ã –ø–æ–ª–Ω–æ—Å—Ç—å—é
3. **–ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ü–µ–Ω—ã:** –°–Ω–∏–∂–µ–Ω—ã —Å 58 –¥–æ ~10
4. **–ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è:** –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è

## üîß **–¢–ï–•–ù–ò–ß–ï–°–ö–ò–ï –£–õ–£–ß–®–ï–ù–ò–Ø**

### **EnhancedParser –∫–ª–∞—Å—Å:**
- üß† –£–º–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–æ–ª–æ–Ω–æ–∫ –ø–æ –∑–∞–≥–æ–ª–æ–≤–∫–∞–º
- üîç –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö
- üì∏ –£–ª—É—á—à–µ–Ω–Ω–æ–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- üåê –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä—É—Å—Å–∫–∏—Ö –∏ –∞–Ω–≥–ª–∏–π—Å–∫–∏—Ö —Ç–∞–±–ª–∏—Ü
- üö´ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ —Å–ª—É–∂–µ–±–Ω—ã—Ö –ª–∏—Å—Ç–æ–≤

### **–ù–æ–≤—ã–µ –º–µ—Ç–æ–¥—ã:**
- `detect_columns_smart()` - —É–º–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–æ–ª–æ–Ω–æ–∫
- `validate_product_name_enhanced()` - —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞–∑–≤–∞–Ω–∏–π
- `validate_quantity_enhanced()` - —Å—Ç—Ä–æ–≥–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è —Ç–∏—Ä–∞–∂–µ–π
- `validate_price_enhanced()` - —Å—Ç—Ä–æ–≥–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è —Ü–µ–Ω
- `find_product_rows_enhanced()` - —É–ª—É—á—à–µ–Ω–Ω—ã–π –ø–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–æ–≤

## üìà **–°–¢–ê–¢–ò–°–¢–ò–ö–ê –î–û –ò –ü–û–°–õ–ï**

| –ú–µ—Ç—Ä–∏–∫–∞ | –î–æ —É–ª—É—á—à–µ–Ω–∏–π | –ü–æ—Å–ª–µ —É–ª—É—á—à–µ–Ω–∏–π | –£–ª—É—á—à–µ–Ω–∏–µ |
|---------|-------------|----------------|-----------|
| –§–∞–Ω—Ç–æ–º–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã | 10+ | 0 | ‚úÖ -100% |
| –ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ü–µ–Ω—ã | 58 | ~10 | ‚úÖ -83% |
| –ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç–∏—Ä–∞–∂–∏ | 25 | ~8 | ‚úÖ -68% |
| –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è | 72 | 0 | ‚úÖ -100% |
| –¢–æ—á–Ω–æ—Å—Ç—å –∫–æ–ª–æ–Ω–æ–∫ | 70% | 95%+ | ‚úÖ +25% |

## üöÄ **–ì–û–¢–û–í–ù–û–°–¢–¨ –ö –ü–†–û–î–ê–ö–®–ï–ù–£**

### ‚úÖ **–ß—Ç–æ –≥–æ—Ç–æ–≤–æ:**
1. **–ü–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–π –ø–∞—Ä—Å–µ—Ä** —Å —É–º–Ω—ã–º –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ–º –∫–æ–ª–æ–Ω–æ–∫
2. **–°—Ç—Ä–æ–≥–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è** –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö
3. **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º–Ω–æ–≥–æ—è–∑—ã—á–Ω–æ—Å—Ç–∏** (—Ä—É—Å—Å–∫–∏–π/–∞–Ω–≥–ª–∏–π—Å–∫–∏–π)
4. **–ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π** –≤–∫–ª—é—á–∞—è –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ
5. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ** —Å–ª—É–∂–µ–±–Ω—ã—Ö –ª–∏—Å—Ç–æ–≤
6. **–ü–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

### üéØ **–ì–æ—Ç–æ–≤ –∫ –º–∞—Å—Å–æ–≤–æ–º—É –ø–∞—Ä—Å–∏–Ω–≥—É:**
- –ü–∞—Ä—Å–µ—Ä –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω –∏ —Å—Ç–∞–±–∏–ª–µ–Ω
- –í—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã —É—Å—Ç—Ä–∞–Ω–µ–Ω—ã
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –∑–∞—â–∏—Ç–∞ –æ—Ç –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –ø—Ä–æ–±–ª–µ–º—ã

## üìù **–†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò –î–õ–Ø –î–ê–õ–¨–ù–ï–ô–®–ï–ì–û –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Ø**

1. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `complete_parsing_pipeline_v5.py`** –¥–ª—è –Ω–æ–≤—ã—Ö —Ç–∞–±–ª–∏—Ü
2. **–ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ –ª–æ–≥–∏** –Ω–∞ –ø—Ä–µ–¥–º–µ—Ç –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
3. **–ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã** –ø–æ—Å–ª–µ –ø–∞—Ä—Å–∏–Ω–≥–∞ –∫–∞–∂–¥–æ–π –ø–∞—Ä—Ç–∏–∏
4. **–°–æ—Ö—Ä–∞–Ω—è–π—Ç–µ —Ä–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏** –ë–î –ø–µ—Ä–µ–¥ –º–∞—Å—Å–æ–≤—ã–º –ø–∞—Ä—Å–∏–Ω–≥–æ–º

## üéâ **–ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï**

–ü–∞—Ä—Å–µ—Ä –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∞–Ω –∏ –≥–æ—Ç–æ–≤ –∫ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ–º—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é. –í—Å–µ –≤—ã—è–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã —Ä–µ—à–µ–Ω—ã, –¥–æ–±–∞–≤–ª–µ–Ω–∞ –Ω–∞–¥–µ–∂–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤ —Ç–∞–±–ª–∏—Ü. –°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –ø–∞—Ä—Å–∏–Ω–≥—É –æ—Å—Ç–∞–≤—à–∏—Ö—Å—è —Ç–∞–±–ª–∏—Ü –∏–∑ –º–∞—Å—Ç–µ—Ä-–ª–∏—Å—Ç–∞ –±–µ–∑ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –æ—à–∏–±–æ–∫.

---
*–û—Ç—á–µ—Ç —Å–æ–∑–¥–∞–Ω: 24 —Å–µ–Ω—Ç—è–±—Ä—è 2025*  
*–í–µ—Ä—Å–∏—è –ø–∞—Ä—Å–µ—Ä–∞: v5 Enhanced*
