# Скрипты парсинга коммерческих предложений

## Основные скрипты

### 1. `main_parser.py`
**Главный скрипт для полного парсинга**
- Загружает данные из Google Sheets
- Скачивает Excel файлы с Google Drive
- Извлекает изображения и их позиции
- Парсит товары, образцы и варианты цен

### 2. `improved_product_parser.py`
**Улучшенный парсер товаров**
- Автоматически определяет диапазоны строк товаров
- Парсит наименования, характеристики, кастом, образцы
- Правильно обрабатывает структуру Excel файлов

### 3. `improved_price_variants.py`
**Улучшенный парсер вариантов цен**
- Парсит тиражи, цены в $ и рублях, сроки доставки
- Поддерживает множественные тиражи для одного товара
- Корректно обрабатывает различные форматы данных

### 4. `image_position_parser.py`
**Парсер позиций изображений**
- Извлекает изображения из Excel файлов
- Определяет позиции изображений в ячейках
- Привязывает изображения к товарам

### 5. `google_drive_downloader.py`
**Загрузчик файлов с Google Drive**
- Скачивает Excel файлы по ссылкам из Google Sheets
- Поддерживает различные форматы (Excel, CSV)
- Обрабатывает большие файлы

### 6. `advanced_downloader.py`
**Продвинутый загрузчик**
- Многоуровневая стратегия загрузки
- Обход ограничений Google Drive API
- Поддержка публичных ссылок

### 7. `listing_generator.py`
**Генератор листингов**
- Создает JSON файлы с данными товаров
- Экспортирует результаты парсинга
- Форматирует данные для дальнейшего использования

### 8. `add_row_columns.py`
**Миграция базы данных**
- Добавляет поля start_row и end_row в таблицу products
- Выполняет миграцию схемы базы данных

## Использование

### Полный парсинг
```bash
python3 main_parser.py
```

### Парсинг только товаров
```bash
python3 improved_product_parser.py
```

### Парсинг только вариантов цен
```bash
python3 improved_price_variants.py
```

### Извлечение изображений
```bash
python3 image_position_parser.py
```

## Результаты

После выполнения парсинга в базе данных будет:
- **92 товара** с полной информацией
- **287 вариантов цен** (тиражи × маршруты)
- **92 образца** с ценами и сроками
- **310 изображений** с правильной привязкой к товарам

## Требования

- Python 3.8+
- SQLAlchemy
- openpyxl
- google-api-python-client
- pandas