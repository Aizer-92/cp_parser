#!/usr/bin/env python3
"""
–§–∏–Ω–∞–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Å–≤–æ–¥–Ω—ã—Ö –ª–∏—Å—Ç–æ–≤
"""

import pandas as pd
from datetime import datetime

def generate_final_real_data_report():
    """–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Ñ–∏–Ω–∞–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö"""
    
    print("üéØ –§–ò–ù–ê–õ–¨–ù–´–ô –û–¢–ß–ï–¢ –ù–ê –û–°–ù–û–í–ï –†–ï–ê–õ–¨–ù–´–• –î–ê–ù–ù–´–•")
    print("=" * 70)
    print("üìä –î–∞–Ω–Ω—ã–µ –∏–∑ —Å–≤–æ–¥–Ω—ã—Ö –ª–∏—Å—Ç–æ–≤ Excel —Ñ–∞–π–ª–∞")
    print("=" * 70)
    
    # –î–∞–Ω–Ω—ã–µ –ê—Ä—Ç–µ–º–∞ –í–∞—Å–∏–ª–µ–≤—Å–∫–æ–≥–æ (–∏–∑ –ª–∏—Å—Ç–∞ "–°–≤–æ–¥–Ω–∞—è –ø–æ –∑–ø")
    print("\nüë§ –ê–†–¢–ï–ú –í–ê–°–ò–õ–ï–í–°–ö–ò–ô")
    print("-" * 50)
    print("üíº –î–æ–ª–∂–Ω–æ—Å—Ç—å: –†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å –æ—Ç–¥–µ–ª–∞ –ø–æ —Ä–∞–±–æ—Ç–µ —Å –ö–∏—Ç–∞–µ–º")
    print("üìä –ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö: –õ–∏—Å—Ç '–°–≤–æ–¥–Ω–∞—è –ø–æ –∑–ø'")
    print("üìÖ –ü–µ—Ä–∏–æ–¥: –ò—é–Ω—å - –î–µ–∫–∞–±—Ä—å 2024")
    
    # –†–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ê—Ä—Ç–µ–º–∞
    artem_total = 1918268
    artem_monthly_data = {
        '–ò—é–Ω—å': 243406,
        '–ò—é–ª—å': 284179,
        '–ê–≤–≥—É—Å—Ç': 323759,
        '–°–µ–Ω—Ç—è–±—Ä—å': 363819,
        '–û–∫—Ç—è–±—Ä—å': 328727,
        '–ù–æ—è–±—Ä—å': 374378,
        '–î–µ–∫–∞–±—Ä—å': 458225
    }
    
    months_count = len(artem_monthly_data)
    avg_monthly_artem = artem_total / months_count
    annual_artem = avg_monthly_artem * 12
    
    print(f"üí∞ –û–±—â–∏–π –¥–æ—Ö–æ–¥ –∑–∞ {months_count} –º–µ—Å—è—Ü–µ–≤: {artem_total:,.2f} —Ä—É–±.")
    print(f"üìÖ –ú–µ—Å—è—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ: {artem_monthly_data}")
    print(f"üìä –°—Ä–µ–¥–Ω–µ–º–µ—Å—è—á–Ω–æ: {avg_monthly_artem:,.2f} —Ä—É–±.")
    print(f"üéØ –°–†–ï–î–ù–ï–ì–û–î–û–í–ê–Ø –ó–ê–†–ü–õ–ê–¢–ê: {annual_artem:,.2f} —Ä—É–±.")
    
    # –î–∞–Ω–Ω—ã–µ –ï–≤–≥–µ–Ω–∏—è –ö–æ—Å–∏—Ü–∏–Ω–∞ (–∏–∑ –ª–∏—Å—Ç–∞ "–°–≤–æ–¥–Ω–∞—è –ø–æ –∑–ø")
    print("\nüë§ –ï–í–ì–ï–ù–ò–ô –ö–û–°–ò–¶–ò–ù")
    print("-" * 50)
    print("üíº –î–æ–ª–∂–Ω–æ—Å—Ç—å: –†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å –æ—Ç–¥–µ–ª–∞ –ø–æ —Ä–∞–±–æ—Ç–µ —Å –ö–∏—Ç–∞–µ–º")
    print("üìä –ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö: –õ–∏—Å—Ç '–°–≤–æ–¥–Ω–∞—è –ø–æ –∑–ø'")
    print("üìÖ –ü–µ—Ä–∏–æ–¥: –ò—é–Ω—å - –î–µ–∫–∞–±—Ä—å 2024")
    
    # –†–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ï–≤–≥–µ–Ω–∏—è
    eugene_total = 963857
    eugene_monthly_data = {
        '–ò—é–Ω—å': 131189,
        '–ò—é–ª—å': 153971,
        '–ê–≤–≥—É—Å—Ç': 151119,
        '–°–µ–Ω—Ç—è–±—Ä—å': 185245,
        '–û–∫—Ç—è–±—Ä—å': 206200,
        '–ù–æ—è–±—Ä—å': 136133,
        '–î–µ–∫–∞–±—Ä—å': 211490
    }
    
    months_count_eugene = len(eugene_monthly_data)
    avg_monthly_eugene = eugene_total / months_count_eugene
    annual_eugene = avg_monthly_eugene * 12
    
    print(f"üí∞ –û–±—â–∏–π –¥–æ—Ö–æ–¥ –∑–∞ {months_count_eugene} –º–µ—Å—è—Ü–µ–≤: {eugene_total:,.2f} —Ä—É–±.")
    print(f"üìÖ –ú–µ—Å—è—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ: {eugene_monthly_data}")
    print(f"üìä –°—Ä–µ–¥–Ω–µ–º–µ—Å—è—á–Ω–æ: {avg_monthly_eugene:,.2f} —Ä—É–±.")
    print(f"üéØ –°–†–ï–î–ù–ï–ì–û–î–û–í–ê–Ø –ó–ê–†–ü–õ–ê–¢–ê: {annual_eugene:,.2f} —Ä—É–±.")
    
    # –°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑
    print("\n" + "=" * 70)
    print("–°–†–ê–í–ù–ò–¢–ï–õ–¨–ù–´–ô –ê–ù–ê–õ–ò–ó")
    print("=" * 70)
    
    print(f"\nüìä –°–†–ê–í–ù–ï–ù–ò–ï –û–ë–©–ò–• –î–û–•–û–î–û–í:")
    print(f"   üë§ –ê—Ä—Ç–µ–º –í–∞—Å–∏–ª–µ–≤—Å–∫–∏–π: {artem_total:,.2f} —Ä—É–±.")
    print(f"   üë§ –ï–≤–≥–µ–Ω–∏–π –ö–æ—Å–∏—Ü–∏–Ω:   {eugene_total:,.2f} —Ä—É–±.")
    print(f"   üìà –†–∞–∑–Ω–∏—Ü–∞: {artem_total - eugene_total:,.2f} —Ä—É–±.")
    print(f"   üìä –ê—Ä—Ç–µ–º –ø–æ–ª—É—á–∞–µ—Ç –Ω–∞ {((artem_total / eugene_total - 1) * 100):.1f}% –±–æ–ª—å—à–µ")
    
    print(f"\nüìä –°–†–ê–í–ù–ï–ù–ò–ï –°–†–ï–î–ù–ï–ú–ï–°–Ø–ß–ù–´–• –î–û–•–û–î–û–í:")
    print(f"   üë§ –ê—Ä—Ç–µ–º –í–∞—Å–∏–ª–µ–≤—Å–∫–∏–π: {avg_monthly_artem:,.2f} —Ä—É–±./–º–µ—Å—è—Ü")
    print(f"   üë§ –ï–≤–≥–µ–Ω–∏–π –ö–æ—Å–∏—Ü–∏–Ω:   {avg_monthly_eugene:,.2f} —Ä—É–±./–º–µ—Å—è—Ü")
    print(f"   üìà –†–∞–∑–Ω–∏—Ü–∞: {avg_monthly_artem - avg_monthly_eugene:,.2f} —Ä—É–±./–º–µ—Å—è—Ü")
    print(f"   üìä –ê—Ä—Ç–µ–º –ø–æ–ª—É—á–∞–µ—Ç –Ω–∞ {((avg_monthly_artem / avg_monthly_eugene - 1) * 100):.1f}% –±–æ–ª—å—à–µ")
    
    print(f"\nüìä –°–†–ê–í–ù–ï–ù–ò–ï –°–†–ï–î–ù–ï–ì–û–î–û–í–´–• –ó–ê–†–ü–õ–ê–¢:")
    print(f"   üë§ –ê—Ä—Ç–µ–º –í–∞—Å–∏–ª–µ–≤—Å–∫–∏–π: {annual_artem:,.2f} —Ä—É–±./–≥–æ–¥")
    print(f"   üë§ –ï–≤–≥–µ–Ω–∏–π –ö–æ—Å–∏—Ü–∏–Ω:   {annual_eugene:,.2f} —Ä—É–±./–≥–æ–¥")
    print(f"   üìà –†–∞–∑–Ω–∏—Ü–∞: {annual_artem - annual_eugene:,.2f} —Ä—É–±./–≥–æ–¥")
    print(f"   üìä –ê—Ä—Ç–µ–º –ø–æ–ª—É—á–∞–µ—Ç –Ω–∞ {((annual_artem / annual_eugene - 1) * 100):.1f}% –±–æ–ª—å—à–µ")
    
    # –î–∏–Ω–∞–º–∏–∫–∞ —Ä–æ—Å—Ç–∞
    print(f"\nüìà –ê–ù–ê–õ–ò–ó –î–ò–ù–ê–ú–ò–ö–ò –†–û–°–¢–ê:")
    
    # –ê—Ä—Ç–µ–º - –¥–∏–Ω–∞–º–∏–∫–∞
    artem_values = list(artem_monthly_data.values())
    artem_growth = ((artem_values[-1] / artem_values[0] - 1) * 100) if artem_values[0] > 0 else 0
    print(f"   üë§ –ê—Ä—Ç–µ–º: —Ä–æ—Å—Ç —Å {artem_values[0]:,.0f} –¥–æ {artem_values[-1]:,.0f} —Ä—É–±. ({artem_growth:+.1f}%)")
    
    # –ï–≤–≥–µ–Ω–∏–π - –¥–∏–Ω–∞–º–∏–∫–∞
    eugene_values = list(eugene_monthly_data.values())
    eugene_growth = ((eugene_values[-1] / eugene_values[0] - 1) * 100) if eugene_values[0] > 0 else 0
    print(f"   üë§ –ï–≤–≥–µ–Ω–∏–π: —Ä–æ—Å—Ç —Å {eugene_values[0]:,.0f} –¥–æ {eugene_values[-1]:,.0f} —Ä—É–±. ({eugene_growth:+.1f}%)")
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ñ–∏–Ω–∞–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç
    timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
    output_file = f"final_real_data_report_{timestamp}.txt"
    
    with open(output_file, 'w', encoding='utf-8') as f:
        f.write("–§–ò–ù–ê–õ–¨–ù–´–ô –û–¢–ß–ï–¢ –ù–ê –û–°–ù–û–í–ï –†–ï–ê–õ–¨–ù–´–• –î–ê–ù–ù–´–•\n")
        f.write("=" * 70 + "\n\n")
        f.write(f"–î–∞—Ç–∞ –∞–Ω–∞–ª–∏–∑–∞: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}\n")
        f.write("–ò—Å—Ç–æ—á–Ω–∏–∫: –õ–∏—Å—Ç '–°–≤–æ–¥–Ω–∞—è –ø–æ –∑–ø' –∏–∑ —Ñ–∞–π–ª–∞ '–¢–∞–±–ª –≤—ã–ø–ª–∞—Ç—ã 2025 (1).xlsx'\n")
        f.write("–ü–µ—Ä–∏–æ–¥: –ò—é–Ω—å - –î–µ–∫–∞–±—Ä—å 2024\n\n")
        
        f.write("–ê–†–¢–ï–ú –í–ê–°–ò–õ–ï–í–°–ö–ò–ô\n")
        f.write("-" * 50 + "\n")
        f.write("–î–æ–ª–∂–Ω–æ—Å—Ç—å: –†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å –æ—Ç–¥–µ–ª–∞ –ø–æ —Ä–∞–±–æ—Ç–µ —Å –ö–∏—Ç–∞–µ–º\n")
        f.write(f"–û–±—â–∏–π –¥–æ—Ö–æ–¥ –∑–∞ 7 –º–µ—Å—è—Ü–µ–≤: {artem_total:,.2f} —Ä—É–±.\n")
        f.write(f"–°—Ä–µ–¥–Ω–µ–º–µ—Å—è—á–Ω–æ: {avg_monthly_artem:,.2f} —Ä—É–±.\n")
        f.write(f"–°–†–ï–î–ù–ï–ì–û–î–û–í–ê–Ø –ó–ê–†–ü–õ–ê–¢–ê: {annual_artem:,.2f} —Ä—É–±.\n")
        f.write("–ú–µ—Å—è—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:\n")
        for month, amount in artem_monthly_data.items():
            f.write(f"  {month}: {amount:,.2f} —Ä—É–±.\n")
        
        f.write("\n–ï–í–ì–ï–ù–ò–ô –ö–û–°–ò–¶–ò–ù\n")
        f.write("-" * 50 + "\n")
        f.write("–î–æ–ª–∂–Ω–æ—Å—Ç—å: –†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å –æ—Ç–¥–µ–ª–∞ –ø–æ —Ä–∞–±–æ—Ç–µ —Å –ö–∏—Ç–∞–µ–º\n")
        f.write(f"–û–±—â–∏–π –¥–æ—Ö–æ–¥ –∑–∞ 7 –º–µ—Å—è—Ü–µ–≤: {eugene_total:,.2f} —Ä—É–±.\n")
        f.write(f"–°—Ä–µ–¥–Ω–µ–º–µ—Å—è—á–Ω–æ: {avg_monthly_eugene:,.2f} —Ä—É–±.\n")
        f.write(f"–°–†–ï–î–ù–ï–ì–û–î–û–í–ê–Ø –ó–ê–†–ü–õ–ê–¢–ê: {annual_eugene:,.2f} —Ä—É–±.\n")
        f.write("–ú–µ—Å—è—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:\n")
        for month, amount in eugene_monthly_data.items():
            f.write(f"  {month}: {amount:,.2f} —Ä—É–±.\n")
        
        f.write("\n–°–†–ê–í–ù–ò–¢–ï–õ–¨–ù–´–ô –ê–ù–ê–õ–ò–ó\n")
        f.write("-" * 50 + "\n")
        f.write(f"–†–∞–∑–Ω–∏—Ü–∞ –≤ –æ–±—â–∏—Ö –¥–æ—Ö–æ–¥–∞—Ö: {artem_total - eugene_total:,.2f} —Ä—É–±.\n")
        f.write(f"–ê—Ä—Ç–µ–º –ø–æ–ª—É—á–∞–µ—Ç –Ω–∞ {((artem_total / eugene_total - 1) * 100):.1f}% –±–æ–ª—å—à–µ\n")
        f.write(f"–†–∞–∑–Ω–∏—Ü–∞ –≤ —Å—Ä–µ–¥–Ω–µ–º–µ—Å—è—á–Ω—ã—Ö –¥–æ—Ö–æ–¥–∞—Ö: {avg_monthly_artem - avg_monthly_eugene:,.2f} —Ä—É–±.\n")
        f.write(f"–ê—Ä—Ç–µ–º –ø–æ–ª—É—á–∞–µ—Ç –Ω–∞ {((avg_monthly_artem / avg_monthly_eugene - 1) * 100):.1f}% –±–æ–ª—å—à–µ\n")
        f.write(f"–†–∞–∑–Ω–∏—Ü–∞ –≤ —Å—Ä–µ–¥–Ω–µ–≥–æ–¥–æ–≤—ã—Ö –∑–∞—Ä–ø–ª–∞—Ç–∞—Ö: {annual_artem - annual_eugene:,.2f} —Ä—É–±.\n")
        f.write(f"–ê—Ä—Ç–µ–º –ø–æ–ª—É—á–∞–µ—Ç –Ω–∞ {((annual_artem / annual_eugene - 1) * 100):.1f}% –±–æ–ª—å—à–µ\n")
        
        f.write(f"\n–î–ò–ù–ê–ú–ò–ö–ê –†–û–°–¢–ê:\n")
        f.write(f"–ê—Ä—Ç–µ–º: {artem_growth:+.1f}% –∑–∞ –ø–µ—Ä–∏–æ–¥\n")
        f.write(f"–ï–≤–≥–µ–Ω–∏–π: {eugene_growth:+.1f}% –∑–∞ –ø–µ—Ä–∏–æ–¥\n")
    
    print(f"\nüìÑ –§–∏–Ω–∞–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ —Ñ–∞–π–ª: {output_file}")
    
    # –°–æ–∑–¥–∞–µ–º –∫—Ä–∞—Ç–∫–∏–π –æ—Ç—á–µ—Ç
    summary_file = "real_data_salary_summary.txt"
    with open(summary_file, 'w', encoding='utf-8') as f:
        f.write("–ö–†–ê–¢–ö–ò–ô –û–¢–ß–ï–¢ –ü–û –†–ï–ê–õ–¨–ù–´–ú –î–ê–ù–ù–´–ú\n")
        f.write("=" * 50 + "\n\n")
        f.write("–ê–†–¢–ï–ú –í–ê–°–ò–õ–ï–í–°–ö–ò–ô: {:,} —Ä—É–±./–≥–æ–¥\n".format(int(annual_artem)))
        f.write("–ï–í–ì–ï–ù–ò–ô –ö–û–°–ò–¶–ò–ù: {:,} —Ä—É–±./–≥–æ–¥\n".format(int(annual_eugene)))
        f.write("–†–∞–∑–Ω–∏—Ü–∞: {:,} —Ä—É–±./–≥–æ–¥\n".format(int(annual_artem - annual_eugene)))
        f.write("–ê—Ä—Ç–µ–º –ø–æ–ª—É—á–∞–µ—Ç –Ω–∞ {:.1f}% –±–æ–ª—å—à–µ\n".format((annual_artem / annual_eugene - 1) * 100))
        f.write("\n–ò—Å—Ç–æ—á–Ω–∏–∫: –õ–∏—Å—Ç '–°–≤–æ–¥–Ω–∞—è –ø–æ –∑–ø', –ø–µ—Ä–∏–æ–¥ –ò—é–Ω—å-–î–µ–∫–∞–±—Ä—å 2024\n")
    
    print(f"üìã –ö—Ä–∞—Ç–∫–∏–π –æ—Ç—á–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ —Ñ–∞–π–ª: {summary_file}")

if __name__ == "__main__":
    generate_final_real_data_report()
    print("\n‚úÖ –§–∏–Ω–∞–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≥–æ—Ç–æ–≤!")
