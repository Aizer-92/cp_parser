#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
–°–û–ó–î–ê–ù–ò–ï –ü–û–ù–Ø–¢–ù–û–ì–û –û–¢–ß–ï–¢–ê –ü–û –ü–û–õ–ù–û–¢–ï –î–ê–ù–ù–´–•
–ß–µ—Ç–∫–∏–π –∞–Ω–∞–ª–∏–∑ —Ç–æ–≥–æ, —á—Ç–æ –µ—Å—Ç—å –∏ —á–µ–≥–æ –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç
"""

import pandas as pd
import numpy as np
from pathlib import Path

def create_comprehensive_analysis():
    """–°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–¥—Ä–æ–±–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –ø–æ–ª–Ω–æ—Ç—ã –¥–∞–Ω–Ω—ã—Ö"""
    
    print("üìä –°–û–ó–î–ê–ù–ò–ï –ü–û–ù–Ø–¢–ù–û–ì–û –û–¢–ß–ï–¢–ê –ü–û –ü–û–õ–ù–û–¢–ï –î–ê–ù–ù–´–•")
    print("=" * 60)
    
    # –ß–∏—Ç–∞–µ–º —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—É—é —Ç–∞–±–ª–∏—Ü—É
    df = pd.read_excel('ENHANCED_CATEGORIES_RANGES.xlsx', sheet_name='–†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ_–¥–∏–∞–ø–∞–∑–æ–Ω—ã')
    
    # –°–æ–∑–¥–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –ø–æ–ª–Ω–æ—Ç—ã –¥–∞–Ω–Ω—ã—Ö
    df_analysis = df.copy()
    
    # –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –Ω–∞–ª–∏—á–∏—è –¥–∞–Ω–Ω—ã—Ö
    df_analysis['–ï—Å—Ç—å_–¥–∏–∞–ø–∞–∑–æ–Ω—ã_–ë–î'] = (
        df_analysis['–¶–µ–Ω–∞_—Ä—É–±_–º–∏–Ω'].notna() | 
        df_analysis['–¢–∏—Ä–∞–∂_–º–∏–Ω'].notna() | 
        df_analysis['–ü–ª–æ—Ç–Ω–æ—Å—Ç—å_–º–∏–Ω'].notna()
    )
    
    df_analysis['–ï—Å—Ç—å_–¥–∞–Ω–Ω—ã–µ_CSV'] = df_analysis['–ü–æ–ø—É–ª—è—Ä–Ω–∞—è_–∫–∞—Ç–µ–≥–æ—Ä–∏—è'].notna()
    
    df_analysis['–ï—Å—Ç—å_—Å—Ç–∞–≤–∫–∏_—Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç'] = (
        df_analysis['–°—Ç–∞–≤–∫–∞_–∂–¥_–±–∞–∑–æ–≤–∞—è'].notna() | 
        df_analysis['–°—Ç–∞–≤–∫–∞_–∞–≤–∏–∞_–±–∞–∑–æ–≤–∞—è'].notna()
    )
    
    df_analysis['–ï—Å—Ç—å_–º–∞—Ç–µ—Ä–∏–∞–ª—ã'] = df_analysis['–ú–∞—Ç–µ—Ä–∏–∞–ª_—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π'].notna()
    df_analysis['–ï—Å—Ç—å_—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã'] = df_analysis['–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã_—Ç—Ä–µ–±—É–µ–º—ã–µ'].notna()
    
    # –°–æ–∑–¥–∞–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø–æ–ª–Ω–æ—Ç—ã
    def get_completeness_category(row):
        has_db = row['–ï—Å—Ç—å_–¥–∏–∞–ø–∞–∑–æ–Ω—ã_–ë–î']
        has_csv = row['–ï—Å—Ç—å_–¥–∞–Ω–Ω—ã–µ_CSV']
        has_rates = row['–ï—Å—Ç—å_—Å—Ç–∞–≤–∫–∏_—Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç']
        
        if has_db and has_csv and has_rates:
            return "üü¢ –ü–û–õ–ù–´–ï –î–ê–ù–ù–´–ï"
        elif has_db and has_csv:
            return "üü° –ë–î + CSV (–Ω–µ—Ç —Å—Ç–∞–≤–æ–∫)"
        elif has_db and not has_csv:
            return "üîµ –¢–û–õ–¨–ö–û –ë–î"
        elif not has_db and has_csv:
            return "üü† –¢–û–õ–¨–ö–û CSV"
        else:
            return "üî¥ –ú–ò–ù–ò–ú–ê–õ–¨–ù–´–ï –î–ê–ù–ù–´–ï"
    
    df_analysis['–ü–æ–ª–Ω–æ—Ç–∞_–¥–∞–Ω–Ω—ã—Ö'] = df_analysis.apply(get_completeness_category, axis=1)
    
    # –ü–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–µ—Ç—Ä–∏–∫
    df_analysis['–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ_–¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤'] = (
        df_analysis['–¶–µ–Ω–∞_—Ä—É–±_–º–∏–Ω'].notna().astype(int) +
        df_analysis['–¶–µ–Ω–∞_—é–∞–Ω—å_–º–∏–Ω'].notna().astype(int) +
        df_analysis['–¢–∏—Ä–∞–∂_–º–∏–Ω'].notna().astype(int) +
        df_analysis['–ü–ª–æ—Ç–Ω–æ—Å—Ç—å_–º–∏–Ω'].notna().astype(int) +
        df_analysis['–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç_–º–∏–Ω'].notna().astype(int)
    )
    
    # –°–æ–∑–¥–∞–µ–º —Å–≤–æ–¥–Ω—É—é —Ç–∞–±–ª–∏—Ü—É –¥–ª—è –∫–∞–∂–¥–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
    summary_columns = [
        '–¢–∏–ø', '–ö–∞—Ç–µ–≥–æ—Ä–∏—è', '–†–æ–¥–∏—Ç–µ–ª—å', '–¢–æ–≤–∞—Ä–æ–≤', '–ü–æ–ª–Ω–æ—Ç–∞_–¥–∞–Ω–Ω—ã—Ö',
        '–ü–æ–ø—É–ª—è—Ä–Ω–∞—è_–∫–∞—Ç–µ–≥–æ—Ä–∏—è', '–ú–∞—Ç–µ—Ä–∏–∞–ª_—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π', 
        '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ_–¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤', '–ï—Å—Ç—å_–¥–∏–∞–ø–∞–∑–æ–Ω—ã_–ë–î', '–ï—Å—Ç—å_–¥–∞–Ω–Ω—ã–µ_CSV',
        '–ï—Å—Ç—å_—Å—Ç–∞–≤–∫–∏_—Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç', '–ï—Å—Ç—å_–º–∞—Ç–µ—Ä–∏–∞–ª—ã', '–ï—Å—Ç—å_—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã',
        '–ú–µ–¥–∏–∞–Ω–∞_—Ü–µ–Ω—ã_—Ä—É–±', '–ú–µ–¥–∏–∞–Ω–∞_–ø–ª–æ—Ç–Ω–æ—Å—Ç–∏', '–ú–µ–¥–∏–∞–Ω–∞_—Ç–∏—Ä–∞–∂–∞',
        '–°—Ç–∞–≤–∫–∞_–∂–¥_–±–∞–∑–æ–≤–∞—è', '–°—Ç–∞–≤–∫–∞_–∞–≤–∏–∞_–±–∞–∑–æ–≤–∞—è', '–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã_—Ç—Ä–µ–±—É–µ–º—ã–µ'
    ]
    
    df_summary = df_analysis[summary_columns].copy()
    
    # –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ –ø–æ–ª–Ω–æ—Ç–µ –¥–∞–Ω–Ω—ã—Ö –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É —Ç–æ–≤–∞—Ä–æ–≤
    completeness_order = {
        "üü¢ –ü–û–õ–ù–´–ï –î–ê–ù–ù–´–ï": 1,
        "üü° –ë–î + CSV (–Ω–µ—Ç —Å—Ç–∞–≤–æ–∫)": 2, 
        "üîµ –¢–û–õ–¨–ö–û –ë–î": 3,
        "üü† –¢–û–õ–¨–ö–û CSV": 4,
        "üî¥ –ú–ò–ù–ò–ú–ê–õ–¨–ù–´–ï –î–ê–ù–ù–´–ï": 5
    }
    
    df_summary['sort_order'] = df_summary['–ü–æ–ª–Ω–æ—Ç–∞_–¥–∞–Ω–Ω—ã—Ö'].map(completeness_order)
    df_summary = df_summary.sort_values(['sort_order', '–¢–æ–≤–∞—Ä–æ–≤'], ascending=[True, False])
    df_summary = df_summary.drop('sort_order', axis=1)
    
    # –°–æ–∑–¥–∞–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ –ø–æ–ª–Ω–æ—Ç–µ
    completeness_stats = df_summary.groupby('–ü–æ–ª–Ω–æ—Ç–∞_–¥–∞–Ω–Ω—ã—Ö').agg({
        '–ö–∞—Ç–µ–≥–æ—Ä–∏—è': 'count',
        '–¢–æ–≤–∞—Ä–æ–≤': ['sum', 'mean']
    }).round(1)
    
    completeness_stats.columns = ['–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ_–∫–∞—Ç–µ–≥–æ—Ä–∏–π', '–í—Å–µ–≥–æ_—Ç–æ–≤–∞—Ä–æ–≤', '–°—Ä–µ–¥–Ω–µ_—Ç–æ–≤–∞—Ä–æ–≤']
    completeness_stats = completeness_stats.reset_index()
    
    # –°–æ–∑–¥–∞–µ–º –¥–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö
    missing_data = []
    
    for _, row in df_analysis.iterrows():
        missing = []
        
        if not row['–ï—Å—Ç—å_–¥–∏–∞–ø–∞–∑–æ–Ω—ã_–ë–î']:
            missing.append("–î–∏–∞–ø–∞–∑–æ–Ω—ã –∏–∑ –ë–î")
        if not row['–ï—Å—Ç—å_–¥–∞–Ω–Ω—ã–µ_CSV']:
            missing.append("–î–∞–Ω–Ω—ã–µ –∏–∑ CSV")
        if not row['–ï—Å—Ç—å_—Å—Ç–∞–≤–∫–∏_—Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç']:
            missing.append("–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã–µ —Å—Ç–∞–≤–∫–∏")
        if not row['–ï—Å—Ç—å_–º–∞—Ç–µ—Ä–∏–∞–ª—ã']:
            missing.append("–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã")
        if not row['–ï—Å—Ç—å_—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã']:
            missing.append("–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã")
            
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –¥–∏–∞–ø–∞–∑–æ–Ω—ã
        if pd.isna(row['–¶–µ–Ω–∞_—Ä—É–±_–º–∏–Ω']):
            missing.append("–î–∏–∞–ø–∞–∑–æ–Ω —Ü–µ–Ω –≤ —Ä—É–±–ª—è—Ö")
        if pd.isna(row['–ü–ª–æ—Ç–Ω–æ—Å—Ç—å_–º–∏–Ω']):
            missing.append("–î–∏–∞–ø–∞–∑–æ–Ω –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏")
        if pd.isna(row['–¢–∏—Ä–∞–∂_–º–∏–Ω']):
            missing.append("–î–∏–∞–ø–∞–∑–æ–Ω —Ç–∏—Ä–∞–∂–µ–π")
            
        missing_data.append({
            '–ö–∞—Ç–µ–≥–æ—Ä–∏—è': row['–ö–∞—Ç–µ–≥–æ—Ä–∏—è'],
            '–¢–∏–ø': row['–¢–∏–ø'],
            '–¢–æ–≤–∞—Ä–æ–≤': row['–¢–æ–≤–∞—Ä–æ–≤'],
            '–ü–æ–ª–Ω–æ—Ç–∞_–¥–∞–Ω–Ω—ã—Ö': row['–ü–æ–ª–Ω–æ—Ç–∞_–¥–∞–Ω–Ω—ã—Ö'],
            '–û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç': "; ".join(missing) if missing else "–í—Å–µ –¥–∞–Ω–Ω—ã–µ –µ—Å—Ç—å"
        })
    
    df_missing = pd.DataFrame(missing_data)
    df_missing = df_missing.sort_values('–¢–æ–≤–∞—Ä–æ–≤', ascending=False)
    
    # –°–æ–∑–¥–∞–µ–º —Ç–∞–±–ª–∏—Ü—É –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–≤ –¥–ª—è –¥–æ—Ä–∞–±–æ—Ç–∫–∏
    priority_categories = df_analysis[
        (df_analysis['–¢–æ–≤–∞—Ä–æ–≤'] >= 20) & 
        (~df_analysis['–ï—Å—Ç—å_–¥–∞–Ω–Ω—ã–µ_CSV'])
    ][['–¢–∏–ø', '–ö–∞—Ç–µ–≥–æ—Ä–∏—è', '–¢–æ–≤–∞—Ä–æ–≤', '–ú–µ–¥–∏–∞–Ω–∞_—Ü–µ–Ω—ã_—Ä—É–±', '–ú–µ–¥–∏–∞–Ω–∞_–ø–ª–æ—Ç–Ω–æ—Å—Ç–∏']].copy()
    
    priority_categories = priority_categories.sort_values('–¢–æ–≤–∞—Ä–æ–≤', ascending=False)
    priority_categories['–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç'] = range(1, len(priority_categories) + 1)
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
    output_file = Path(__file__).parent / "COMPREHENSIVE_DATA_ANALYSIS.xlsx"
    
    with pd.ExcelWriter(output_file, engine='openpyxl') as writer:
        # 1. –û—Å–Ω–æ–≤–Ω–∞—è —Å–≤–æ–¥–∫–∞ –ø–æ –ø–æ–ª–Ω–æ—Ç–µ
        df_summary.to_excel(writer, sheet_name='üìä_–°–≤–æ–¥–∫–∞_–ø–æ_–ø–æ–ª–Ω–æ—Ç–µ', index=False)
        
        # 2. –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–ª–Ω–æ—Ç—ã –¥–∞–Ω–Ω—ã—Ö
        completeness_stats.to_excel(writer, sheet_name='üìà_–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞_–ø–æ–ª–Ω–æ—Ç—ã', index=False)
        
        # 3. –ü–æ–ª–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (—Å–∞–º—ã–µ —Ü–µ–Ω–Ω—ã–µ)
        full_data = df_summary[df_summary['–ü–æ–ª–Ω–æ—Ç–∞_–¥–∞–Ω–Ω—ã—Ö'] == "üü¢ –ü–û–õ–ù–´–ï –î–ê–ù–ù–´–ï"]
        if len(full_data) > 0:
            full_data.to_excel(writer, sheet_name='üü¢_–ü–æ–ª–Ω—ã–µ_–¥–∞–Ω–Ω—ã–µ', index=False)
        
        # 4. –ë–î + CSV –±–µ–∑ —Å—Ç–∞–≤–æ–∫
        partial_data = df_summary[df_summary['–ü–æ–ª–Ω–æ—Ç–∞_–¥–∞–Ω–Ω—ã—Ö'] == "üü° –ë–î + CSV (–Ω–µ—Ç —Å—Ç–∞–≤–æ–∫)"]
        if len(partial_data) > 0:
            partial_data.to_excel(writer, sheet_name='üü°_–ë–î_–ø–ª—é—Å_CSV', index=False)
        
        # 5. –¢–æ–ª—å–∫–æ –ë–î (–Ω—É–∂–Ω–æ –¥–æ–ø–æ–ª–Ω–∏—Ç—å)
        db_only = df_summary[df_summary['–ü–æ–ª–Ω–æ—Ç–∞_–¥–∞–Ω–Ω—ã—Ö'] == "üîµ –¢–û–õ–¨–ö–û –ë–î"]
        if len(db_only) > 0:
            db_only.to_excel(writer, sheet_name='üîµ_–¢–æ–ª—å–∫–æ_–ë–î', index=False)
        
        # 6. –¢–æ–ª—å–∫–æ CSV (–Ω—É–∂–Ω–æ –Ω–∞–π—Ç–∏ —Ç–æ–≤–∞—Ä—ã)
        csv_only = df_summary[df_summary['–ü–æ–ª–Ω–æ—Ç–∞_–¥–∞–Ω–Ω—ã—Ö'] == "üü† –¢–û–õ–¨–ö–û CSV"]
        if len(csv_only) > 0:
            csv_only.to_excel(writer, sheet_name='üü†_–¢–æ–ª—å–∫–æ_CSV', index=False)
        
        # 7. –î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö
        df_missing.to_excel(writer, sheet_name='üîç_–ê–Ω–∞–ª–∏–∑_–ø—Ä–æ–ø—É—Å–∫–æ–≤', index=False)
        
        # 8. –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –¥–ª—è –¥–æ—Ä–∞–±–æ—Ç–∫–∏
        priority_categories.to_excel(writer, sheet_name='‚ö°_–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã_–¥–æ—Ä–∞–±–æ—Ç–∫–∏', index=False)
        
        # 9. –ò—Å—Ö–æ–¥–Ω–∞—è –ø–æ–ª–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ (–¥–ª—è —Å–ø—Ä–∞–≤–∫–∏)
        df_analysis.to_excel(writer, sheet_name='üìã_–ü–æ–ª–Ω–∞—è_—Ç–∞–±–ª–∏—Ü–∞', index=False)
    
    # –í—ã–≤–æ–¥–∏–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
    print(f"‚úÖ –ü–æ–Ω—è—Ç–Ω—ã–π –æ—Ç—á–µ—Ç —Å–æ–∑–¥–∞–Ω: {output_file}")
    print(f"üìä –õ–∏—Å—Ç—ã:")
    print(f"  1. 'üìä_–°–≤–æ–¥–∫–∞_–ø–æ_–ø–æ–ª–Ω–æ—Ç–µ' - {len(df_summary)} –∫–∞—Ç–µ–≥–æ—Ä–∏–π —Å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞–º–∏ –ø–æ–ª–Ω–æ—Ç—ã")
    print(f"  2. 'üìà_–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞_–ø–æ–ª–Ω–æ—Ç—ã' - —Å–≤–æ–¥–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Ç–∏–ø–∞–º –¥–∞–Ω–Ω—ã—Ö")
    print(f"  3. 'üü¢_–ü–æ–ª–Ω—ã–µ_–¥–∞–Ω–Ω—ã–µ' - {len(full_data)} –∫–∞—Ç–µ–≥–æ—Ä–∏–π —Å –ø–æ–ª–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏")
    print(f"  4. 'üü°_–ë–î_–ø–ª—é—Å_CSV' - {len(partial_data)} –∫–∞—Ç–µ–≥–æ—Ä–∏–π –±–µ–∑ —Å—Ç–∞–≤–æ–∫")
    print(f"  5. 'üîµ_–¢–æ–ª—å–∫–æ_–ë–î' - {len(db_only)} –∫–∞—Ç–µ–≥–æ—Ä–∏–π —Ç–æ–ª—å–∫–æ –∏–∑ –ë–î")
    print(f"  6. 'üü†_–¢–æ–ª—å–∫–æ_CSV' - {len(csv_only)} –∫–∞—Ç–µ–≥–æ—Ä–∏–π —Ç–æ–ª—å–∫–æ –∏–∑ CSV")
    print(f"  7. 'üîç_–ê–Ω–∞–ª–∏–∑_–ø—Ä–æ–ø—É—Å–∫–æ–≤' - –¥–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö")
    print(f"  8. '‚ö°_–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã_–¥–æ—Ä–∞–±–æ—Ç–∫–∏' - {len(priority_categories)} –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π")
    print(f"  9. 'üìã_–ü–æ–ª–Ω–∞—è_—Ç–∞–±–ª–∏—Ü–∞' - –∏—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Å–æ –≤—Å–µ–º–∏ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞–º–∏")
    
    print()
    print("üéØ –ö–õ–Æ–ß–ï–í–´–ï –ò–ù–î–ò–ö–ê–¢–û–†–´:")
    print("  ‚Ä¢ –ï—Å—Ç—å_–¥–∏–∞–ø–∞–∑–æ–Ω—ã_–ë–î - –µ—Å—Ç—å –ª–∏ –¥–∏–∞–ø–∞–∑–æ–Ω—ã –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö")
    print("  ‚Ä¢ –ï—Å—Ç—å_–¥–∞–Ω–Ω—ã–µ_CSV - –µ—Å—Ç—å –ª–∏ –¥–∞–Ω–Ω—ã–µ –∏–∑ –ø–æ–ø—É–ª—è—Ä–Ω–æ–≥–æ CSV")
    print("  ‚Ä¢ –ï—Å—Ç—å_—Å—Ç–∞–≤–∫–∏_—Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç - –µ—Å—Ç—å –ª–∏ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã–µ —Å—Ç–∞–≤–∫–∏")
    print("  ‚Ä¢ –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ_–¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤ - —Å–∫–æ–ª—å–∫–æ –º–µ—Ç—Ä–∏–∫ –∏–º–µ—é—Ç –¥–∏–∞–ø–∞–∑–æ–Ω—ã")
    print("  ‚Ä¢ –ü–æ–ª–Ω–æ—Ç–∞_–¥–∞–Ω–Ω—ã—Ö - –æ–±—â–∞—è –æ—Ü–µ–Ω–∫–∞ –ø–æ–ª–Ω–æ—Ç—ã –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏")
    
    print()
    print("üìà –°–¢–ê–¢–ò–°–¢–ò–ö–ê –ü–û–õ–ù–û–¢–´:")
    for _, row in completeness_stats.iterrows():
        print(f"  {row['–ü–æ–ª–Ω–æ—Ç–∞_–¥–∞–Ω–Ω—ã—Ö']}: {row['–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ_–∫–∞—Ç–µ–≥–æ—Ä–∏–π']} –∫–∞—Ç–µ–≥–æ—Ä–∏–π, {row['–í—Å–µ–≥–æ_—Ç–æ–≤–∞—Ä–æ–≤']:,.0f} —Ç–æ–≤–∞—Ä–æ–≤")
    
    return output_file

if __name__ == "__main__":
    create_comprehensive_analysis()
