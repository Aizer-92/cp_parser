# Commercial Proposals Parser - Финальная версия

## Описание проекта

Система для парсинга коммерческих предложений из Google Sheets с извлечением изображений и созданием веб-каталога товаров.

## Архитектура

### База данных (v4)
- **products** - основная информация о товарах (название, описание, характеристики, кастом)
- **price_offers** - ценовые предложения (маршрут, тираж, цены USD/RUB, сроки, образцы)
- **product_images** - изображения товаров (основные и дополнительные)
- **sheets_metadata** - метаданные загруженных таблиц

### Веб-приложение (FastAPI v4)
- **Главная страница** - каталог товаров с 4 карточками в ряд
- **Детальная страница** - полная информация о товаре с галереей изображений
- **Фильтрация** - по маршрутам, ценам, поиск
- **Адаптивный дизайн** - Bootstrap 5, квадратные изображения

## Структура файлов

```
projects/commercial_proposals_parser/
├── database/
│   ├── models_v4.py          # Модели базы данных v4
│   └── manager_v4.py         # Менеджер базы данных v4
├── web_app_v4/               # Веб-приложение v4
│   ├── main.py              # FastAPI приложение
│   ├── templates/           # HTML шаблоны
│   └── static/              # CSS/JS файлы
├── storage/
│   ├── database/            # База данных SQLite
│   ├── images/              # Изображения товаров
│   └── excel_files/         # Excel файлы
├── config.py                # Конфигурация проекта
└── README_FINAL.md          # Этот файл
```

## Ключевые особенности

### 1. Парсинг данных
- Извлечение данных из Google Sheets через API
- Обработка сложных многоуровневых заголовков
- Извлечение изображений из Excel с привязкой к товарам
- Поддержка различных типов доставки (ЖД, АВИА, Контейнер, Образец)

### 2. База данных
- Нормализованная структура с отдельными таблицами
- Поддержка образцов как отдельного типа ценовых предложений
- Связи между товарами, ценами и изображениями

### 3. Веб-интерфейс
- Современный дизайн с Bootstrap 5
- Квадратные контейнеры для изображений
- Адаптивная верстка (4 карточки в ряд)
- Детальные страницы товаров с галереей
- Фильтрация и поиск

### 4. Обработка изображений
- Автоматическое извлечение из Excel
- Поддержка основных и дополнительных изображений
- Квадратные контейнеры без обрезки
- Оптимизация отображения

## Запуск приложения

```bash
cd web_app_v4
python main.py
```

Приложение будет доступно по адресу: http://localhost:8000

## Технологии

- **Backend**: FastAPI, SQLAlchemy, Uvicorn
- **Frontend**: Jinja2, Bootstrap 5, JavaScript
- **База данных**: SQLite
- **Парсинг**: pandas, openpyxl, Google Sheets API
- **Изображения**: PIL/Pillow

## Основные функции

1. **Парсинг Google Sheets** - автоматическое извлечение данных
2. **Обработка изображений** - извлечение и привязка к товарам
3. **Веб-каталог** - современный интерфейс для просмотра товаров
4. **Фильтрация** - по маршрутам, ценам, поиск по названию
5. **Детальные страницы** - полная информация о товарах
6. **Образцы** - отдельное отображение информации по образцам

## Структура данных

### Товар
- Название, описание, характеристики
- Возможность кастомного дизайна
- Связь с изображениями и ценовыми предложениями

### Ценовое предложение
- Маршрут доставки (ЖД, АВИА, Контейнер, Образец)
- Тираж, цены в USD и RUB
- Сроки доставки/изготовления
- Флаг образца (is_sample)

### Изображение
- Локальный путь к файлу
- Тип (основное/дополнительное)
- Связь с товаром

## Миграции

Проект прошел несколько этапов миграции:
- v1 → v2: Нормализация структуры
- v2 → v3: Добавление образцов
- v3 → v4: Финальная структура с объединенными ценовыми предложениями

## Конфигурация

Основные настройки в `config.py`:
- Пути к базе данных и файлам
- Настройки Google API
- Параметры обработки изображений
- Конфигурация веб-приложения
