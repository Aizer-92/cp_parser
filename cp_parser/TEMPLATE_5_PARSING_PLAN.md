# üìã –ü–õ–ê–ù –ü–ê–†–°–ò–ù–ì–ê –®–ê–ë–õ–û–ù–ê 5

**–î–∞—Ç–∞:** 09.10.2025  
**–ü—Ä–æ–µ–∫—Ç–æ–≤:** 230

---

## üéØ –ö–õ–Æ–ß–ï–í–´–ï –û–¢–õ–ò–ß–ò–Ø –û–¢ –®–ê–ë–õ–û–ù–ê 4

### 1Ô∏è‚É£ –ú–∞—Ä—à—Ä—É—Ç—ã –¥–æ—Å—Ç–∞–≤–∫–∏

**–®–∞–±–ª–æ–Ω 4:**
```
–¢–∏—Ä–∞–∂: 1000 —à—Ç
‚îú‚îÄ‚îÄ Highway –ñ–î:  5.50$ / 500‚ÇΩ / 45 –¥–Ω–µ–π
‚îî‚îÄ‚îÄ Highway Avia: 6.20$ / 580‚ÇΩ / 15 –¥–Ω–µ–π

‚Üí –†–µ–∑—É–ª—å—Ç–∞—Ç: 2 price_offers
```

**–®–∞–±–ª–æ–Ω 5:**
```
–¢–∏—Ä–∞–∂: 2000 —à—Ç
‚îî‚îÄ‚îÄ –ï–¥–∏–Ω–∞—è —Ü–µ–Ω–∞: 0.49$ / 47‚ÇΩ / 15-20 –¥–Ω–µ–π

‚Üí –†–µ–∑—É–ª—å—Ç–∞—Ç: 1 price_offer (–±–µ–∑ delivery_route)
```

### 2Ô∏è‚É£ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–æ–ª–æ–Ω–æ–∫

| –ü–æ–ª–µ | –®–∞–±–ª–æ–Ω 4 | –®–∞–±–ª–æ–Ω 5 | –ö—É–¥–∞ –ø–∞—Ä—Å–∏–º |
|------|----------|----------|-------------|
| –§–æ—Ç–æ | A | A | `product_images` (is_main=true) |
| –ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ | B | B | `products.name` |
| –û–ø–∏—Å–∞–Ω–∏–µ | C | C | `products.custom_field` |
| –ö–∞—Å—Ç–æ–º/–î–∏–∑–∞–π–Ω | D | - | (–≤ –®–∞–±–ª–æ–Ω–µ 5 –≤ –æ–ø–∏—Å–∞–Ω–∏–∏) |
| –¢–∏—Ä–∞–∂ | E | D | `price_offers.quantity` |
| –¶–µ–Ω–∞ USD | F,I | E | `price_offers.price_usd` |
| –¶–µ–Ω–∞ RUB | G,J | F | `price_offers.price_rub` |
| –°—Ä–æ–∫ | H,K | G | `price_offers.delivery_time` |
| –û–±—Ä–∞–∑–µ—Ü —Ü–µ–Ω–∞ | N | H | `products.sample_price` |
| –û–±—Ä–∞–∑–µ—Ü —Å—Ä–æ–∫ | P | I | `products.sample_delivery_time` |
| –î–æ–ø. —Ñ–æ—Ç–æ | Q | J | `product_images` (is_main=false) |

### 3Ô∏è‚É£ –ü–æ–∑–∏—Ü–∏—è –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤

```
–®–∞–±–ª–æ–Ω 4:
–°—Ç—Ä–æ–∫–∞ 1: (—Å–ª—É–∂–µ–±–Ω–∞—è)
–°—Ç—Ä–æ–∫–∞ 2: (—Å–ª—É–∂–µ–±–Ω–∞—è)
–°—Ç—Ä–æ–∫–∞ 3: (—Å–ª—É–∂–µ–±–Ω–∞—è)
–°—Ç—Ä–æ–∫–∞ 4: [–ó–ê–ì–û–õ–û–í–ö–ò]
–°—Ç—Ä–æ–∫–∞ 5: [–î–ê–ù–ù–´–ï]

–®–∞–±–ª–æ–Ω 5:
–°—Ç—Ä–æ–∫–∞ 1: –ú–µ–Ω–µ–¥–∂–µ—Ä, –ø—Ä–∏–º–µ—á–∞–Ω–∏—è
–°—Ç—Ä–æ–∫–∞ 2: [–ó–ê–ì–û–õ–û–í–ö–ò]
–°—Ç—Ä–æ–∫–∞ 3: [–î–ê–ù–ù–´–ï]
```

---

## üìù –ü–†–ò–ú–ï–†–´ –†–ï–ó–£–õ–¨–¢–ê–¢–ê –ü–ê–†–°–ò–ù–ì–ê

### –ü—Ä–∏–º–µ—Ä 1: –ü—Ä–æ—Å—Ç–æ–π —Ç–æ–≤–∞—Ä

**Excel (–®–∞–±–ª–æ–Ω 5):**
```
A: [—Ñ–æ—Ç–æ]
B: –°–≤–µ—Ç–æ–æ—Ç—Ä–∞–∂–∞—é—â–∏–µ—Å—è —à–Ω—É—Ä–∫–∏
C: –†–∞–∑–º–µ—Ä: 9—Ö120–º–º, –ú–∞—Ç–µ—Ä–∏–∞–ª: –ü–æ–ª–∏—ç—Å—Ç–µ—Ä
D: 2000
   4000
E: 0,49
   0,75
   
   0,46
   0,71
F: 47,16 ‚ÇΩ
   73,37 ‚ÇΩ
   
   43,97 ‚ÇΩ
   70,17 ‚ÇΩ
G: 15-20 –∫–¥
   
   14-16 –∫–¥
H: -
I: -
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç –≤ –ë–î:**

**products:**
```json
{
  "id": 15001,
  "project_id": 1912,
  "name": "–°–≤–µ—Ç–æ–æ—Ç—Ä–∞–∂–∞—é—â–∏–µ—Å—è —à–Ω—É—Ä–∫–∏",
  "custom_field": "–†–∞–∑–º–µ—Ä: 9—Ö120–º–º, –ú–∞—Ç–µ—Ä–∏–∞–ª: –ü–æ–ª–∏—ç—Å—Ç–µ—Ä",
  "sample_price": null,
  "sample_delivery_time": null
}
```

**price_offers:** (4 –∑–∞–ø–∏—Å–∏)
```json
[
  {
    "product_id": 15001,
    "quantity": 2000,
    "price_usd": 0.49,
    "price_rub": 47.16,
    "delivery_time": "20 –¥–Ω–µ–π",
    "delivery_route": null
  },
  {
    "product_id": 15001,
    "quantity": 4000,
    "price_usd": 0.75,
    "price_rub": 73.37,
    "delivery_time": "20 –¥–Ω–µ–π",
    "delivery_route": null
  },
  {
    "product_id": 15001,
    "quantity": 2000,
    "price_usd": 0.46,
    "price_rub": 43.97,
    "delivery_time": "16 –¥–Ω–µ–π",
    "delivery_route": null
  },
  {
    "product_id": 15001,
    "quantity": 4000,
    "price_usd": 0.71,
    "price_rub": 70.17,
    "delivery_time": "16 –¥–Ω–µ–π",
    "delivery_route": null
  }
]
```

**product_images:**
```json
{
  "product_id": 15001,
  "cell_position": "A3",
  "is_main_image": true,
  "image_url": "https://ru1.storage.beget.cloud/.../image.png"
}
```

---

### –ü—Ä–∏–º–µ—Ä 2: –¢–æ–≤–∞—Ä —Å –æ–±—Ä–∞–∑—Ü–æ–º

**Excel (–®–∞–±–ª–æ–Ω 5):**
```
A: [—Ñ–æ—Ç–æ]
B: –ü–µ—Å–æ—á–Ω—ã–µ —á–∞—Å—ã
C: –ú–∞—Ç–µ—Ä–∏–∞–ª: –ø–ª–∞—Å—Ç–∏–∫, —Å—Ç–µ–∫–ª–æ, –∞–∫—Ä–∏–ª. –†–∞–∑–º–µ—Ä: 10x5 —Å–º
D: 150
E: 4,03
   
   4,57
F: 386,98
   
   440,78
G: 40-45 –∫–∞–ª–µ–Ω–¥.–¥–Ω–µ–π
H: 7900 —Ä—É–±
   
   8100 —Ä—É–±
I: 20-22 –∫–∞–ª–µ–Ω–¥.–¥–Ω—è
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç –≤ –ë–î:**

**products:**
```json
{
  "id": 15002,
  "project_id": 1944,
  "name": "–ü–µ—Å–æ—á–Ω—ã–µ —á–∞—Å—ã",
  "custom_field": "–ú–∞—Ç–µ—Ä–∏–∞–ª: –ø–ª–∞—Å—Ç–∏–∫, —Å—Ç–µ–∫–ª–æ, –∞–∫—Ä–∏–ª. –†–∞–∑–º–µ—Ä: 10x5 —Å–º",
  "sample_price": "7900 —Ä—É–± / 8100 —Ä—É–±",
  "sample_delivery_time": 22
}
```

**price_offers:** (2 –∑–∞–ø–∏—Å–∏)
```json
[
  {
    "product_id": 15002,
    "quantity": 150,
    "price_usd": 4.03,
    "price_rub": 386.98,
    "delivery_time": "45 –¥–Ω–µ–π",
    "delivery_route": null
  },
  {
    "product_id": 15002,
    "quantity": 150,
    "price_usd": 4.57,
    "price_rub": 440.78,
    "delivery_time": "45 –¥–Ω–µ–π",
    "delivery_route": null
  }
]
```

---

### –ü—Ä–∏–º–µ—Ä 3: Multi-row —Ç–æ–≤–∞—Ä (—Å –¥–æ–ø. –æ–ø—Ü–∏—è–º–∏)

**Excel (–®–∞–±–ª–æ–Ω 5):**
```
–°—Ç—Ä–æ–∫–∞ 3:
A: [—Ñ–æ—Ç–æ]
B: –ü–æ–ª–æ—Ç–µ–Ω—Ü–µ
C: 70*140—Å–º, –≤–µ—Å 210–≥-215–≥, 100% –º–∏–∫—Ä–æ—Ñ–∏–±—Ä–∞
D: 164
E: 8.37
F: 771.75
G: 45-50–∫–¥
H: 7 539 ‚ÇΩ - –±–µ–∑ –ø–µ—á–∞—Ç–∏ –Ω–∞ —Å—É–º–∫–µ
I: 20-22–∫–¥

–°—Ç—Ä–æ–∫–∞ 4: (–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –æ–ø—Ü–∏—è)
A: (–ø—É—Å—Ç–æ)
B: (–ø—É—Å—Ç–æ)
C: +–ù–∞–Ω–µ—Å–µ–Ω–∏–µ: –ø–µ—á–∞—Ç—å –Ω–∞ —Å—É–º–∫–µ —à–µ–ª–∫–æ–≥—Ä–∞—Ñ–∏—è
D: (–ø—É—Å—Ç–æ)
E: 8.67
F: 799.3
G: (–ø—É—Å—Ç–æ)
H: 12 748 ‚ÇΩ - —Å –ø–µ—á–∞—Ç—å—é –¥–æ 2-—Ö —Ü–≤–µ—Ç–æ–≤
I: (–ø—É—Å—Ç–æ)
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç –≤ –ë–î:**

**products:**
```json
{
  "id": 15003,
  "project_id": 2115,
  "name": "–ü–æ–ª–æ—Ç–µ–Ω—Ü–µ",
  "custom_field": "70*140—Å–º, –≤–µ—Å 210–≥-215–≥, 100% –º–∏–∫—Ä–æ—Ñ–∏–±—Ä–∞\n+–ù–∞–Ω–µ—Å–µ–Ω–∏–µ: –ø–µ—á–∞—Ç—å –Ω–∞ —Å—É–º–∫–µ —à–µ–ª–∫–æ–≥—Ä–∞—Ñ–∏—è",
  "sample_price": "7539‚ÇΩ / 12748‚ÇΩ",
  "sample_delivery_time": 22
}
```

**price_offers:** (2 –∑–∞–ø–∏—Å–∏ - –±–∞–∑–æ–≤–∞—è + —Å –ø–µ—á–∞—Ç—å—é)
```json
[
  {
    "product_id": 15003,
    "quantity": 164,
    "price_usd": 8.37,
    "price_rub": 771.75,
    "delivery_time": "50 –¥–Ω–µ–π",
    "delivery_route": null
  },
  {
    "product_id": 15003,
    "quantity": 164,
    "price_usd": 8.67,
    "price_rub": 799.30,
    "delivery_time": "50 –¥–Ω–µ–π",
    "delivery_route": null
  }
]
```

---

## üîÑ –ê–õ–ì–û–†–ò–¢–ú –ü–ê–†–°–ò–ù–ì–ê

### –®–∞–≥ 1: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
```python
DATA_START_ROW = 3  # –°—Ç—Ä–æ–∫–∞ 2 = –∑–∞–≥–æ–ª–æ–≤–∫–∏, —Å—Ç—Ä–æ–∫–∞ 3 = –¥–∞–Ω–Ω—ã–µ
COLUMNS = {
    'photo': 'A',
    'name': 'B',
    'description': 'C',
    'quantity': 'D',
    'price_usd': 'E',
    'price_rub': 'F',
    'delivery_time': 'G',
    'sample_price': 'H',
    'sample_delivery': 'I',
    'extra_photo': 'J'
}
```

### –®–∞–≥ 2: –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ multi-row —Ç–æ–≤–∞—Ä–æ–≤
```python
def is_new_product(row):
    """
    –ù–æ–≤—ã–π —Ç–æ–≤–∞—Ä –µ—Å–ª–∏ –µ—Å—Ç—å –Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –≤ –∫–æ–ª–æ–Ω–∫–µ B
    """
    return bool(row['name'])

def is_additional_row(row):
    """
    –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Å—Ç—Ä–æ–∫–∞ –µ—Å–ª–∏:
    - –ù–ï–¢ –Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏—è
    - –ï–°–¢–¨ —Ü–µ–Ω—ã –∏–ª–∏ –æ–ø–∏—Å–∞–Ω–∏–µ
    """
    return not row['name'] and (row['price_usd'] or row['description'])
```

### –®–∞–≥ 3: –ü–∞—Ä—Å–∏–Ω–≥ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∏ —Ü–µ–Ω
```python
def parse_quantity_and_prices(quantity_cell, usd_cell, rub_cell, delivery_cell):
    """
    –ü–∞—Ä—Å–∏–º –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –∏–∑ —è—á–µ–µ–∫
    
    –ü—Ä–∏–º–µ—Ä:
    quantity_cell = "2000\n4000"
    usd_cell = "0.49\n0.75\n\n0.46\n0.71"
    
    –†–µ–∑—É–ª—å—Ç–∞—Ç:
    [
      (2000, 0.49, 47.16, "20 –¥–Ω–µ–π"),
      (4000, 0.75, 73.37, "20 –¥–Ω–µ–π"),
      (2000, 0.46, 43.97, "16 –¥–Ω–µ–π"),
      (4000, 0.71, 70.17, "16 –¥–Ω–µ–π")
    ]
    """
    quantities = parse_multiline(quantity_cell)
    usd_prices = parse_multiline(usd_cell)
    rub_prices = parse_multiline(rub_cell)
    deliveries = parse_multiline(delivery_cell)
    
    # –ì—Ä—É–ø–ø–∏—Ä—É–µ–º –ø–æ –ø–∞—Ä–∞–º
    offers = []
    # ... –ª–æ–≥–∏–∫–∞ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏
    
    return offers
```

### –®–∞–≥ 4: –ü–∞—Ä—Å–∏–Ω–≥ –æ–±—Ä–∞–∑—Ü–∞
```python
def parse_sample(sample_price_cell, sample_delivery_cell):
    """
    sample_price_cell = "7900 —Ä—É–±\n8100 —Ä—É–±"
    sample_delivery_cell = "20-22 –∫–∞–ª–µ–Ω–¥.–¥–Ω—è"
    
    –†–µ–∑—É–ª—å—Ç–∞—Ç:
    {
      'price': "7900 —Ä—É–± / 8100 —Ä—É–±",
      'delivery_time': 22  # –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
    }
    """
    # –û–±—ä–µ–¥–∏–Ω—è–µ–º —Ü–µ–Ω—ã —á–µ—Ä–µ–∑ " / "
    prices = [p.strip() for p in sample_price_cell.split('\n') if p.strip()]
    price_str = " / ".join(prices) if prices else None
    
    # –ü–∞—Ä—Å–∏–º —Å—Ä–æ–∫: "20-22 –¥–Ω—è" ‚Üí 22
    delivery_time = parse_max_days(sample_delivery_cell)
    
    return {'price': price_str, 'delivery_time': delivery_time}
```

### –®–∞–≥ 5: –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
```python
def extract_images(ws, row_num):
    """
    –ò–∑–≤–ª–µ–∫–∞–µ–º:
    - –ì–ª–∞–≤–Ω–æ–µ —Ñ–æ—Ç–æ –∏–∑ A{row_num}
    - –î–æ–ø. —Ñ–æ—Ç–æ –∏–∑ J{row_num} (–º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ)
    """
    images = []
    
    # –ì–ª–∞–≤–Ω–æ–µ —Ñ–æ—Ç–æ
    main_image = extract_image_from_cell(ws, row_num, 'A')
    if main_image:
        images.append({
            'data': main_image,
            'filename': f'{table_id}_A{row_num}_{hash}.png',
            'is_main': True
        })
    
    # –î–æ–ø. —Ñ–æ—Ç–æ (–º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤ –æ–¥–Ω–æ–π —è—á–µ–π–∫–µ)
    extra_images = extract_all_images_from_cell(ws, row_num, 'J')
    for idx, img_data in enumerate(extra_images, 1):
        images.append({
            'data': img_data,
            'filename': f'{table_id}_J{row_num}_{idx}_{hash}.png',
            'is_main': False
        })
    
    return images
```

---

## üìä –û–ñ–ò–î–ê–ï–ú–´–ô –†–ï–ó–£–õ–¨–¢–ê–¢

### –ù–∞ 230 –ø—Ä–æ–µ–∫—Ç–æ–≤ –®–∞–±–ª–æ–Ω–∞ 5:

```
–ü—Ä–æ–µ–∫—Ç–æ–≤:      230
‚îú‚îÄ‚îÄ –¢–æ–≤–∞—Ä–æ–≤:   ~1,000-1,500
‚îú‚îÄ‚îÄ –û—Ñ—Ñ–µ—Ä–æ–≤:   ~3,000-5,000  (–º–µ–Ω—å—à–µ —á–µ–º –®–∞–±–ª–æ–Ω 4, —Ç.–∫. –Ω–µ—Ç —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –ñ–î/–ê–≤–∏–∞)
‚îî‚îÄ‚îÄ –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π: ~2,000-3,000
```

### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –®–∞–±–ª–æ–Ω–æ–º 4:

| –ú–µ—Ç—Ä–∏–∫–∞ | –®–∞–±–ª–æ–Ω 4 (277 –ø—Ä–æ–µ–∫—Ç–æ–≤) | –®–∞–±–ª–æ–Ω 5 (230 –ø—Ä–æ–µ–∫—Ç–æ–≤) |
|---------|--------------------------|--------------------------|
| –¢–æ–≤–∞—Ä–æ–≤ | 1,156 (4.2 –Ω–∞ –ø—Ä–æ–µ–∫—Ç) | ~1,150 (5.0 –Ω–∞ –ø—Ä–æ–µ–∫—Ç) |
| –û—Ñ—Ñ–µ—Ä–æ–≤ | 3,298 (2.9 –Ω–∞ —Ç–æ–≤–∞—Ä) | ~2,500 (2.2 –Ω–∞ —Ç–æ–≤–∞—Ä) |
| –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π | 2,560 (2.2 –Ω–∞ —Ç–æ–≤–∞—Ä) | ~2,300 (2.0 –Ω–∞ —Ç–æ–≤–∞—Ä) |

**–ü–æ—á–µ–º—É –º–µ–Ω—å—à–µ –æ—Ñ—Ñ–µ—Ä–æ–≤:**
- –®–∞–±–ª–æ–Ω 4: –∫–∞–∂–¥—ã–π —Ç–∏—Ä–∞–∂ = 2 –æ—Ñ—Ñ–µ—Ä–∞ (–ñ–î + –ê–≤–∏–∞)
- –®–∞–±–ª–æ–Ω 5: –∫–∞–∂–¥—ã–π —Ç–∏—Ä–∞–∂ = 1 –æ—Ñ—Ñ–µ—Ä (–µ–¥–∏–Ω–∞—è —Ü–µ–Ω–∞)

---

## üöÄ –ü–õ–ê–ù –†–ê–ó–†–ê–ë–û–¢–ö–ò

### –≠—Ç–∞–ø 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ (30 –º–∏–Ω)
- ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∞ (TEMPLATE_5_STRUCTURE.md)
- ‚è≥ –°–æ–∑–¥–∞—Ç—å –ø–∞—Ä—Å–µ—Ä `parse_template_5.py`
- ‚è≥ –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –±–∞–∑—É –∏–∑ `parse_template_4.py`
- ‚è≥ –ê–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–¥ –®–∞–±–ª–æ–Ω 5

### –≠—Ç–∞–ø 2: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (1-2 —á–∞—Å–∞)
- –¢–µ—Å—Ç –Ω–∞ 5 –ø—Ä–æ–µ–∫—Ç–∞—Ö
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–æ–∫

### –≠—Ç–∞–ø 3: –ü–æ–ª–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥ (2-3 —á–∞—Å–∞)
- –ü–∞—Ä—Å–∏–Ω–≥ –≤—Å–µ—Ö 230 –ø—Ä–æ–µ–∫—Ç–æ–≤
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –æ—à–∏–±–æ–∫
- –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –Ω–∞ S3

### –≠—Ç–∞–ø 4: –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è (30 –º–∏–Ω)
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ Railway –ë–î
- –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –æ–∂–∏–¥–∞–µ–º—ã–º–∏ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è–º–∏
- –°–æ–∑–¥–∞–Ω–∏–µ –æ—Ç—á–µ—Ç–∞

---

## ‚ö†Ô∏è –û–¢–õ–ò–ß–ò–Ø –í –ö–û–î–ï

### parse_template_4.py ‚Üí parse_template_5.py

**1. –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã:**
```python
# –ë—ã–ª–æ (–®–∞–±–ª–æ–Ω 4):
DATA_START_ROW = 5
COLUMNS = {..., 'custom_field': 'D', 'quantity': 'E', ...}

# –°—Ç–∞–ª–æ (–®–∞–±–ª–æ–Ω 5):
DATA_START_ROW = 3
COLUMNS = {..., 'quantity': 'D', ...}  # –Ω–µ—Ç custom_field
```

**2. –ü–∞—Ä—Å–∏–Ω–≥ –æ—Ñ—Ñ–µ—Ä–æ–≤:**
```python
# –ë—ã–ª–æ (–®–∞–±–ª–æ–Ω 4): 2 –æ—Ñ—Ñ–µ—Ä–∞ –Ω–∞ —Ç–∏—Ä–∞–∂
offers.append({
    'quantity': qty,
    'price_usd': jd_usd,
    'price_rub': jd_rub,
    'delivery_route': 'highway_jd'
})
offers.append({
    'quantity': qty,
    'price_usd': avia_usd,
    'price_rub': avia_rub,
    'delivery_route': 'highway_avia'
})

# –°—Ç–∞–ª–æ (–®–∞–±–ª–æ–Ω 5): 1 –æ—Ñ—Ñ–µ—Ä –Ω–∞ —Ç–∏—Ä–∞–∂
offers.append({
    'quantity': qty,
    'price_usd': usd,
    'price_rub': rub,
    'delivery_route': None  # –Ω–µ—Ç –º–∞—Ä—à—Ä—É—Ç–∞
})
```

**3. custom_field:**
```python
# –ë—ã–ª–æ (–®–∞–±–ª–æ–Ω 4):
custom_field = self._get_cell_value(ws_data, row, 'custom_field')

# –°—Ç–∞–ª–æ (–®–∞–±–ª–æ–Ω 5):
custom_field = self._get_cell_value(ws_data, row, 'description')
# –¥–∏–∑–∞–π–Ω —É–∂–µ –≤–Ω—É—Ç—Ä–∏ –æ–ø–∏—Å–∞–Ω–∏—è
```

---

**–ì–æ—Ç–æ–≤–æ –∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏!** üöÄ

–•–æ—á–µ—à—å –Ω–∞—á–∞—Ç—å —Å–æ–∑–¥–∞–≤–∞—Ç—å –ø–∞—Ä—Å–µ—Ä –¥–ª—è –®–∞–±–ª–æ–Ω–∞ 5?






**–î–∞—Ç–∞:** 09.10.2025  
**–ü—Ä–æ–µ–∫—Ç–æ–≤:** 230

---

## üéØ –ö–õ–Æ–ß–ï–í–´–ï –û–¢–õ–ò–ß–ò–Ø –û–¢ –®–ê–ë–õ–û–ù–ê 4

### 1Ô∏è‚É£ –ú–∞—Ä—à—Ä—É—Ç—ã –¥–æ—Å—Ç–∞–≤–∫–∏

**–®–∞–±–ª–æ–Ω 4:**
```
–¢–∏—Ä–∞–∂: 1000 —à—Ç
‚îú‚îÄ‚îÄ Highway –ñ–î:  5.50$ / 500‚ÇΩ / 45 –¥–Ω–µ–π
‚îî‚îÄ‚îÄ Highway Avia: 6.20$ / 580‚ÇΩ / 15 –¥–Ω–µ–π

‚Üí –†–µ–∑—É–ª—å—Ç–∞—Ç: 2 price_offers
```

**–®–∞–±–ª–æ–Ω 5:**
```
–¢–∏—Ä–∞–∂: 2000 —à—Ç
‚îî‚îÄ‚îÄ –ï–¥–∏–Ω–∞—è —Ü–µ–Ω–∞: 0.49$ / 47‚ÇΩ / 15-20 –¥–Ω–µ–π

‚Üí –†–µ–∑—É–ª—å—Ç–∞—Ç: 1 price_offer (–±–µ–∑ delivery_route)
```

### 2Ô∏è‚É£ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–æ–ª–æ–Ω–æ–∫

| –ü–æ–ª–µ | –®–∞–±–ª–æ–Ω 4 | –®–∞–±–ª–æ–Ω 5 | –ö—É–¥–∞ –ø–∞—Ä—Å–∏–º |
|------|----------|----------|-------------|
| –§–æ—Ç–æ | A | A | `product_images` (is_main=true) |
| –ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ | B | B | `products.name` |
| –û–ø–∏—Å–∞–Ω–∏–µ | C | C | `products.custom_field` |
| –ö–∞—Å—Ç–æ–º/–î–∏–∑–∞–π–Ω | D | - | (–≤ –®–∞–±–ª–æ–Ω–µ 5 –≤ –æ–ø–∏—Å–∞–Ω–∏–∏) |
| –¢–∏—Ä–∞–∂ | E | D | `price_offers.quantity` |
| –¶–µ–Ω–∞ USD | F,I | E | `price_offers.price_usd` |
| –¶–µ–Ω–∞ RUB | G,J | F | `price_offers.price_rub` |
| –°—Ä–æ–∫ | H,K | G | `price_offers.delivery_time` |
| –û–±—Ä–∞–∑–µ—Ü —Ü–µ–Ω–∞ | N | H | `products.sample_price` |
| –û–±—Ä–∞–∑–µ—Ü —Å—Ä–æ–∫ | P | I | `products.sample_delivery_time` |
| –î–æ–ø. —Ñ–æ—Ç–æ | Q | J | `product_images` (is_main=false) |

### 3Ô∏è‚É£ –ü–æ–∑–∏—Ü–∏—è –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤

```
–®–∞–±–ª–æ–Ω 4:
–°—Ç—Ä–æ–∫–∞ 1: (—Å–ª—É–∂–µ–±–Ω–∞—è)
–°—Ç—Ä–æ–∫–∞ 2: (—Å–ª—É–∂–µ–±–Ω–∞—è)
–°—Ç—Ä–æ–∫–∞ 3: (—Å–ª—É–∂–µ–±–Ω–∞—è)
–°—Ç—Ä–æ–∫–∞ 4: [–ó–ê–ì–û–õ–û–í–ö–ò]
–°—Ç—Ä–æ–∫–∞ 5: [–î–ê–ù–ù–´–ï]

–®–∞–±–ª–æ–Ω 5:
–°—Ç—Ä–æ–∫–∞ 1: –ú–µ–Ω–µ–¥–∂–µ—Ä, –ø—Ä–∏–º–µ—á–∞–Ω–∏—è
–°—Ç—Ä–æ–∫–∞ 2: [–ó–ê–ì–û–õ–û–í–ö–ò]
–°—Ç—Ä–æ–∫–∞ 3: [–î–ê–ù–ù–´–ï]
```

---

## üìù –ü–†–ò–ú–ï–†–´ –†–ï–ó–£–õ–¨–¢–ê–¢–ê –ü–ê–†–°–ò–ù–ì–ê

### –ü—Ä–∏–º–µ—Ä 1: –ü—Ä–æ—Å—Ç–æ–π —Ç–æ–≤–∞—Ä

**Excel (–®–∞–±–ª–æ–Ω 5):**
```
A: [—Ñ–æ—Ç–æ]
B: –°–≤–µ—Ç–æ–æ—Ç—Ä–∞–∂–∞—é—â–∏–µ—Å—è —à–Ω—É—Ä–∫–∏
C: –†–∞–∑–º–µ—Ä: 9—Ö120–º–º, –ú–∞—Ç–µ—Ä–∏–∞–ª: –ü–æ–ª–∏—ç—Å—Ç–µ—Ä
D: 2000
   4000
E: 0,49
   0,75
   
   0,46
   0,71
F: 47,16 ‚ÇΩ
   73,37 ‚ÇΩ
   
   43,97 ‚ÇΩ
   70,17 ‚ÇΩ
G: 15-20 –∫–¥
   
   14-16 –∫–¥
H: -
I: -
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç –≤ –ë–î:**

**products:**
```json
{
  "id": 15001,
  "project_id": 1912,
  "name": "–°–≤–µ—Ç–æ–æ—Ç—Ä–∞–∂–∞—é—â–∏–µ—Å—è —à–Ω—É—Ä–∫–∏",
  "custom_field": "–†–∞–∑–º–µ—Ä: 9—Ö120–º–º, –ú–∞—Ç–µ—Ä–∏–∞–ª: –ü–æ–ª–∏—ç—Å—Ç–µ—Ä",
  "sample_price": null,
  "sample_delivery_time": null
}
```

**price_offers:** (4 –∑–∞–ø–∏—Å–∏)
```json
[
  {
    "product_id": 15001,
    "quantity": 2000,
    "price_usd": 0.49,
    "price_rub": 47.16,
    "delivery_time": "20 –¥–Ω–µ–π",
    "delivery_route": null
  },
  {
    "product_id": 15001,
    "quantity": 4000,
    "price_usd": 0.75,
    "price_rub": 73.37,
    "delivery_time": "20 –¥–Ω–µ–π",
    "delivery_route": null
  },
  {
    "product_id": 15001,
    "quantity": 2000,
    "price_usd": 0.46,
    "price_rub": 43.97,
    "delivery_time": "16 –¥–Ω–µ–π",
    "delivery_route": null
  },
  {
    "product_id": 15001,
    "quantity": 4000,
    "price_usd": 0.71,
    "price_rub": 70.17,
    "delivery_time": "16 –¥–Ω–µ–π",
    "delivery_route": null
  }
]
```

**product_images:**
```json
{
  "product_id": 15001,
  "cell_position": "A3",
  "is_main_image": true,
  "image_url": "https://ru1.storage.beget.cloud/.../image.png"
}
```

---

### –ü—Ä–∏–º–µ—Ä 2: –¢–æ–≤–∞—Ä —Å –æ–±—Ä–∞–∑—Ü–æ–º

**Excel (–®–∞–±–ª–æ–Ω 5):**
```
A: [—Ñ–æ—Ç–æ]
B: –ü–µ—Å–æ—á–Ω—ã–µ —á–∞—Å—ã
C: –ú–∞—Ç–µ—Ä–∏–∞–ª: –ø–ª–∞—Å—Ç–∏–∫, —Å—Ç–µ–∫–ª–æ, –∞–∫—Ä–∏–ª. –†–∞–∑–º–µ—Ä: 10x5 —Å–º
D: 150
E: 4,03
   
   4,57
F: 386,98
   
   440,78
G: 40-45 –∫–∞–ª–µ–Ω–¥.–¥–Ω–µ–π
H: 7900 —Ä—É–±
   
   8100 —Ä—É–±
I: 20-22 –∫–∞–ª–µ–Ω–¥.–¥–Ω—è
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç –≤ –ë–î:**

**products:**
```json
{
  "id": 15002,
  "project_id": 1944,
  "name": "–ü–µ—Å–æ—á–Ω—ã–µ —á–∞—Å—ã",
  "custom_field": "–ú–∞—Ç–µ—Ä–∏–∞–ª: –ø–ª–∞—Å—Ç–∏–∫, —Å—Ç–µ–∫–ª–æ, –∞–∫—Ä–∏–ª. –†–∞–∑–º–µ—Ä: 10x5 —Å–º",
  "sample_price": "7900 —Ä—É–± / 8100 —Ä—É–±",
  "sample_delivery_time": 22
}
```

**price_offers:** (2 –∑–∞–ø–∏—Å–∏)
```json
[
  {
    "product_id": 15002,
    "quantity": 150,
    "price_usd": 4.03,
    "price_rub": 386.98,
    "delivery_time": "45 –¥–Ω–µ–π",
    "delivery_route": null
  },
  {
    "product_id": 15002,
    "quantity": 150,
    "price_usd": 4.57,
    "price_rub": 440.78,
    "delivery_time": "45 –¥–Ω–µ–π",
    "delivery_route": null
  }
]
```

---

### –ü—Ä–∏–º–µ—Ä 3: Multi-row —Ç–æ–≤–∞—Ä (—Å –¥–æ–ø. –æ–ø—Ü–∏—è–º–∏)

**Excel (–®–∞–±–ª–æ–Ω 5):**
```
–°—Ç—Ä–æ–∫–∞ 3:
A: [—Ñ–æ—Ç–æ]
B: –ü–æ–ª–æ—Ç–µ–Ω—Ü–µ
C: 70*140—Å–º, –≤–µ—Å 210–≥-215–≥, 100% –º–∏–∫—Ä–æ—Ñ–∏–±—Ä–∞
D: 164
E: 8.37
F: 771.75
G: 45-50–∫–¥
H: 7 539 ‚ÇΩ - –±–µ–∑ –ø–µ—á–∞—Ç–∏ –Ω–∞ —Å—É–º–∫–µ
I: 20-22–∫–¥

–°—Ç—Ä–æ–∫–∞ 4: (–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –æ–ø—Ü–∏—è)
A: (–ø—É—Å—Ç–æ)
B: (–ø—É—Å—Ç–æ)
C: +–ù–∞–Ω–µ—Å–µ–Ω–∏–µ: –ø–µ—á–∞—Ç—å –Ω–∞ —Å—É–º–∫–µ —à–µ–ª–∫–æ–≥—Ä–∞—Ñ–∏—è
D: (–ø—É—Å—Ç–æ)
E: 8.67
F: 799.3
G: (–ø—É—Å—Ç–æ)
H: 12 748 ‚ÇΩ - —Å –ø–µ—á–∞—Ç—å—é –¥–æ 2-—Ö —Ü–≤–µ—Ç–æ–≤
I: (–ø—É—Å—Ç–æ)
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç –≤ –ë–î:**

**products:**
```json
{
  "id": 15003,
  "project_id": 2115,
  "name": "–ü–æ–ª–æ—Ç–µ–Ω—Ü–µ",
  "custom_field": "70*140—Å–º, –≤–µ—Å 210–≥-215–≥, 100% –º–∏–∫—Ä–æ—Ñ–∏–±—Ä–∞\n+–ù–∞–Ω–µ—Å–µ–Ω–∏–µ: –ø–µ—á–∞—Ç—å –Ω–∞ —Å—É–º–∫–µ —à–µ–ª–∫–æ–≥—Ä–∞—Ñ–∏—è",
  "sample_price": "7539‚ÇΩ / 12748‚ÇΩ",
  "sample_delivery_time": 22
}
```

**price_offers:** (2 –∑–∞–ø–∏—Å–∏ - –±–∞–∑–æ–≤–∞—è + —Å –ø–µ—á–∞—Ç—å—é)
```json
[
  {
    "product_id": 15003,
    "quantity": 164,
    "price_usd": 8.37,
    "price_rub": 771.75,
    "delivery_time": "50 –¥–Ω–µ–π",
    "delivery_route": null
  },
  {
    "product_id": 15003,
    "quantity": 164,
    "price_usd": 8.67,
    "price_rub": 799.30,
    "delivery_time": "50 –¥–Ω–µ–π",
    "delivery_route": null
  }
]
```

---

## üîÑ –ê–õ–ì–û–†–ò–¢–ú –ü–ê–†–°–ò–ù–ì–ê

### –®–∞–≥ 1: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
```python
DATA_START_ROW = 3  # –°—Ç—Ä–æ–∫–∞ 2 = –∑–∞–≥–æ–ª–æ–≤–∫–∏, —Å—Ç—Ä–æ–∫–∞ 3 = –¥–∞–Ω–Ω—ã–µ
COLUMNS = {
    'photo': 'A',
    'name': 'B',
    'description': 'C',
    'quantity': 'D',
    'price_usd': 'E',
    'price_rub': 'F',
    'delivery_time': 'G',
    'sample_price': 'H',
    'sample_delivery': 'I',
    'extra_photo': 'J'
}
```

### –®–∞–≥ 2: –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ multi-row —Ç–æ–≤–∞—Ä–æ–≤
```python
def is_new_product(row):
    """
    –ù–æ–≤—ã–π —Ç–æ–≤–∞—Ä –µ—Å–ª–∏ –µ—Å—Ç—å –Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –≤ –∫–æ–ª–æ–Ω–∫–µ B
    """
    return bool(row['name'])

def is_additional_row(row):
    """
    –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Å—Ç—Ä–æ–∫–∞ –µ—Å–ª–∏:
    - –ù–ï–¢ –Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏—è
    - –ï–°–¢–¨ —Ü–µ–Ω—ã –∏–ª–∏ –æ–ø–∏—Å–∞–Ω–∏–µ
    """
    return not row['name'] and (row['price_usd'] or row['description'])
```

### –®–∞–≥ 3: –ü–∞—Ä—Å–∏–Ω–≥ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∏ —Ü–µ–Ω
```python
def parse_quantity_and_prices(quantity_cell, usd_cell, rub_cell, delivery_cell):
    """
    –ü–∞—Ä—Å–∏–º –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –∏–∑ —è—á–µ–µ–∫
    
    –ü—Ä–∏–º–µ—Ä:
    quantity_cell = "2000\n4000"
    usd_cell = "0.49\n0.75\n\n0.46\n0.71"
    
    –†–µ–∑—É–ª—å—Ç–∞—Ç:
    [
      (2000, 0.49, 47.16, "20 –¥–Ω–µ–π"),
      (4000, 0.75, 73.37, "20 –¥–Ω–µ–π"),
      (2000, 0.46, 43.97, "16 –¥–Ω–µ–π"),
      (4000, 0.71, 70.17, "16 –¥–Ω–µ–π")
    ]
    """
    quantities = parse_multiline(quantity_cell)
    usd_prices = parse_multiline(usd_cell)
    rub_prices = parse_multiline(rub_cell)
    deliveries = parse_multiline(delivery_cell)
    
    # –ì—Ä—É–ø–ø–∏—Ä—É–µ–º –ø–æ –ø–∞—Ä–∞–º
    offers = []
    # ... –ª–æ–≥–∏–∫–∞ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏
    
    return offers
```

### –®–∞–≥ 4: –ü–∞—Ä—Å–∏–Ω–≥ –æ–±—Ä–∞–∑—Ü–∞
```python
def parse_sample(sample_price_cell, sample_delivery_cell):
    """
    sample_price_cell = "7900 —Ä—É–±\n8100 —Ä—É–±"
    sample_delivery_cell = "20-22 –∫–∞–ª–µ–Ω–¥.–¥–Ω—è"
    
    –†–µ–∑—É–ª—å—Ç–∞—Ç:
    {
      'price': "7900 —Ä—É–± / 8100 —Ä—É–±",
      'delivery_time': 22  # –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
    }
    """
    # –û–±—ä–µ–¥–∏–Ω—è–µ–º —Ü–µ–Ω—ã —á–µ—Ä–µ–∑ " / "
    prices = [p.strip() for p in sample_price_cell.split('\n') if p.strip()]
    price_str = " / ".join(prices) if prices else None
    
    # –ü–∞—Ä—Å–∏–º —Å—Ä–æ–∫: "20-22 –¥–Ω—è" ‚Üí 22
    delivery_time = parse_max_days(sample_delivery_cell)
    
    return {'price': price_str, 'delivery_time': delivery_time}
```

### –®–∞–≥ 5: –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
```python
def extract_images(ws, row_num):
    """
    –ò–∑–≤–ª–µ–∫–∞–µ–º:
    - –ì–ª–∞–≤–Ω–æ–µ —Ñ–æ—Ç–æ –∏–∑ A{row_num}
    - –î–æ–ø. —Ñ–æ—Ç–æ –∏–∑ J{row_num} (–º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ)
    """
    images = []
    
    # –ì–ª–∞–≤–Ω–æ–µ —Ñ–æ—Ç–æ
    main_image = extract_image_from_cell(ws, row_num, 'A')
    if main_image:
        images.append({
            'data': main_image,
            'filename': f'{table_id}_A{row_num}_{hash}.png',
            'is_main': True
        })
    
    # –î–æ–ø. —Ñ–æ—Ç–æ (–º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤ –æ–¥–Ω–æ–π —è—á–µ–π–∫–µ)
    extra_images = extract_all_images_from_cell(ws, row_num, 'J')
    for idx, img_data in enumerate(extra_images, 1):
        images.append({
            'data': img_data,
            'filename': f'{table_id}_J{row_num}_{idx}_{hash}.png',
            'is_main': False
        })
    
    return images
```

---

## üìä –û–ñ–ò–î–ê–ï–ú–´–ô –†–ï–ó–£–õ–¨–¢–ê–¢

### –ù–∞ 230 –ø—Ä–æ–µ–∫—Ç–æ–≤ –®–∞–±–ª–æ–Ω–∞ 5:

```
–ü—Ä–æ–µ–∫—Ç–æ–≤:      230
‚îú‚îÄ‚îÄ –¢–æ–≤–∞—Ä–æ–≤:   ~1,000-1,500
‚îú‚îÄ‚îÄ –û—Ñ—Ñ–µ—Ä–æ–≤:   ~3,000-5,000  (–º–µ–Ω—å—à–µ —á–µ–º –®–∞–±–ª–æ–Ω 4, —Ç.–∫. –Ω–µ—Ç —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –ñ–î/–ê–≤–∏–∞)
‚îî‚îÄ‚îÄ –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π: ~2,000-3,000
```

### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –®–∞–±–ª–æ–Ω–æ–º 4:

| –ú–µ—Ç—Ä–∏–∫–∞ | –®–∞–±–ª–æ–Ω 4 (277 –ø—Ä–æ–µ–∫—Ç–æ–≤) | –®–∞–±–ª–æ–Ω 5 (230 –ø—Ä–æ–µ–∫—Ç–æ–≤) |
|---------|--------------------------|--------------------------|
| –¢–æ–≤–∞—Ä–æ–≤ | 1,156 (4.2 –Ω–∞ –ø—Ä–æ–µ–∫—Ç) | ~1,150 (5.0 –Ω–∞ –ø—Ä–æ–µ–∫—Ç) |
| –û—Ñ—Ñ–µ—Ä–æ–≤ | 3,298 (2.9 –Ω–∞ —Ç–æ–≤–∞—Ä) | ~2,500 (2.2 –Ω–∞ —Ç–æ–≤–∞—Ä) |
| –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π | 2,560 (2.2 –Ω–∞ —Ç–æ–≤–∞—Ä) | ~2,300 (2.0 –Ω–∞ —Ç–æ–≤–∞—Ä) |

**–ü–æ—á–µ–º—É –º–µ–Ω—å—à–µ –æ—Ñ—Ñ–µ—Ä–æ–≤:**
- –®–∞–±–ª–æ–Ω 4: –∫–∞–∂–¥—ã–π —Ç–∏—Ä–∞–∂ = 2 –æ—Ñ—Ñ–µ—Ä–∞ (–ñ–î + –ê–≤–∏–∞)
- –®–∞–±–ª–æ–Ω 5: –∫–∞–∂–¥—ã–π —Ç–∏—Ä–∞–∂ = 1 –æ—Ñ—Ñ–µ—Ä (–µ–¥–∏–Ω–∞—è —Ü–µ–Ω–∞)

---

## üöÄ –ü–õ–ê–ù –†–ê–ó–†–ê–ë–û–¢–ö–ò

### –≠—Ç–∞–ø 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ (30 –º–∏–Ω)
- ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∞ (TEMPLATE_5_STRUCTURE.md)
- ‚è≥ –°–æ–∑–¥–∞—Ç—å –ø–∞—Ä—Å–µ—Ä `parse_template_5.py`
- ‚è≥ –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –±–∞–∑—É –∏–∑ `parse_template_4.py`
- ‚è≥ –ê–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–¥ –®–∞–±–ª–æ–Ω 5

### –≠—Ç–∞–ø 2: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (1-2 —á–∞—Å–∞)
- –¢–µ—Å—Ç –Ω–∞ 5 –ø—Ä–æ–µ–∫—Ç–∞—Ö
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–æ–∫

### –≠—Ç–∞–ø 3: –ü–æ–ª–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥ (2-3 —á–∞—Å–∞)
- –ü–∞—Ä—Å–∏–Ω–≥ –≤—Å–µ—Ö 230 –ø—Ä–æ–µ–∫—Ç–æ–≤
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –æ—à–∏–±–æ–∫
- –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –Ω–∞ S3

### –≠—Ç–∞–ø 4: –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è (30 –º–∏–Ω)
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ Railway –ë–î
- –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –æ–∂–∏–¥–∞–µ–º—ã–º–∏ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è–º–∏
- –°–æ–∑–¥–∞–Ω–∏–µ –æ—Ç—á–µ—Ç–∞

---

## ‚ö†Ô∏è –û–¢–õ–ò–ß–ò–Ø –í –ö–û–î–ï

### parse_template_4.py ‚Üí parse_template_5.py

**1. –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã:**
```python
# –ë—ã–ª–æ (–®–∞–±–ª–æ–Ω 4):
DATA_START_ROW = 5
COLUMNS = {..., 'custom_field': 'D', 'quantity': 'E', ...}

# –°—Ç–∞–ª–æ (–®–∞–±–ª–æ–Ω 5):
DATA_START_ROW = 3
COLUMNS = {..., 'quantity': 'D', ...}  # –Ω–µ—Ç custom_field
```

**2. –ü–∞—Ä—Å–∏–Ω–≥ –æ—Ñ—Ñ–µ—Ä–æ–≤:**
```python
# –ë—ã–ª–æ (–®–∞–±–ª–æ–Ω 4): 2 –æ—Ñ—Ñ–µ—Ä–∞ –Ω–∞ —Ç–∏—Ä–∞–∂
offers.append({
    'quantity': qty,
    'price_usd': jd_usd,
    'price_rub': jd_rub,
    'delivery_route': 'highway_jd'
})
offers.append({
    'quantity': qty,
    'price_usd': avia_usd,
    'price_rub': avia_rub,
    'delivery_route': 'highway_avia'
})

# –°—Ç–∞–ª–æ (–®–∞–±–ª–æ–Ω 5): 1 –æ—Ñ—Ñ–µ—Ä –Ω–∞ —Ç–∏—Ä–∞–∂
offers.append({
    'quantity': qty,
    'price_usd': usd,
    'price_rub': rub,
    'delivery_route': None  # –Ω–µ—Ç –º–∞—Ä—à—Ä—É—Ç–∞
})
```

**3. custom_field:**
```python
# –ë—ã–ª–æ (–®–∞–±–ª–æ–Ω 4):
custom_field = self._get_cell_value(ws_data, row, 'custom_field')

# –°—Ç–∞–ª–æ (–®–∞–±–ª–æ–Ω 5):
custom_field = self._get_cell_value(ws_data, row, 'description')
# –¥–∏–∑–∞–π–Ω —É–∂–µ –≤–Ω—É—Ç—Ä–∏ –æ–ø–∏—Å–∞–Ω–∏—è
```

---

**–ì–æ—Ç–æ–≤–æ –∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏!** üöÄ

–•–æ—á–µ—à—å –Ω–∞—á–∞—Ç—å —Å–æ–∑–¥–∞–≤–∞—Ç—å –ø–∞—Ä—Å–µ—Ä –¥–ª—è –®–∞–±–ª–æ–Ω–∞ 5?












