# üìã –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –®–∞–±–ª–æ–Ω–∞ 4

**–î–∞—Ç–∞**: 08.10.2025  
**–í–∞–ª–∏–¥–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤**: 323

---

## üéØ –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

1. **–¢–∏—Ä–∞–∂ –≤ –∫–æ–ª–æ–Ω–∫–µ E** (–æ–¥–∏–Ω –¥–ª—è –≤—Å–µ—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤)
2. **Multi-row —Ç–æ–≤–∞—Ä—ã** (–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ç–∏—Ä–∞–∂–∏ –Ω–∞ —Å–ª–µ–¥—É—é—â–∏—Ö —Å—Ç—Ä–æ–∫–∞—Ö)
3. **–ö–æ–ª–æ–Ω–∫–∞ D = "–ö–∞—Å—Ç–æ–º" / "–î–∏–∑–∞–π–Ω"**
4. **–ï—Å—Ç—å "–ò—Ç–æ–≥–æ, —Ä—É–±"** (H, L) - –ò–ì–ù–û–†–ò–†–û–í–ê–¢–¨

---

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–±–ª–∏—Ü—ã

### –°—Ç—Ä–æ–∫–∞ 1: –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –º–µ–Ω–µ–¥–∂–µ—Ä–µ
```
B: –ú–µ–Ω–µ–¥–∂–µ—Ä, Email, –¢–µ–ª–µ—Ñ–æ–Ω
D: –ò–º—è –∏ –∫–æ–Ω—Ç–∞–∫—Ç—ã
F: –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ –æ —Ü–µ–Ω–∞—Ö
N: –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ –æ–± –æ–±—Ä–∞–∑—Ü–µ
```

### –°—Ç—Ä–æ–∫–∞ 2: –ó–∞–≥–æ–ª–æ–≤–∫–∏ –∫–æ–ª–æ–Ω–æ–∫
```
A: –§–æ—Ç–æ
B: –ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ
C: –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏
D: –ö–∞—Å—Ç–æ–º (–î–∏–∑–∞–π–Ω)
E: –¢–∏—Ä–∞–∂, —à—Ç
F: –î–æ—Å—Ç–∞–≤–∫–∞ –ñ–î
J: –î–æ—Å—Ç–∞–≤–∫–∞ –ê–í–ò–ê
N: –û–±—Ä–∞–∑–µ—Ü
Q: –î–æ–ø. —Ñ–æ—Ç–æ
```

### –°—Ç—Ä–æ–∫–∞ 3: –ü–æ–¥–∑–∞–≥–æ–ª–æ–≤–∫–∏
```
F: –¶–µ–Ω–∞ –∑–∞ —à—Ç., $
G: –¶–µ–Ω–∞ –∑–∞ —à—Ç., —Ä—É–±
H: –ò—Ç–æ–≥–æ, —Ä—É–± (SKIP!)
I: –°—Ä–æ–∫ —Ç–∏—Ä–∞–∂–∞, –∫.–¥.

J: –¶–µ–Ω–∞ –∑–∞ —à—Ç., $
K: –¶–µ–Ω–∞ –∑–∞ —à—Ç., —Ä—É–±
L: –ò—Ç–æ–≥–æ, —Ä—É–± (SKIP!)
M: –°—Ä–æ–∫ —Ç–∏—Ä–∞–∂–∞, –∫.–¥.

N: –¶–µ–Ω–∞ –∑–∞ —à—Ç., —Ä—É–±
O: –°—Ä–æ–∫ —Ñ–æ—Ç–æ –∏ –≤–∏–¥–µ–æ, –∫.–¥.
P: –°—Ä–æ–∫ —Å –¥–æ—Å—Ç–∞–≤–∫–æ–π, –∫.–¥.
```

### –°—Ç—Ä–æ–∫–∞ 4+: –î–∞–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä–æ–≤

---

## üîç –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–æ–ª–æ–Ω–æ–∫

| –ö–æ–ª–æ–Ω–∫–∞ | –ù–∞–∑–≤–∞–Ω–∏–µ | –¢–∏–ø | –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ |
|---------|----------|-----|------------|
| A | –§–æ—Ç–æ | IMAGE | –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ |
| B | –ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ | TEXT | –ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ |
| C | –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ | TEXT | –ú–∞—Ç–µ—Ä–∏–∞–ª, —Ä–∞–∑–º–µ—Ä, —É–ø–∞–∫–æ–≤–∫–∞ |
| D | –ö–∞—Å—Ç–æ–º/–î–∏–∑–∞–π–Ω | TEXT | –î–∏–∑–∞–π–Ω, –∫–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏—è |
| E | –¢–∏—Ä–∞–∂, —à—Ç | INTEGER | **–û–î–ò–ù –¥–ª—è –≤—Å–µ—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤** |
| F | –ñ–î: –¶–µ–Ω–∞ $ | FLOAT | –¶–µ–Ω–∞ –∑–∞ —à—Ç—É–∫—É –≤ –¥–æ–ª–ª–∞—Ä–∞—Ö |
| G | –ñ–î: –¶–µ–Ω–∞ —Ä—É–± | FLOAT | –¶–µ–Ω–∞ –∑–∞ —à—Ç—É–∫—É –≤ —Ä—É–±–ª—è—Ö |
| H | –ñ–î: –ò—Ç–æ–≥–æ —Ä—É–± | - | **SKIP (—Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è)** |
| I | –ñ–î: –°—Ä–æ–∫, –∫.–¥. | INTEGER | –°—Ä–æ–∫ –¥–æ—Å—Ç–∞–≤–∫–∏ –∫–∞–ª–µ–Ω–¥–∞—Ä–Ω—ã–µ –¥–Ω–∏ |
| J | –ê–í–ò–ê: –¶–µ–Ω–∞ $ | FLOAT | –¶–µ–Ω–∞ –∑–∞ —à—Ç—É–∫—É –≤ –¥–æ–ª–ª–∞—Ä–∞—Ö |
| K | –ê–í–ò–ê: –¶–µ–Ω–∞ —Ä—É–± | FLOAT | –¶–µ–Ω–∞ –∑–∞ —à—Ç—É–∫—É –≤ —Ä—É–±–ª—è—Ö |
| L | –ê–í–ò–ê: –ò—Ç–æ–≥–æ —Ä—É–± | - | **SKIP (—Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è)** |
| M | –ê–í–ò–ê: –°—Ä–æ–∫, –∫.–¥. | INTEGER | –°—Ä–æ–∫ –¥–æ—Å—Ç–∞–≤–∫–∏ –∫–∞–ª–µ–Ω–¥–∞—Ä–Ω—ã–µ –¥–Ω–∏ |
| N | –û–±—Ä–∞–∑–µ—Ü: –¶–µ–Ω–∞ —Ä—É–± | FLOAT | –¶–µ–Ω–∞ –æ–±—Ä–∞–∑—Ü–∞ –≤ —Ä—É–±–ª—è—Ö |
| O | –û–±—Ä–∞–∑–µ—Ü: –°—Ä–æ–∫ —Ñ–æ—Ç–æ | INTEGER | –°—Ä–æ–∫ —Ñ–æ—Ç–æ/–≤–∏–¥–µ–æ |
| P | –û–±—Ä–∞–∑–µ—Ü: –°—Ä–æ–∫ –¥–æ—Å—Ç–∞–≤–∫–∏ | INTEGER | –°—Ä–æ–∫ —Å –¥–æ—Å—Ç–∞–≤–∫–æ–π |
| Q | –î–æ–ø. —Ñ–æ—Ç–æ | IMAGE | –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ —Ñ–æ—Ç–æ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) |

---

## üîÑ Multi-row —Ç–æ–≤–∞—Ä—ã

### –ü—Ä–∞–≤–∏–ª–æ –ø–∞—Ä—Å–∏–Ω–≥–∞:

**–ï—Å–ª–∏ —Å—Ç—Ä–æ–∫–∞ –∏–º–µ–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ –≤ –∫–æ–ª–æ–Ω–∫–µ E (—Ç–∏—Ä–∞–∂), –Ω–æ –ù–ï–¢ –∑–Ω–∞—á–µ–Ω–∏—è –≤ –∫–æ–ª–æ–Ω–∫–µ B (–Ω–∞–∑–≤–∞–Ω–∏–µ)**  
‚Üí –≠—Ç–æ **–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Ç–∏—Ä–∞–∂** –¥–ª—è —Ç–æ–≤–∞—Ä–∞ –≤—ã—à–µ

### –ü—Ä–∏–º–µ—Ä:

```
–°—Ç—Ä–æ–∫–∞ 4:
  B: "–ù–∞–±–æ—Ä –±–æ–∫–∞–ª–æ–≤ (2 —à—Ç.)"    ‚Üê –¢–û–í–ê–† 1
  E: 300
  F-I: –¶–µ–Ω—ã –∏ —Å—Ä–æ–∫–∏ –ñ–î
  J-M: –¶–µ–Ω—ã –∏ —Å—Ä–æ–∫–∏ –ê–í–ò–ê

–°—Ç—Ä–æ–∫–∞ 5:
  B: (–ø—É—Å—Ç–æ)                     ‚Üê –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ô –¢–ò–†–ê–ñ
  E: 500                         ‚Üê –¥–ª—è –¢–û–í–ê–†–ê 1
  F-I: –¶–µ–Ω—ã –∏ —Å—Ä–æ–∫–∏ –ñ–î
  J-M: –¶–µ–Ω—ã –∏ —Å—Ä–æ–∫–∏ –ê–í–ò–ê

–°—Ç—Ä–æ–∫–∞ 6:
  B: (–ø—É—Å—Ç–æ)                     ‚Üê –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ô –¢–ò–†–ê–ñ
  E: 1000                        ‚Üê –¥–ª—è –¢–û–í–ê–†–ê 1
  F-I: –¶–µ–Ω—ã –∏ —Å—Ä–æ–∫–∏ –ñ–î
  J-M: –¶–µ–Ω—ã –∏ —Å—Ä–æ–∫–∏ –ê–í–ò–ê

–°—Ç—Ä–æ–∫–∞ 7:
  B: "–ù–∞–±–æ—Ä —Å—Ç–∞–∫–∞–Ω–æ–≤ (2 —à—Ç.)"   ‚Üê –¢–û–í–ê–† 2
  E: 300
  F-I: –¶–µ–Ω—ã –∏ —Å—Ä–æ–∫–∏ –ñ–î
  J-M: –¶–µ–Ω—ã –∏ —Å—Ä–æ–∫–∏ –ê–í–ò–ê
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç**:
- –¢–æ–≤–∞—Ä 1: 3 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è (300, 500, 1000 —à—Ç)
- –¢–æ–≤–∞—Ä 2: –Ω–∞—á–∞–ª–æ –Ω–æ–≤—ã—Ö –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π

---

## üéØ –ê–ª–≥–æ—Ä–∏—Ç–º –ø–∞—Ä—Å–∏–Ω–≥–∞

### 1. –ù–∞—á–∞–ª–æ –Ω–æ–≤–æ–≥–æ —Ç–æ–≤–∞—Ä–∞

–£—Å–ª–æ–≤–∏—è:
- –°—Ç—Ä–æ–∫–∞ –∏–º–µ–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ –≤ –∫–æ–ª–æ–Ω–∫–µ B (–Ω–∞–∑–≤–∞–Ω–∏–µ)
- –ò–õ–ò –ø–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞ –¥–∞–Ω–Ω—ã—Ö (row >= 4)

–î–µ–π—Å—Ç–≤–∏—è:
- –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π —Ç–æ–≤–∞—Ä
- –ò–∑–≤–ª–µ—á—å: –Ω–∞–∑–≤–∞–Ω–∏–µ (B), —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ (C), –¥–∏–∑–∞–π–Ω (D)
- –ò–∑–≤–ª–µ—á—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏–∑ A

### 2. –ü–∞—Ä—Å–∏–Ω–≥ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π

–î–ª—è –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–∏ —Å —Ç–∏—Ä–∞–∂–æ–º (E):

#### –ñ–î –º–∞—Ä—à—Ä—É—Ç:
```python
if F or G:  # –ï—Å—Ç—å —Ü–µ–Ω—ã
    offer_jd = {
        'quantity': E,
        'price_usd': F,
        'price_rub': G,
        'route': '–ñ–î',
        'delivery_time_days': I
    }
```

#### –ê–í–ò–ê –º–∞—Ä—à—Ä—É—Ç:
```python
if J or K:  # –ï—Å—Ç—å —Ü–µ–Ω—ã
    offer_avia = {
        'quantity': E,  # –¢–û–¢ –ñ–ï —Ç–∏—Ä–∞–∂!
        'price_usd': J,
        'price_rub': K,
        'route': '–ê–í–ò–ê',
        'delivery_time_days': M
    }
```

#### –û–±—Ä–∞–∑–µ—Ü (—Ç–æ–ª—å–∫–æ –¥–ª—è –ø–µ—Ä–≤–æ–π —Å—Ç—Ä–æ–∫–∏ —Ç–æ–≤–∞—Ä–∞):
```python
if N and row == first_row_of_product:
    offer_sample = {
        'quantity': 1,
        'price_rub': N,
        'route': '–û–±—Ä–∞–∑–µ—Ü',
        'delivery_time_days': P
    }
```

### 3. –ü–µ—Ä–µ—Ö–æ–¥ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —Ç–æ–≤–∞—Ä—É

–£—Å–ª–æ–≤–∏—è:
- –°–ª–µ–¥—É—é—â–∞—è —Å—Ç—Ä–æ–∫–∞ –∏–º–µ–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ –≤ B (–Ω–∞–∑–≤–∞–Ω–∏–µ)
- –ò–õ–ò –∫–æ–Ω–µ—Ü –¥–∞–Ω–Ω—ã—Ö

–î–µ–π—Å—Ç–≤–∏—è:
- –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–µ–∫—É—â–∏–π —Ç–æ–≤–∞—Ä —Å–æ –≤—Å–µ–º–∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è–º–∏
- –ù–∞—á–∞—Ç—å –Ω–æ–≤—ã–π —Ç–æ–≤–∞—Ä

---

## üìä –ü—Ä–∏–º–µ—Ä —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö

### –¢–æ–≤–∞—Ä "–ù–∞–±–æ—Ä –±–æ–∫–∞–ª–æ–≤":

```json
{
  "name": "–ù–∞–±–æ—Ä –±–æ–∫–∞–ª–æ–≤ (2 —à—Ç.)",
  "description": "–ú–∞—Ç–µ—Ä–∏–∞–ª: —Å—Ç–µ–∫–ª–æ\n–†–∞–∑–º–µ—Ä: 27*7 —Å–º\n–£–ø–∞–∫–æ–≤–∫–∞: –ø–æ 2 —à—Ç. –≤ —Ñ–∞–±—Ä–∏—á",
  "custom_field": "–î–∏–∑–∞–π–Ω: –¥–µ–∫–æ–ª—å (1 —Ü–≤–µ—Ç, –∑–æ–ª–æ—Ç–æ–π); –≤ 1 –Ω–∞–±–æ—Ä–µ 2 –¥–∏–∑–∞–π–Ω–∞",
  "offers": [
    {
      "quantity": 300,
      "price_usd": 26.50,
      "price_rub": 2226.15,
      "route": "–ñ–î",
      "delivery_time_days": 70
    },
    {
      "quantity": 300,
      "price_usd": 31.64,
      "price_rub": 2657.35,
      "route": "–ê–í–ò–ê",
      "delivery_time_days": 60
    },
    {
      "quantity": 500,
      "price_usd": 25.44,
      "price_rub": 2136.75,
      "route": "–ñ–î",
      "delivery_time_days": 70
    },
    {
      "quantity": 500,
      "price_usd": 30.57,
      "price_rub": 2567.95,
      "route": "–ê–í–ò–ê",
      "delivery_time_days": 60
    },
    {
      "quantity": 1000,
      "price_usd": 25.07,
      "price_rub": 2105.84,
      "route": "–ñ–î",
      "delivery_time_days": 70
    },
    {
      "quantity": 1000,
      "price_usd": 30.20,
      "price_rub": 2537.04,
      "route": "–ê–í–ò–ê",
      "delivery_time_days": 60
    },
    {
      "quantity": 1,
      "price_rub": 13500.0,
      "route": "–û–±—Ä–∞–∑–µ—Ü",
      "delivery_time_days": 22
    }
  ],
  "images": [
    {
      "cell_position": "A4",
      "is_main": true
    }
  ]
}
```

**–ò—Ç–æ–≥–æ**: 7 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π –¥–ª—è 1 —Ç–æ–≤–∞—Ä–∞ (3 —Ç–∏—Ä–∞–∂–∞ √ó 2 –º–∞—Ä—à—Ä—É—Ç–∞ + 1 –æ–±—Ä–∞–∑–µ—Ü)

---

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

### 1. –°—Ä–æ–∫–∏ –¥–æ—Å—Ç–∞–≤–∫–∏ —Å –¥–∏–∞–ø–∞–∑–æ–Ω–æ–º

–§–æ—Ä–º–∞—Ç: `"60-70"` –∏–ª–∏ `"20-22"`

**–ü—Ä–∞–≤–∏–ª–æ**: –ë–µ—Ä–µ–º **–ú–ê–ö–°–ò–ú–£–ú** (—Ö—É–∂–µ –¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞, –Ω–æ –±–µ–∑–æ–ø–∞—Å–Ω–µ–µ)

```python
def parse_delivery_time(value):
    if '-' in str(value):
        return int(value.split('-')[-1])
    return int(value)
```

### 2. –ö–æ–ª–æ–Ω–∫–∏ "–ò—Ç–æ–≥–æ, —Ä—É–±" (H, L)

**–í–°–ï–ì–î–ê –ò–ì–ù–û–†–ò–†–û–í–ê–¢–¨!**

–≠—Ç–æ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º–æ–µ –ø–æ–ª–µ = —Ç–∏—Ä–∞–∂ √ó —Ü–µ–Ω–∞ –∑–∞ —à—Ç.

### 3. –û–±—Ä–∞–∑–µ—Ü

–ü–∞—Ä—Å–∏—Ç—Å—è **–¢–û–õ–¨–ö–û –¥–ª—è –ø–µ—Ä–≤–æ–π —Å—Ç—Ä–æ–∫–∏** —Ç–æ–≤–∞—Ä–∞ (–Ω–µ –¥–ª—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —Ç–∏—Ä–∞–∂–µ–π)

### 4. –ü—É—Å—Ç—ã–µ —Å—Ç—Ä–æ–∫–∏

–ï—Å–ª–∏ —Å—Ç—Ä–æ–∫–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø—É—Å—Ç–∞—è (–Ω–µ—Ç —Ç–∏—Ä–∞–∂–∞ –∏ –Ω–∞–∑–≤–∞–Ω–∏—è) ‚Üí **SKIP**

---

## üìù –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è:

- ‚úÖ –ù–∞–∑–≤–∞–Ω–∏–µ (B) - –º–∏–Ω–∏–º—É–º 3 —Å–∏–º–≤–æ–ª–∞
- ‚úÖ –•–æ—Ç—è –±—ã 1 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ (—Ç–∏—Ä–∞–∂ + —Ü–µ–Ω–∞ + –º–∞—Ä—à—Ä—É—Ç)

### –§–∏–ª—å—Ç—Ä—ã –∞–Ω–æ–º–∞–ª–∏–π:

```python
# –¢–∏—Ä–∞–∂
if qty <= 0 or qty > 1_000_000: skip

# –¶–µ–Ω–∞ USD
if price_usd > 10_000: skip

# –¶–µ–Ω–∞ RUB
if price_rub > 1_000_000: skip

# –°—Ä–æ–∫–∏
if days > 365: use_default (60 –¥–ª—è –ñ–î, 40 –¥–ª—è –ê–í–ò–ê)
```

---

## üöÄ –ì–æ—Ç–æ–≤–æ –∫ –ø–∞—Ä—Å–∏–Ω–≥—É!

**–§–∞–π–ª**: `template_4_valid_ids.txt`  
**–ü—Ä–æ–µ–∫—Ç–æ–≤**: 323  
**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**: ~900 —Ç–æ–≤–∞—Ä–æ–≤, ~2700 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π

