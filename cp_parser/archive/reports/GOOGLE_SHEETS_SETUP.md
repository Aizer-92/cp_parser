# Google Sheets Integration - Setup Guide

## ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ Google Spreadsheet —á–µ—Ä–µ–∑ Service Account
- ‚úÖ **–ü—É–±–ª–∏—á–Ω—ã–µ –ø—Ä–∞–≤–∞: anyone with link can EDIT**
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (–∑–∞–≥–æ–ª–æ–≤–∫–∏, –∫—É—Ä—Å–∏–≤, –∞–≤—Ç–æ—à–∏—Ä–∏–Ω–∞)
- ‚úÖ API endpoint `/api/kp/generate/google-sheets`
- ‚úÖ UI –∫–Ω–æ–ø–∫–∞ (—Å–∏–Ω—è—è, —Å –∏–∫–æ–Ω–∫–æ–π –≥—Ä–∞—Ñ–∏–∫–æ–≤)
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ—Ç–∫—Ä—ã—Ç–∏–µ –≤ –Ω–æ–≤–æ–π –≤–∫–ª–∞–¥–∫–µ

---

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ (–¥–ª—è Railway)

### 1. Google Service Account

–£ —Ç–µ–±—è —É–∂–µ –µ—Å—Ç—å Google Cloud credentials! –ù—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –∏—Ö –≤ Railway.

### 2. –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–î–æ–±–∞–≤—å –≤ Railway –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é:

```
GOOGLE_CREDENTIALS_JSON
```

**–ó–Ω–∞—á–µ–Ω–∏–µ:** JSON —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞ Service Account credentials.

**–§–æ—Ä–º–∞—Ç:**
```json
{
  "type": "service_account",
  "project_id": "–≤–∞—à-–ø—Ä–æ–µ–∫—Ç",
  "private_key_id": "...",
  "private_key": "-----BEGIN PRIVATE KEY-----\n...",
  "client_email": "service-account@–≤–∞—à-–ø—Ä–æ–µ–∫—Ç.iam.gserviceaccount.com",
  "client_id": "...",
  "auth_uri": "https://accounts.google.com/o/oauth2/auth",
  "token_uri": "https://oauth2.googleapis.com/token",
  "auth_provider_x509_cert_url": "https://www.googleapis.com/oauth2/v1/certs",
  "client_x509_cert_url": "..."
}
```

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞

–ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è:
1. –ó–∞–π–¥–∏ –≤ `/kp`
2. –î–æ–±–∞–≤—å —Ç–æ–≤–∞—Ä—ã –≤ –ö–ü
3. –ö–ª–∏–∫–Ω–∏ —Å–∏–Ω—é—é –∫–Ω–æ–ø–∫—É **Google Sheets**
4. –û—Ç–∫—Ä–æ–µ—Ç—Å—è –Ω–æ–≤–∞—è –≤–∫–ª–∞–¥–∫–∞ —Å —Ç–∞–±–ª–∏—Ü–µ–π
5. **–ü—Ä–æ–≤–µ—Ä—å –ø—Ä–∞–≤–∞:** Share ‚Üí Anyone with the link ‚Üí Editor

---

## üìã –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç

1. **–°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã:**
   ```python
   spreadsheet = sheets_service.spreadsheets().create(...)
   ```

2. **–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—É–±–ª–∏—á–Ω—ã—Ö –ø—Ä–∞–≤:**
   ```python
   permission = {
       'type': 'anyone',
       'role': 'writer'  # EDITOR –ø—Ä–∞–≤–∞!
   }
   drive_service.permissions().create(...)
   ```

3. **–ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã–º–∏:**
   ```python
   sheets_service.spreadsheets().values().update(...)
   ```

4. **–§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
   - –ó–∞–≥–æ–ª–æ–≤–æ–∫: –∂–∏—Ä–Ω—ã–π, 16px, —Ü–µ–Ω—Ç—Ä
   - –î–∞—Ç–∞: –∫—É—Ä—Å–∏–≤, —Ü–µ–Ω—Ç—Ä
   - –ê–≤—Ç–æ–ø–æ–¥–±–æ—Ä —à–∏—Ä–∏–Ω—ã –∫–æ–ª–æ–Ω–æ–∫

---

## üé® UI

**–ö–Ω–æ–ø–∫–∞:** –°–∏–Ω—è—è (bg-blue-600)  
**–ò–∫–æ–Ω–∫–∞:** –ì—Ä–∞—Ñ–∏–∫ (bars chart)  
**–î–µ–π—Å—Ç–≤–∏–µ:** –û—Ç–∫—Ä—ã–≤–∞–µ—Ç —Ç–∞–±–ª–∏—Ü—É –≤ –Ω–æ–≤–æ–π –≤–∫–ª–∞–¥–∫–µ  
**–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ:** "Google Sheets —Å–æ–∑–¥–∞–Ω! –û—Ç–∫—Ä—ã–≤–∞—é –≤ –Ω–æ–≤–æ–π –≤–∫–ª–∞–¥–∫–µ..."

---

## üêõ Troubleshooting

### –û—à–∏–±–∫–∞: "GOOGLE_CREDENTIALS_JSON –Ω–µ –Ω–∞–π–¥–µ–Ω"
- –ü—Ä–æ–≤–µ—Ä—å –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ Railway
- –£–±–µ–¥–∏—Å—å —á—Ç–æ JSON –≤–∞–ª–∏–¥–Ω—ã–π (–±–µ–∑ –ø–µ—Ä–µ–Ω–æ—Å–æ–≤ —Å—Ç—Ä–æ–∫ –≤ –∫–ª—é—á–∞—Ö)

### –û—à–∏–±–∫–∞: "–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–∞–≤"
- –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ Service Account –∏–º–µ–µ—Ç –ø—Ä–∞–≤–∞ –Ω–∞ —Å–æ–∑–¥–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ –≤ Google Drive
- –£–±–µ–¥–∏—Å—å —á—Ç–æ –≤–∫–ª—é—á–µ–Ω—ã APIs: Google Sheets API, Google Drive API

### –¢–∞–±–ª–∏—Ü–∞ —Å–æ–∑–¥–∞–Ω–∞, –Ω–æ –Ω–µ—Ç –ø—Ä–∞–≤ –Ω–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ `role: 'writer'` –≤ –∫–æ–¥–µ (–Ω–µ 'reader')
- –ü—Ä–æ–≤–µ—Ä—å –ª–æ–≥–∏ Railway: –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å "–£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –ø—É–±–ª–∏—á–Ω—ã–µ –ø—Ä–∞–≤–∞ –Ω–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ"

---

## üì¶ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É—Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è –ø—Ä–∏ –¥–µ–ø–ª–æ–µ:
- `google-auth==2.23.4`
- `google-auth-oauthlib==1.1.0`
- `google-api-python-client==2.108.0`

---

## üöÄ –ì–æ—Ç–æ–≤–æ!

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ GOOGLE_CREDENTIALS_JSON –≤ Railway - –≤—Å—ë –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏!


