<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ü–∞—Ä—Å–µ—Ä –∫–æ–º–º–µ—Ä—á–µ—Å–∫–∏—Ö –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π - –†–µ–∑—É–ª—å—Ç–∞—Ç—ã</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            text-align: center;
        }
        
        .header h1 {
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 2.5em;
        }
        
        .header p {
            color: #7f8c8d;
            font-size: 1.1em;
        }
        
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
        }
        
        .stat-number {
            font-size: 2.5em;
            font-weight: bold;
            color: #3498db;
            margin-bottom: 10px;
        }
        
        .stat-label {
            color: #7f8c8d;
            font-size: 1.1em;
        }
        
        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 25px;
        }
        
        .product-card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }
        
        .product-card:hover {
            transform: translateY(-5px);
        }
        
        .product-name {
            font-size: 1.4em;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 15px;
        }
        
        .product-info {
            margin-bottom: 20px;
        }
        
        .info-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            padding: 5px 0;
        }
        
        .info-label {
            color: #7f8c8d;
            font-weight: 500;
        }
        
        .info-value {
            color: #2c3e50;
            font-weight: 600;
        }
        
        .images-section {
            margin-top: 20px;
        }
        
        .images-title {
            font-size: 1.1em;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
        }
        
        .images-title::before {
            content: "üì∑";
            margin-right: 8px;
        }
        
        .images-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
            gap: 10px;
        }
        
        .image-item {
            position: relative;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }
        
        .image-item:hover {
            transform: scale(1.05);
        }
        
        .image-item img {
            width: 100%;
            height: 80px;
            object-fit: cover;
            border-radius: 8px;
        }
        
        .image-position {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(0,0,0,0.7);
            color: white;
            text-align: center;
            padding: 2px 4px;
            font-size: 0.8em;
        }
        
        .offers-section {
            margin-top: 20px;
        }
        
        .offers-title {
            font-size: 1.1em;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
        }
        
        .offers-title::before {
            content: "üí∞";
            margin-right: 8px;
        }
        
        .offer-item {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 12px;
            margin-bottom: 8px;
            border-left: 4px solid #3498db;
        }
        
        .offer-quantity {
            font-weight: bold;
            color: #2c3e50;
        }
        
        .offer-prices {
            display: flex;
            gap: 15px;
            margin-top: 5px;
        }
        
        .price {
            color: #27ae60;
            font-weight: 600;
        }
        
        .route {
            color: #8e44ad;
            font-weight: 500;
            font-size: 0.9em;
        }
        
        .no-data {
            text-align: center;
            color: #7f8c8d;
            font-style: italic;
            padding: 20px;
        }
        
        @media (max-width: 768px) {
            .container { padding: 10px; }
            .header h1 { font-size: 2em; }
            .products-grid { grid-template-columns: 1fr; }
            .stats { grid-template-columns: repeat(2, 1fr); }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üéØ –ü–∞—Ä—Å–µ—Ä –∫–æ–º–º–µ—Ä—á–µ—Å–∫–∏—Ö –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π</h1>
            <p>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–∞—Ä—Å–∏–Ω–≥–∞ Excel —Ñ–∞–π–ª–æ–≤ —Å –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π</p>
            
            <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è -->
            <div style="margin-top: 20px;">
                <a href="/" style="background: #3498db; color: white; padding: 10px 20px; border-radius: 5px; text-decoration: none; margin-right: 10px;">üè† –ì–ª–∞–≤–Ω–∞—è</a>
                <a href="/projects" style="background: #27ae60; color: white; padding: 10px 20px; border-radius: 5px; text-decoration: none; margin-right: 10px;">üìÅ –í—Å–µ –ø—Ä–æ–µ–∫—Ç—ã</a>
            </div>
        </div>
        
        <div class="stats">
            <div class="stat-card">
                <div class="stat-number">{{ stats.projects }}</div>
                <div class="stat-label">–í—Å–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–æ–≤</div>
            </div>
            <div class="stat-card">
                <div class="stat-number">{{ stats.completed_projects }}</div>
                <div class="stat-label">–û–±—Ä–∞–±–æ—Ç–∞–Ω–æ</div>
            </div>
            <div class="stat-card">
                <div class="stat-number">{{ stats.products }}</div>
                <div class="stat-label">–¢–æ–≤–∞—Ä–æ–≤</div>
            </div>
            <div class="stat-card">
                <div class="stat-number">{{ stats.offers }}</div>
                <div class="stat-label">–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π</div>
            </div>
            <div class="stat-card">
                <div class="stat-number">{{ stats.images }}</div>
                <div class="stat-label">–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π</div>
            </div>
        </div>
        
        <!-- –ü–æ—Å–ª–µ–¥–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç—ã -->
        {% if recent_projects %}
        <div style="background: rgba(255, 255, 255, 0.95); border-radius: 15px; padding: 25px; margin-bottom: 30px; box-shadow: 0 10px 30px rgba(0,0,0,0.1);">
            <h2 style="color: #2c3e50; margin-bottom: 20px;">üìã –ü–æ—Å–ª–µ–¥–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç—ã</h2>
            <div style="display: grid; gap: 15px;">
                {% for project in recent_projects %}
                <div style="background: #f8f9fa; border-radius: 10px; padding: 15px; border-left: 4px solid #3498db;">
                    <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 10px;">
                        <div>
                            <h3 style="color: #2c3e50; margin-bottom: 5px;">{{ project.project_name[:60] }}{% if project.project_name|length > 60 %}...{% endif %}</h3>
                            <p style="color: #7f8c8d; margin: 0;">üë§ {{ project.client_name }} | üåç {{ project.region }}</p>
                            <p style="color: #7f8c8d; margin: 5px 0 0 0; font-size: 0.9em;">üì¶ {{ project.total_products_found or 0 }} —Ç–æ–≤–∞—Ä–æ–≤ | üñºÔ∏è {{ project.total_images_found or 0 }} –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π</p>
                        </div>
                        <div style="display: flex; gap: 10px; align-items: center;">
                            {% if project.google_sheets_url %}
                            <a href="{{ project.google_sheets_url }}" target="_blank" 
                               style="background: #4CAF50; color: white; padding: 8px 15px; border-radius: 5px; text-decoration: none; font-size: 0.9em;">
                                üìä Google Sheets
                            </a>
                            {% endif %}
                            <a href="/project/{{ project.id }}" 
                               style="background: #3498db; color: white; padding: 8px 15px; border-radius: 5px; text-decoration: none; font-size: 0.9em;">
                                üëÅÔ∏è –ü–æ–¥—Ä–æ–±–Ω–µ–µ
                            </a>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
        {% endif %}
        
        {% if products %}
        <div class="products-grid">
            {% for product in products %}
            <div class="product-card">
                <div class="product-name">{{ product.name }}</div>
                
                <div class="product-info">
                    <div class="info-row">
                        <span class="info-label">–¢–∞–±–ª–∏—Ü–∞:</span>
                        <span class="info-value">{{ product.table_id }}</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">–°—Ç—Ä–æ–∫–∞:</span>
                        <span class="info-value">{{ product.row_number }}</span>
                    </div>
                    {% if product.description %}
                    <div class="info-row">
                        <span class="info-label">–û–ø–∏—Å–∞–Ω–∏–µ:</span>
                        <span class="info-value">{{ product.description[:50] }}{% if product.description|length > 50 %}...{% endif %}</span>
                    </div>
                    {% endif %}
                    {% if product.custom_field %}
                    <div class="info-row">
                        <span class="info-label">–ö–∞—Å—Ç–æ–º:</span>
                        <span class="info-value">{{ product.custom_field }}</span>
                    </div>
                    {% endif %}
                </div>
                
                {% if product.images %}
                <div class="images-section">
                    <div class="images-title">–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è ({{ product.images|length }})</div>
                    <div class="images-grid">
                        {% for image in product.images %}
                        <div class="image-item">
                            <img src="/images/{{ image.image_filename }}" alt="–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ {{ image.cell_position }}" onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODAiIGhlaWdodD0iODAiIHZpZXdCb3g9IjAgMCA4MCA4MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjgwIiBoZWlnaHQ9IjgwIiBmaWxsPSIjRjNGNEY2Ii8+CjxwYXRoIGQ9Ik0yNSAzMEw0MCA0NUw1NSAzMEw2MCA1MEgyMEwyNSAzMFoiIGZpbGw9IiNEMUQ1REIiLz4KPGNpcmNsZSBjeD0iMzAiIGN5PSIzNSIgcj0iNSIgZmlsbD0iI0QxRDVEQiIvPgo8L3N2Zz4K'">
                            <div class="image-position">{{ image.cell_position }}</div>
                        </div>
                        {% endfor %}
                    </div>
                </div>
                {% endif %}
                
                {% if product.price_offers %}
                <div class="offers-section">
                    <div class="offers-title">–¶–µ–Ω–æ–≤—ã–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è ({{ product.price_offers|length }})</div>
                    {% for offer in product.price_offers %}
                    <div class="offer-item">
                        <div class="offer-quantity">{{ offer.quantity }} —à—Ç.</div>
                        <div class="offer-prices">
                            {% if offer.price_usd %}<span class="price">${{ "%.2f"|format(offer.price_usd) }}</span>{% endif %}
                            {% if offer.price_rub %}<span class="price">{{ "%.0f"|format(offer.price_rub) }} ‚ÇΩ</span>{% endif %}
                        </div>
                        {% if offer.route %}<div class="route">{{ offer.route }}</div>{% endif %}
                        {% if offer.delivery_time_days %}<div style="color: #7f8c8d; font-size: 0.9em;">–°—Ä–æ–∫: {{ offer.delivery_time_days }} –¥–Ω.</div>{% endif %}
                    </div>
                    {% endfor %}
                </div>
                {% endif %}
            </div>
            {% endfor %}
        </div>
        {% else %}
        <div class="no-data">
            <h3>–¢–æ–≤–∞—Ä—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</h3>
            <p>–ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø–∞—Ä—Å–µ—Ä –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ñ–∞–π–ª–æ–≤</p>
        </div>
        {% endif %}
    </div>
</body>
</html>



