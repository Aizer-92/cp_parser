# üìã –ü–†–ê–í–ò–õ–ê –ü–ê–†–°–ò–ù–ì–ê –ö–û–ú–ú–ï–†–ß–ï–°–ö–ò–• –ü–†–ï–î–õ–û–ñ–ï–ù–ò–ô

## üéØ –°–¢–†–£–ö–¢–£–†–ê EXCEL –§–ê–ô–õ–û–í

### –ë–∞–∑–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–±–ª–∏—Ü—ã:

```
| A      | B           | C                | D         | E      | F        | G         | H       | I        | J         | K       |
|--------|-------------|------------------|-----------|--------|----------|-----------|---------|----------|-----------|---------|
| [–§–æ—Ç–æ] | –ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ| –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏   | –ö–∞—Å—Ç–æ–º    | –¢–∏—Ä–∞–∂  | USD –ñ–î   | RUB –ñ–î    | –°—Ä–æ–∫ –ñ–î | USD –ê–í–ò–ê | RUB –ê–í–ò–ê  | –°—Ä–æ–∫    |
| [IMG]  | –¢–æ–≤–∞—Ä 1     | –û–ø–∏—Å–∞–Ω–∏–µ...      | –î–∏–∑–∞–π–Ω... | 1000   | 5.50     | 500       | 60      | 6.00     | 550       | 30      |
|        |             |                  |           | 3000   | 5.00     | 450       | 60      | 5.50     | 500       | 30      |
| [IMG]  | –¢–æ–≤–∞—Ä 2     | –î—Ä—É–≥–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ  | ...       | 500    | 10.00    | 900       | 55      | 11.00    | 1000      | 25      |
```

---

## üîß –ü–†–ê–í–ò–õ–ê –ü–ê–†–°–ò–ù–ì–ê

### 1. **–ù–∞—á–∞–ª–æ –¥–∞–Ω–Ω—ã—Ö**
- –î–∞–Ω–Ω—ã–µ –Ω–∞—á–∏–Ω–∞—é—Ç—Å—è —Å **—Å—Ç—Ä–æ–∫–∏ 5** (–ø—Ä–æ–ø—É—Å–∫–∞–µ–º –∑–∞–≥–æ–ª–æ–≤–∫–∏)
- –ü–∞—Ä—Å–∏–Ω–≥ –¥–æ —Å—Ç—Ä–æ–∫–∏ **500** –º–∞–∫—Å–∏–º—É–º

### 2. **–ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —Ç–æ–≤–∞—Ä–∞**
- **–°—Ç–æ–ª–±–µ—Ü B (2)** = –ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞
- –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ –Ω–∞–∑–≤–∞–Ω–∏—è: **3 —Å–∏–º–≤–æ–ª–∞**
- –ü—Ä–æ–ø—É—Å–∫–∞–µ–º —Å—Ç—Ä–æ–∫–∏ —Å –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏: `—Ñ–æ—Ç–æ`, `–Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ`, `–Ω–∞–∑–≤–∞–Ω–∏–µ`, `—Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏`, `—Ç–∏—Ä–∞–∂`, `—Ü–µ–Ω–∞`

### 3. **–ú–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã (–ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û!)**
- –û–¥–∏–Ω —Ç–æ–≤–∞—Ä –º–æ–∂–µ—Ç –∑–∞–Ω–∏–º–∞—Ç—å **–Ω–µ—Å–∫–æ–ª—å–∫–æ —Å—Ç—Ä–æ–∫** —Å —Ä–∞–∑–Ω—ã–º–∏ —Ç–∏—Ä–∞–∂–∞–º–∏
- **–ê–ª–≥–æ—Ä–∏—Ç–º:**
  1. –ß–∏—Ç–∞–µ–º –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ –∏–∑ —Å—Ç–æ–ª–±—Ü–∞ B
  2. –ü–∞—Ä—Å–∏–º –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –∏–∑ —Ç–µ–∫—É—â–µ–π —Å—Ç—Ä–æ–∫–∏
  3. **–ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–ª–µ–¥—É—é—â–∏–µ —Å—Ç—Ä–æ–∫–∏:**
     - –ï—Å–ª–∏ –Ω–∞–∑–≤–∞–Ω–∏–µ –ü–£–°–¢–û–ï, –Ω–æ –µ—Å—Ç—å —Ç–∏—Ä–∞–∂ (—Å—Ç–æ–ª–±–µ—Ü E) ‚Üí —ç—Ç–æ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –¢–û–ì–û –ñ–ï —Ç–æ–≤–∞—Ä–∞
     - –î–æ–±–∞–≤–ª—è–µ–º –≤—Å–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –∫ –æ–¥–Ω–æ–º—É —Ç–æ–≤–∞—Ä—É
  4. –ü—Ä–µ–∫—Ä–∞—â–∞–µ–º, –∫–æ–≥–¥–∞ –≤—Å—Ç—Ä–µ—á–∞–µ–º –Ω–æ–≤–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∏–ª–∏ –ø—É—Å—Ç—É—é —Å—Ç—Ä–æ–∫—É –±–µ–∑ —Ç–∏—Ä–∞–∂–∞

**–ü—Ä–∏–º–µ—Ä:**
```
| B           | E      | F        | ... |
|-------------|--------|----------|-----|
| –ö—Ä—É–∂–∫–∞      | 1000   | 5.50     | ... | ‚Üê –¢–æ–≤–∞—Ä 1, –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ 1
|             | 3000   | 5.00     | ... | ‚Üê –¢–æ–≤–∞—Ä 1, –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ 2 (–Ω–∞–∑–≤–∞–Ω–∏–µ –ø—É—Å—Ç–æ–µ!)
|             | 5000   | 4.80     | ... | ‚Üê –¢–æ–≤–∞—Ä 1, –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ 3 (–Ω–∞–∑–≤–∞–Ω–∏–µ –ø—É—Å—Ç–æ–µ!)
| –ë–ª–æ–∫–Ω–æ—Ç     | 500    | 2.00     | ... | ‚Üê –¢–æ–≤–∞—Ä 2, –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ 1
```

### 4. **–ü–æ–ª—è —Ç–æ–≤–∞—Ä–∞**

| –ü–æ–ª–µ          | –°—Ç–æ–ª–±–µ—Ü | –¢–∏–ø    | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ | –û–±—Ä–∞–±–æ—Ç–∫–∞                     |
|---------------|---------|--------|--------------|-------------------------------|
| name          | B (2)   | String | ‚úÖ           | `str(value).strip()`          |
| description   | C (3)   | String | ‚ùå           | `str(value)` –µ—Å–ª–∏ –µ—Å—Ç—å        |
| custom_field  | D (4)   | String | ‚ùå           | `str(value)` –µ—Å–ª–∏ –µ—Å—Ç—å        |

### 5. **–¶–µ–Ω–æ–≤—ã–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è (Price Offers)**

#### üì¶ **–ú–∞—Ä—à—Ä—É—Ç –ñ–î (–ñ–µ–ª–µ–∑–Ω–∞—è –¥–æ—Ä–æ–≥–∞)**
| –ü–æ–ª–µ                | –°—Ç–æ–ª–±–µ—Ü | –¢–∏–ø   | –û–±—Ä–∞–±–æ—Ç–∫–∞                                  |
|---------------------|---------|-------|-------------------------------------------|
| quantity            | E (5)   | Int   | –ï—Å–ª–∏ –µ—Å—Ç—å `-` ‚Üí –±–µ—Ä–µ–º –ø–µ—Ä–≤–æ–µ —á–∏—Å–ª–æ        |
| price_usd           | F (6)   | Float | `replace(',', '.')`                       |
| price_rub           | G (7)   | Float | `replace(',', '.').replace(' ', '')`      |
| delivery_time_days  | H (8)   | Int   | –ò–∑–≤–ª–µ–∫–∞–µ–º —Ü–∏—Ñ—Ä—ã                           |
| route               | -       | String| **"–ñ–î"**                                  |

#### ‚úàÔ∏è **–ú–∞—Ä—à—Ä—É—Ç –ê–í–ò–ê**
| –ü–æ–ª–µ                | –°—Ç–æ–ª–±–µ—Ü | –¢–∏–ø   | –û–±—Ä–∞–±–æ—Ç–∫–∞                                  |
|---------------------|---------|-------|-------------------------------------------|
| quantity            | E (5)   | Int   | **–¢–û–¢ –ñ–ï** —Ç–∏—Ä–∞–∂, —á—Ç–æ –∏ –¥–ª—è –ñ–î           |
| price_usd           | I (9)   | Float | `replace(',', '.')`                       |
| price_rub           | J (10)  | Float | `replace(',', '.').replace(' ', '')`      |
| delivery_time_days  | K (11)  | Int   | –ò–∑–≤–ª–µ–∫–∞–µ–º —Ü–∏—Ñ—Ä—ã                           |
| route               | -       | String| **"–ê–í–ò–ê"**                                |

#### ‚ö†Ô∏è **–í–ê–ñ–ù–û:**
- –ï—Å–ª–∏ –≤ —Å—Ç—Ä–æ–∫–µ –µ—Å—Ç—å —Ç–∏—Ä–∞–∂ (E) ‚Üí —Å–æ–∑–¥–∞–µ–º **–î–í–ê** –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è: –ñ–î + –ê–í–ò–ê (–µ—Å–ª–∏ —Ü–µ–Ω—ã –µ—Å—Ç—å)
- –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ —Å–æ–∑–¥–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –µ—Å—Ç—å `price_usd` –ò–õ–ò `price_rub`
- –ï—Å–ª–∏ –Ω–µ—Ç —Ü–µ–Ω –ñ–î/–ê–í–ò–ê ‚Üí –ø—Ä–æ–ø—É—Å–∫–∞–µ–º —ç—Ç–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ

### 6. **–û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–∏—Ä–∞–∂–∞ (Quantity)**

**–í–∞—Ä–∏–∞–Ω—Ç—ã —Ñ–æ—Ä–º–∞—Ç–∞:**
- `1000` ‚Üí `1000`
- `300-500` ‚Üí `300` (–±–µ—Ä–µ–º –ø–µ—Ä–≤–æ–µ —á–∏—Å–ª–æ)
- `5 000` ‚Üí `5000` (—É–±–∏—Ä–∞–µ–º –ø—Ä–æ–±–µ–ª—ã)
- `10000—à—Ç` ‚Üí `10000` (–∏–∑–≤–ª–µ–∫–∞–µ–º —Ç–æ–ª—å–∫–æ —Ü–∏—Ñ—Ä—ã)

**–ö–æ–¥:**
```python
qty_str = str(cell_value).strip()
if '-' in qty_str:
    qty_str = qty_str.split('-')[0].strip()
qty = int(''.join(filter(str.isdigit, qty_str)))
```

### 7. **–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (Product Images)**

#### üì∑ **–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∏–∑ Excel**
- –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ö—Ä–∞–Ω—è—Ç—Å—è –∫–∞–∫ **blob –¥–∞–Ω–Ω—ã–µ** –≤–Ω—É—Ç—Ä–∏ `.xlsx` —Ñ–∞–π–ª–æ–≤
- –ò—Å–ø–æ–ª—å–∑—É–µ–º `openpyxl` —Å `data_only=False` –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è
- –î–æ—Å—Ç—É–ø —á–µ—Ä–µ–∑ `worksheet._images`

#### üìÅ **–§–æ—Ä–º–∞—Ç –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞:**
```
{table_id}_{cell_position}_{hash}.png
```

**–ü—Ä–∏–º–µ—Ä:**
```
11Zs0Urnzve7URBBwgWsonjjgOWc414YP_Onkxo0AMRo_N7_474edece.png
```

–ì–¥–µ:
- `11Zs0Urnzve7URBBwgWsonjjgOWc414YP_Onkxo0AMRo` = Google Sheets Table ID
- `N7` = –ü–æ–∑–∏—Ü–∏—è —è—á–µ–π–∫–∏ (—Å—Ç–æ–ª–±–µ—Ü N, —Å—Ç—Ä–æ–∫–∞ 7)
- `474edece` = MD5 hash –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (–ø–µ—Ä–≤—ã–µ 8 —Å–∏–º–≤–æ–ª–æ–≤)

#### üîó **–ü—Ä–∏–≤—è–∑–∫–∞ –∫ —Ç–æ–≤–∞—Ä–∞–º:**
- –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø—Ä–∏–≤—è–∑—ã–≤–∞—é—Ç—Å—è –ø–æ **–¥–∏–∞–ø–∞–∑–æ–Ω—É —Å—Ç—Ä–æ–∫**: ¬±2 –æ—Ç —Å—Ç—Ä–æ–∫–∏ —Ç–æ–≤–∞—Ä–∞
- –ï—Å–ª–∏ —Ç–æ–≤–∞—Ä –≤ —Å—Ç—Ä–æ–∫–µ 10, –∏—â–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ —Å—Ç—Ä–æ–∫–∞—Ö 8-12
- **–ù–µ—Å–∫–æ–ª—å–∫–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π** –Ω–∞ —Ç–æ–≤–∞—Ä ‚Üí —Å–æ—Ö—Ä–∞–Ω—è–µ–º –≤—Å–µ

#### üíæ **–ü–æ–ª—è –≤ –ë–î:**
| –ü–æ–ª–µ          | –¢–∏–ø    | –û–ø–∏—Å–∞–Ω–∏–µ                              |
|---------------|--------|---------------------------------------|
| product_id    | Int    | FK –∫ —Ç–∞–±–ª–∏—Ü–µ `products`               |
| table_id      | String | ID Google Sheets —Ç–∞–±–ª–∏—Ü—ã              |
| image_filename| String | –ò–º—è —Ñ–∞–π–ª–∞ (—Å–º. —Ñ–æ—Ä–º–∞—Ç –≤—ã—à–µ)           |
| cell_position | String | –ü–æ–∑–∏—Ü–∏—è –≤ —Ç–∞–±–ª–∏—Ü–µ (A1, B5, N7...)     |
| row_number    | Int    | –ù–æ–º–µ—Ä —Å—Ç—Ä–æ–∫–∏                          |
| column_number | Int    | –ù–æ–º–µ—Ä —Å—Ç–æ–ª–±—Ü–∞                         |

---

## üìä –í–ê–õ–ò–î–ê–¶–ò–Ø –°–¢–†–£–ö–¢–£–†–´

### –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è:

1. ‚úÖ **–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ —Å—Ç–æ–ª–±—Ü—ã** (–¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏):
   - –§–æ—Ç–æ (A)
   - –ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ (B)
   - –¢–∏—Ä–∞–∂ (E)
   - –¶–µ–Ω—ã (F, G, I, J - —Ö–æ—Ç—è –±—ã –æ–¥–Ω–∞)
   - –°—Ä–æ–∫ –¥–æ—Å—Ç–∞–≤–∫–∏ (H, K)

2. ‚úÖ **–ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤:**
   - –ò—â–µ–º –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞: `—Ñ–æ—Ç–æ`, `–Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ`, `—Ç–∏—Ä–∞–∂`, `—Ü–µ–Ω–∞`, `–¥–æ—Å—Ç–∞–≤–∫–∞`
   - –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –º–∞—Ä—à—Ä—É—Ç–æ–≤: `–∂–¥`, `–∞–≤–∏–∞`, `–∂/–¥`, `–∞–≤—Ç–æ`

3. ‚úÖ **–í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö:**
   - `quantity > 0`
   - `price_usd > 0` –ò–õ–ò `price_rub > 0`
   - `delivery_time_days >= 0`

---

## üóÑÔ∏è –°–•–ï–ú–ê –ë–ê–ó–´ –î–ê–ù–ù–´–•

### **–¢–∞–±–ª–∏—Ü–∞: `projects`**
```sql
id                  SERIAL PRIMARY KEY
project_name        VARCHAR(500)
table_id            VARCHAR(200)  -- Google Sheets ID
google_sheets_url   TEXT
parsing_status      VARCHAR(50)   -- 'pending', 'completed', 'error'
parsing_errors      TEXT
parsed_at           TIMESTAMP
created_at          TIMESTAMP
updated_at          TIMESTAMP
```

### **–¢–∞–±–ª–∏—Ü–∞: `products`**
```sql
id                  SERIAL PRIMARY KEY
project_id          INTEGER FK ‚Üí projects.id
table_id            VARCHAR(200)
name                VARCHAR(500)  -- –°—Ç–æ–ª–±–µ—Ü B
description         TEXT          -- –°—Ç–æ–ª–±–µ—Ü C
custom_field        TEXT          -- –°—Ç–æ–ª–±–µ—Ü D (–¥–∏–∑–∞–π–Ω)
created_at          TIMESTAMP
updated_at          TIMESTAMP
```

### **–¢–∞–±–ª–∏—Ü–∞: `price_offers`**
```sql
id                  SERIAL PRIMARY KEY
product_id          INTEGER FK ‚Üí products.id
quantity            INTEGER       -- –°—Ç–æ–ª–±–µ—Ü E
price_usd           DECIMAL(10,2) -- –°—Ç–æ–ª–±—Ü—ã F/I
price_rub           DECIMAL(10,2) -- –°—Ç–æ–ª–±—Ü—ã G/J
route               VARCHAR(50)   -- "–ñ–î" –∏–ª–∏ "–ê–í–ò–ê"
delivery_time_days  INTEGER       -- –°—Ç–æ–ª–±—Ü—ã H/K
created_at          TIMESTAMP
updated_at          TIMESTAMP
```

### **–¢–∞–±–ª–∏—Ü–∞: `product_images`**
```sql
id                  SERIAL PRIMARY KEY
product_id          INTEGER FK ‚Üí products.id
table_id            VARCHAR(200)
image_filename      VARCHAR(500)
cell_position       VARCHAR(10)   -- "A1", "N7"
row_number          INTEGER
column_number       INTEGER
created_at          TIMESTAMP
updated_at          TIMESTAMP
```

---

## üöÄ –ü–†–û–¶–ï–°–° –ü–ê–†–°–ò–ù–ì–ê

### –®–∞–≥ 1: –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞
```python
# –î–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (–ë–ï–ó data_only)
workbook_images = load_workbook(file_path, data_only=False)

# –î–ª—è –¥–∞–Ω–Ω—ã—Ö (–° data_only –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π)
workbook_data = load_workbook(file_path, data_only=True)
```

### –®–∞–≥ 2: –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
```python
images_by_row = {}  # {row_idx: [{'filename': ..., 'cell_position': ..., ...}]}

if hasattr(worksheet_images, '_images'):
    for img in worksheet_images._images:
        row = img.anchor._from.row + 1
        col = img.anchor._from.col + 1
        img_data = save_image_from_excel(img, table_id, row, col)
        images_by_row[row].append(img_data)
```

### –®–∞–≥ 3: –ü–∞—Ä—Å–∏–Ω–≥ —Ç–æ–≤–∞—Ä–æ–≤
```python
skip_rows = set()  # –£–∂–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏

for row_idx in range(5, 500):
    if row_idx in skip_rows:
        continue
    
    name = worksheet_data.cell(row_idx, 2).value  # –°—Ç–æ–ª–±–µ—Ü B
    
    if not name or len(name) < 3:
        continue
    
    # –ü–∞—Ä—Å–∏–º –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –∏–∑ —Ç–µ–∫—É—â–µ–π —Å—Ç—Ä–æ–∫–∏
    offers = parse_offers_from_row(row_idx)
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–ª–µ–¥—É—é—â–∏–µ —Å—Ç—Ä–æ–∫–∏ –Ω–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è
    check_row = row_idx + 1
    while check_row < 500:
        next_name = worksheet_data.cell(check_row, 2).value
        next_qty = worksheet_data.cell(check_row, 5).value
        
        if next_name and len(str(next_name)) >= 3:
            break  # –ù–æ–≤—ã–π —Ç–æ–≤–∞—Ä
        
        if next_qty:
            # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –¢–û–ì–û –ñ–ï —Ç–æ–≤–∞—Ä–∞
            additional_offers = parse_offers_from_row(check_row)
            offers.extend(additional_offers)
            skip_rows.add(check_row)
            check_row += 1
        else:
            break
    
    # –ò—â–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (¬±2 —Å—Ç—Ä–æ–∫–∏)
    product_images = []
    for check_row in range(max(1, row_idx - 2), row_idx + 3):
        if check_row in images_by_row:
            product_images.extend(images_by_row[check_row])
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–æ–≤–∞—Ä
    save_product(name, description, custom_field, offers, product_images)
```

### –®–∞–≥ 4: –ü–∞—Ä—Å–∏–Ω–≥ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π
```python
def parse_offers_from_row(row_idx):
    offers = []
    
    # –¢–∏—Ä–∞–∂
    qty_cell = worksheet_data.cell(row_idx, 5)
    if not qty_cell.value:
        return offers
    
    qty_str = str(qty_cell.value).strip()
    if '-' in qty_str:
        qty_str = qty_str.split('-')[0].strip()
    qty = int(''.join(filter(str.isdigit, qty_str)))
    
    # –ñ–î –º–∞—Ä—à—Ä—É—Ç
    price_usd_jd = parse_float(worksheet_data.cell(row_idx, 6).value)
    price_rub_jd = parse_float(worksheet_data.cell(row_idx, 7).value)
    delivery_jd = parse_int(worksheet_data.cell(row_idx, 8).value)
    
    if price_usd_jd or price_rub_jd:
        offers.append({
            'quantity': qty,
            'price_usd': price_usd_jd,
            'price_rub': price_rub_jd,
            'route': '–ñ–î',
            'delivery_time_days': delivery_jd or 60
        })
    
    # –ê–í–ò–ê –º–∞—Ä—à—Ä—É—Ç
    price_usd_avia = parse_float(worksheet_data.cell(row_idx, 9).value)
    price_rub_avia = parse_float(worksheet_data.cell(row_idx, 10).value)
    delivery_avia = parse_int(worksheet_data.cell(row_idx, 11).value)
    
    if price_usd_avia or price_rub_avia:
        offers.append({
            'quantity': qty,
            'price_usd': price_usd_avia,
            'price_rub': price_rub_avia,
            'route': '–ê–í–ò–ê',
            'delivery_time_days': delivery_avia or 30
        })
    
    return offers
```

---

## ‚úÖ –ö–û–ù–¢–†–û–õ–¨ –ö–ê–ß–ï–°–¢–í–ê

### –ú–µ—Ç—Ä–∏–∫–∏ –ø–æ—Å–ª–µ –ø–∞—Ä—Å–∏–Ω–≥–∞:

1. **–£—Å–ø–µ—à–Ω–æ—Å—Ç—å:** ‚â• 70%
2. **–¢–æ–≤–∞—Ä—ã —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏:** ‚â• 85%
3. **–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π –Ω–∞ —Ç–æ–≤–∞—Ä:** ‚â• 2.0 (—É—á–∏—Ç—ã–≤–∞—è –º–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω–æ—Å—Ç—å –∏ –º–∞—Ä—à—Ä—É—Ç—ã)
4. **–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –Ω–∞ —Ç–æ–≤–∞—Ä:** ‚â• 3.0

### –¢–µ–∫—É—â–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã (8,573 —Ç–æ–≤–∞—Ä–∞):
- ‚úÖ –¢–æ–≤–∞—Ä—ã —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏: **93.0%**
- ‚úÖ –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π –Ω–∞ —Ç–æ–≤–∞—Ä: **2.80**
- ‚úÖ –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –Ω–∞ —Ç–æ–≤–∞—Ä: **3.40**

---

## üêõ –û–°–û–ë–´–ï –°–õ–£–ß–ê–ò

### 1. **–°—Ç–æ–ª–±–µ—Ü "–ò—Ç–æ–≥–æ, —Ä—É–±"**
- –ï—Å–ª–∏ –≤ —Ç–∞–±–ª–∏—Ü–µ –µ—Å—Ç—å —Å—Ç–æ–ª–±–µ—Ü "–ò—Ç–æ–≥–æ" ‚Üí **–ø—Ä–æ–ø—É—Å–∫–∞–µ–º –µ–≥–æ**
- –ù–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞, –Ω–æ —É—á–∏—Ç—ã–≤–∞–µ–º –ø—Ä–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã

### 2. **–û–±—Ä–∞–∑—Ü—ã**
- –ò–Ω–æ–≥–¥–∞ —Ç–∏—Ä–∞–∂ = "–û–±—Ä–∞–∑–µ—Ü" (–≤–º–µ—Å—Ç–æ —á–∏—Å–ª–∞)
- –ü–∞—Ä—Å–∏–º –∫–∞–∫ `quantity = 1` —Å route = "–û–±—Ä–∞–∑–µ—Ü"

### 3. **–ü—É—Å—Ç—ã–µ —Ü–µ–Ω—ã**
- –ï—Å–ª–∏ `price_usd = 0` –∏ `price_rub = 0` ‚Üí **–Ω–µ —Å–æ–∑–¥–∞–µ–º –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ**
- –õ–æ–≥–∏—Ä—É–µ–º –¥–ª—è –æ—Ç—á–µ—Ç–∞

### 4. **–î—É–±–ª–∏–∫–∞—Ç—ã**
- –ü–µ—Ä–µ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –ø—Ä–æ–≤–µ—Ä—è–µ–º: —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ —Ç–æ–≤–∞—Ä —Å —Ç–∞–∫–∏–º –∏–º–µ–Ω–µ–º –¥–ª—è —ç—Ç–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞
- –ï—Å–ª–∏ –¥–∞ ‚Üí **–ø—Ä–æ–ø—É—Å–∫–∞–µ–º** (–Ω–µ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ–º)

---

## üìù –õ–û–ì–ò–†–û–í–ê–ù–ò–ï

### –£—Ä–æ–≤–Ω–∏ –ª–æ–≥–æ–≤:

```python
logger.info(f"üìã {i}/{total}: –ü–∞—Ä—Å–∏–Ω–≥ {filename}")
logger.info(f"   ‚úÖ –¢–æ–≤–∞—Ä—ã: {products} | –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è: {offers} | –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è: {images}")
logger.warning(f"   ‚ö†Ô∏è  No products found")
logger.error(f"   ‚ùå –û—à–∏–±–∫–∞: {error_message}")
```

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤ –∫–æ–Ω—Ü–µ:
```
‚úÖ –£—Å–ø–µ—à–Ω–æ: 198/272 (72.8%)
‚ùå –û—à–∏–±–∫–∏: 74
üì¶ –¢–æ–≤–∞—Ä—ã: 759
üí∞ –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è: 2,466
üñºÔ∏è  –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è: 5,868
```

---

## üîÑ –û–ë–ù–û–í–õ–ï–ù–ò–ï –î–ê–ù–ù–´–•

### –ü—Ä–∞–≤–∏–ª–∞:
1. **–ù–ï –ü–ï–†–ï–ó–ê–ü–ò–°–´–í–ê–ï–ú** —É–∂–µ —Å–ø–∞—Ä—Å–µ–Ω–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç—ã (–ø—Ä–æ–≤–µ—Ä—è–µ–º `parsing_status = 'completed'`)
2. **–ù–ï –î–£–ë–õ–ò–†–£–ï–ú** —Ç–æ–≤–∞—Ä—ã (–ø—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ `project_id` + `name`)
3. **–õ–û–ì–ò–†–£–ï–ú** –≤—Å–µ –ø—Ä–æ–ø—É—Å–∫–∏ –∏ –æ—à–∏–±–∫–∏

---

## üì¶ –§–ê–ô–õ–´ –ü–†–û–ï–ö–¢–ê

```
cp_parser/
‚îú‚îÄ‚îÄ parse_validated_272_files.py       # –û—Å–Ω–æ–≤–Ω–æ–π –ø–∞—Ä—Å–µ—Ä
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îî‚îÄ‚îÄ structure_parser.py            # –í–∞–ª–∏–¥–∞—Ü–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
‚îú‚îÄ‚îÄ database/
‚îÇ   ‚îú‚îÄ‚îÄ models.py                      # SQLAlchemy –º–æ–¥–µ–ª–∏
‚îÇ   ‚îî‚îÄ‚îÄ postgresql_manager.py          # –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ PostgreSQL
‚îú‚îÄ‚îÄ storage/
‚îÇ   ‚îú‚îÄ‚îÄ excel_files/                   # –ò—Å—Ö–æ–¥–Ω—ã–µ .xlsx —Ñ–∞–π–ª—ã
‚îÇ   ‚îî‚îÄ‚îÄ images/                        # –ò–∑–≤–ª–µ—á–µ–Ω–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
‚îî‚îÄ‚îÄ PARSING_RULES.md                   # –≠–¢–û –§–ê–ô–õ
```

---

## üéØ –ò–¢–û–ì

**–ì–ª–∞–≤–Ω–æ–µ –ø—Ä–∞–≤–∏–ª–æ:**
> –û–¥–∏–Ω —Ç–æ–≤–∞—Ä = –æ–¥–Ω–∞ –∑–∞–ø–∏—Å—å –≤ `products`, –Ω–æ –º–æ–∂–µ—Ç –∏–º–µ—Ç—å **–ù–ï–°–ö–û–õ–¨–ö–û** —Å—Ç—Ä–æ–∫ –≤ –∏—Å—Ö–æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ (–º–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω–æ—Å—Ç—å), **–ù–ï–°–ö–û–õ–¨–ö–û** price_offers (–ñ–î/–ê–í–ò–ê + —Ä–∞–∑–Ω—ã–µ —Ç–∏—Ä–∞–∂–∏) –∏ **–ù–ï–°–ö–û–õ–¨–ö–û** –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π.

**–ü–∞—Ä—Å–∏–º:**
- ‚úÖ –ú–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã (–ø—É—Å—Ç–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ, –Ω–æ –µ—Å—Ç—å —Ç–∏—Ä–∞–∂)
- ‚úÖ –ù–µ—Å–∫–æ–ª—å–∫–æ –º–∞—Ä—à—Ä—É—Ç–æ–≤ (–ñ–î –∏ –ê–í–ò–ê) –∏–∑ –æ–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏
- ‚úÖ –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–∑ blob –¥–∞–Ω–Ω—ã—Ö Excel
- ‚úÖ –í—Å–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã —Ç–∏—Ä–∞–∂–µ–π (`1000`, `300-500`, `5 000 —à—Ç`)

---

*–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ: 08.10.2025*








## üéØ –°–¢–†–£–ö–¢–£–†–ê EXCEL –§–ê–ô–õ–û–í

### –ë–∞–∑–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–±–ª–∏—Ü—ã:

```
| A      | B           | C                | D         | E      | F        | G         | H       | I        | J         | K       |
|--------|-------------|------------------|-----------|--------|----------|-----------|---------|----------|-----------|---------|
| [–§–æ—Ç–æ] | –ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ| –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏   | –ö–∞—Å—Ç–æ–º    | –¢–∏—Ä–∞–∂  | USD –ñ–î   | RUB –ñ–î    | –°—Ä–æ–∫ –ñ–î | USD –ê–í–ò–ê | RUB –ê–í–ò–ê  | –°—Ä–æ–∫    |
| [IMG]  | –¢–æ–≤–∞—Ä 1     | –û–ø–∏—Å–∞–Ω–∏–µ...      | –î–∏–∑–∞–π–Ω... | 1000   | 5.50     | 500       | 60      | 6.00     | 550       | 30      |
|        |             |                  |           | 3000   | 5.00     | 450       | 60      | 5.50     | 500       | 30      |
| [IMG]  | –¢–æ–≤–∞—Ä 2     | –î—Ä—É–≥–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ  | ...       | 500    | 10.00    | 900       | 55      | 11.00    | 1000      | 25      |
```

---

## üîß –ü–†–ê–í–ò–õ–ê –ü–ê–†–°–ò–ù–ì–ê

### 1. **–ù–∞—á–∞–ª–æ –¥–∞–Ω–Ω—ã—Ö**
- –î–∞–Ω–Ω—ã–µ –Ω–∞—á–∏–Ω–∞—é—Ç—Å—è —Å **—Å—Ç—Ä–æ–∫–∏ 5** (–ø—Ä–æ–ø—É—Å–∫–∞–µ–º –∑–∞–≥–æ–ª–æ–≤–∫–∏)
- –ü–∞—Ä—Å–∏–Ω–≥ –¥–æ —Å—Ç—Ä–æ–∫–∏ **500** –º–∞–∫—Å–∏–º—É–º

### 2. **–ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —Ç–æ–≤–∞—Ä–∞**
- **–°—Ç–æ–ª–±–µ—Ü B (2)** = –ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞
- –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ –Ω–∞–∑–≤–∞–Ω–∏—è: **3 —Å–∏–º–≤–æ–ª–∞**
- –ü—Ä–æ–ø—É—Å–∫–∞–µ–º —Å—Ç—Ä–æ–∫–∏ —Å –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏: `—Ñ–æ—Ç–æ`, `–Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ`, `–Ω–∞–∑–≤–∞–Ω–∏–µ`, `—Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏`, `—Ç–∏—Ä–∞–∂`, `—Ü–µ–Ω–∞`

### 3. **–ú–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã (–ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û!)**
- –û–¥–∏–Ω —Ç–æ–≤–∞—Ä –º–æ–∂–µ—Ç –∑–∞–Ω–∏–º–∞—Ç—å **–Ω–µ—Å–∫–æ–ª—å–∫–æ —Å—Ç—Ä–æ–∫** —Å —Ä–∞–∑–Ω—ã–º–∏ —Ç–∏—Ä–∞–∂–∞–º–∏
- **–ê–ª–≥–æ—Ä–∏—Ç–º:**
  1. –ß–∏—Ç–∞–µ–º –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ –∏–∑ —Å—Ç–æ–ª–±—Ü–∞ B
  2. –ü–∞—Ä—Å–∏–º –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –∏–∑ —Ç–µ–∫—É—â–µ–π —Å—Ç—Ä–æ–∫–∏
  3. **–ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–ª–µ–¥—É—é—â–∏–µ —Å—Ç—Ä–æ–∫–∏:**
     - –ï—Å–ª–∏ –Ω–∞–∑–≤–∞–Ω–∏–µ –ü–£–°–¢–û–ï, –Ω–æ –µ—Å—Ç—å —Ç–∏—Ä–∞–∂ (—Å—Ç–æ–ª–±–µ—Ü E) ‚Üí —ç—Ç–æ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –¢–û–ì–û –ñ–ï —Ç–æ–≤–∞—Ä–∞
     - –î–æ–±–∞–≤–ª—è–µ–º –≤—Å–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –∫ –æ–¥–Ω–æ–º—É —Ç–æ–≤–∞—Ä—É
  4. –ü—Ä–µ–∫—Ä–∞—â–∞–µ–º, –∫–æ–≥–¥–∞ –≤—Å—Ç—Ä–µ—á–∞–µ–º –Ω–æ–≤–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∏–ª–∏ –ø—É—Å—Ç—É—é —Å—Ç—Ä–æ–∫—É –±–µ–∑ —Ç–∏—Ä–∞–∂–∞

**–ü—Ä–∏–º–µ—Ä:**
```
| B           | E      | F        | ... |
|-------------|--------|----------|-----|
| –ö—Ä—É–∂–∫–∞      | 1000   | 5.50     | ... | ‚Üê –¢–æ–≤–∞—Ä 1, –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ 1
|             | 3000   | 5.00     | ... | ‚Üê –¢–æ–≤–∞—Ä 1, –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ 2 (–Ω–∞–∑–≤–∞–Ω–∏–µ –ø—É—Å—Ç–æ–µ!)
|             | 5000   | 4.80     | ... | ‚Üê –¢–æ–≤–∞—Ä 1, –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ 3 (–Ω–∞–∑–≤–∞–Ω–∏–µ –ø—É—Å—Ç–æ–µ!)
| –ë–ª–æ–∫–Ω–æ—Ç     | 500    | 2.00     | ... | ‚Üê –¢–æ–≤–∞—Ä 2, –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ 1
```

### 4. **–ü–æ–ª—è —Ç–æ–≤–∞—Ä–∞**

| –ü–æ–ª–µ          | –°—Ç–æ–ª–±–µ—Ü | –¢–∏–ø    | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ | –û–±—Ä–∞–±–æ—Ç–∫–∞                     |
|---------------|---------|--------|--------------|-------------------------------|
| name          | B (2)   | String | ‚úÖ           | `str(value).strip()`          |
| description   | C (3)   | String | ‚ùå           | `str(value)` –µ—Å–ª–∏ –µ—Å—Ç—å        |
| custom_field  | D (4)   | String | ‚ùå           | `str(value)` –µ—Å–ª–∏ –µ—Å—Ç—å        |

### 5. **–¶–µ–Ω–æ–≤—ã–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è (Price Offers)**

#### üì¶ **–ú–∞—Ä—à—Ä—É—Ç –ñ–î (–ñ–µ–ª–µ–∑–Ω–∞—è –¥–æ—Ä–æ–≥–∞)**
| –ü–æ–ª–µ                | –°—Ç–æ–ª–±–µ—Ü | –¢–∏–ø   | –û–±—Ä–∞–±–æ—Ç–∫–∞                                  |
|---------------------|---------|-------|-------------------------------------------|
| quantity            | E (5)   | Int   | –ï—Å–ª–∏ –µ—Å—Ç—å `-` ‚Üí –±–µ—Ä–µ–º –ø–µ—Ä–≤–æ–µ —á–∏—Å–ª–æ        |
| price_usd           | F (6)   | Float | `replace(',', '.')`                       |
| price_rub           | G (7)   | Float | `replace(',', '.').replace(' ', '')`      |
| delivery_time_days  | H (8)   | Int   | –ò–∑–≤–ª–µ–∫–∞–µ–º —Ü–∏—Ñ—Ä—ã                           |
| route               | -       | String| **"–ñ–î"**                                  |

#### ‚úàÔ∏è **–ú–∞—Ä—à—Ä—É—Ç –ê–í–ò–ê**
| –ü–æ–ª–µ                | –°—Ç–æ–ª–±–µ—Ü | –¢–∏–ø   | –û–±—Ä–∞–±–æ—Ç–∫–∞                                  |
|---------------------|---------|-------|-------------------------------------------|
| quantity            | E (5)   | Int   | **–¢–û–¢ –ñ–ï** —Ç–∏—Ä–∞–∂, —á—Ç–æ –∏ –¥–ª—è –ñ–î           |
| price_usd           | I (9)   | Float | `replace(',', '.')`                       |
| price_rub           | J (10)  | Float | `replace(',', '.').replace(' ', '')`      |
| delivery_time_days  | K (11)  | Int   | –ò–∑–≤–ª–µ–∫–∞–µ–º —Ü–∏—Ñ—Ä—ã                           |
| route               | -       | String| **"–ê–í–ò–ê"**                                |

#### ‚ö†Ô∏è **–í–ê–ñ–ù–û:**
- –ï—Å–ª–∏ –≤ —Å—Ç—Ä–æ–∫–µ –µ—Å—Ç—å —Ç–∏—Ä–∞–∂ (E) ‚Üí —Å–æ–∑–¥–∞–µ–º **–î–í–ê** –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è: –ñ–î + –ê–í–ò–ê (–µ—Å–ª–∏ —Ü–µ–Ω—ã –µ—Å—Ç—å)
- –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ —Å–æ–∑–¥–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –µ—Å—Ç—å `price_usd` –ò–õ–ò `price_rub`
- –ï—Å–ª–∏ –Ω–µ—Ç —Ü–µ–Ω –ñ–î/–ê–í–ò–ê ‚Üí –ø—Ä–æ–ø—É—Å–∫–∞–µ–º —ç—Ç–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ

### 6. **–û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–∏—Ä–∞–∂–∞ (Quantity)**

**–í–∞—Ä–∏–∞–Ω—Ç—ã —Ñ–æ—Ä–º–∞—Ç–∞:**
- `1000` ‚Üí `1000`
- `300-500` ‚Üí `300` (–±–µ—Ä–µ–º –ø–µ—Ä–≤–æ–µ —á–∏—Å–ª–æ)
- `5 000` ‚Üí `5000` (—É–±–∏—Ä–∞–µ–º –ø—Ä–æ–±–µ–ª—ã)
- `10000—à—Ç` ‚Üí `10000` (–∏–∑–≤–ª–µ–∫–∞–µ–º —Ç–æ–ª—å–∫–æ —Ü–∏—Ñ—Ä—ã)

**–ö–æ–¥:**
```python
qty_str = str(cell_value).strip()
if '-' in qty_str:
    qty_str = qty_str.split('-')[0].strip()
qty = int(''.join(filter(str.isdigit, qty_str)))
```

### 7. **–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (Product Images)**

#### üì∑ **–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∏–∑ Excel**
- –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ö—Ä–∞–Ω—è—Ç—Å—è –∫–∞–∫ **blob –¥–∞–Ω–Ω—ã–µ** –≤–Ω—É—Ç—Ä–∏ `.xlsx` —Ñ–∞–π–ª–æ–≤
- –ò—Å–ø–æ–ª—å–∑—É–µ–º `openpyxl` —Å `data_only=False` –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è
- –î–æ—Å—Ç—É–ø —á–µ—Ä–µ–∑ `worksheet._images`

#### üìÅ **–§–æ—Ä–º–∞—Ç –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞:**
```
{table_id}_{cell_position}_{hash}.png
```

**–ü—Ä–∏–º–µ—Ä:**
```
11Zs0Urnzve7URBBwgWsonjjgOWc414YP_Onkxo0AMRo_N7_474edece.png
```

–ì–¥–µ:
- `11Zs0Urnzve7URBBwgWsonjjgOWc414YP_Onkxo0AMRo` = Google Sheets Table ID
- `N7` = –ü–æ–∑–∏—Ü–∏—è —è—á–µ–π–∫–∏ (—Å—Ç–æ–ª–±–µ—Ü N, —Å—Ç—Ä–æ–∫–∞ 7)
- `474edece` = MD5 hash –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (–ø–µ—Ä–≤—ã–µ 8 —Å–∏–º–≤–æ–ª–æ–≤)

#### üîó **–ü—Ä–∏–≤—è–∑–∫–∞ –∫ —Ç–æ–≤–∞—Ä–∞–º:**
- –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø—Ä–∏–≤—è–∑—ã–≤–∞—é—Ç—Å—è –ø–æ **–¥–∏–∞–ø–∞–∑–æ–Ω—É —Å—Ç—Ä–æ–∫**: ¬±2 –æ—Ç —Å—Ç—Ä–æ–∫–∏ —Ç–æ–≤–∞—Ä–∞
- –ï—Å–ª–∏ —Ç–æ–≤–∞—Ä –≤ —Å—Ç—Ä–æ–∫–µ 10, –∏—â–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ —Å—Ç—Ä–æ–∫–∞—Ö 8-12
- **–ù–µ—Å–∫–æ–ª—å–∫–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π** –Ω–∞ —Ç–æ–≤–∞—Ä ‚Üí —Å–æ—Ö—Ä–∞–Ω—è–µ–º –≤—Å–µ

#### üíæ **–ü–æ–ª—è –≤ –ë–î:**
| –ü–æ–ª–µ          | –¢–∏–ø    | –û–ø–∏—Å–∞–Ω–∏–µ                              |
|---------------|--------|---------------------------------------|
| product_id    | Int    | FK –∫ —Ç–∞–±–ª–∏—Ü–µ `products`               |
| table_id      | String | ID Google Sheets —Ç–∞–±–ª–∏—Ü—ã              |
| image_filename| String | –ò–º—è —Ñ–∞–π–ª–∞ (—Å–º. —Ñ–æ—Ä–º–∞—Ç –≤—ã—à–µ)           |
| cell_position | String | –ü–æ–∑–∏—Ü–∏—è –≤ —Ç–∞–±–ª–∏—Ü–µ (A1, B5, N7...)     |
| row_number    | Int    | –ù–æ–º–µ—Ä —Å—Ç—Ä–æ–∫–∏                          |
| column_number | Int    | –ù–æ–º–µ—Ä —Å—Ç–æ–ª–±—Ü–∞                         |

---

## üìä –í–ê–õ–ò–î–ê–¶–ò–Ø –°–¢–†–£–ö–¢–£–†–´

### –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è:

1. ‚úÖ **–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ —Å—Ç–æ–ª–±—Ü—ã** (–¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏):
   - –§–æ—Ç–æ (A)
   - –ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ (B)
   - –¢–∏—Ä–∞–∂ (E)
   - –¶–µ–Ω—ã (F, G, I, J - —Ö–æ—Ç—è –±—ã –æ–¥–Ω–∞)
   - –°—Ä–æ–∫ –¥–æ—Å—Ç–∞–≤–∫–∏ (H, K)

2. ‚úÖ **–ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤:**
   - –ò—â–µ–º –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞: `—Ñ–æ—Ç–æ`, `–Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ`, `—Ç–∏—Ä–∞–∂`, `—Ü–µ–Ω–∞`, `–¥–æ—Å—Ç–∞–≤–∫–∞`
   - –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –º–∞—Ä—à—Ä—É—Ç–æ–≤: `–∂–¥`, `–∞–≤–∏–∞`, `–∂/–¥`, `–∞–≤—Ç–æ`

3. ‚úÖ **–í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö:**
   - `quantity > 0`
   - `price_usd > 0` –ò–õ–ò `price_rub > 0`
   - `delivery_time_days >= 0`

---

## üóÑÔ∏è –°–•–ï–ú–ê –ë–ê–ó–´ –î–ê–ù–ù–´–•

### **–¢–∞–±–ª–∏—Ü–∞: `projects`**
```sql
id                  SERIAL PRIMARY KEY
project_name        VARCHAR(500)
table_id            VARCHAR(200)  -- Google Sheets ID
google_sheets_url   TEXT
parsing_status      VARCHAR(50)   -- 'pending', 'completed', 'error'
parsing_errors      TEXT
parsed_at           TIMESTAMP
created_at          TIMESTAMP
updated_at          TIMESTAMP
```

### **–¢–∞–±–ª–∏—Ü–∞: `products`**
```sql
id                  SERIAL PRIMARY KEY
project_id          INTEGER FK ‚Üí projects.id
table_id            VARCHAR(200)
name                VARCHAR(500)  -- –°—Ç–æ–ª–±–µ—Ü B
description         TEXT          -- –°—Ç–æ–ª–±–µ—Ü C
custom_field        TEXT          -- –°—Ç–æ–ª–±–µ—Ü D (–¥–∏–∑–∞–π–Ω)
created_at          TIMESTAMP
updated_at          TIMESTAMP
```

### **–¢–∞–±–ª–∏—Ü–∞: `price_offers`**
```sql
id                  SERIAL PRIMARY KEY
product_id          INTEGER FK ‚Üí products.id
quantity            INTEGER       -- –°—Ç–æ–ª–±–µ—Ü E
price_usd           DECIMAL(10,2) -- –°—Ç–æ–ª–±—Ü—ã F/I
price_rub           DECIMAL(10,2) -- –°—Ç–æ–ª–±—Ü—ã G/J
route               VARCHAR(50)   -- "–ñ–î" –∏–ª–∏ "–ê–í–ò–ê"
delivery_time_days  INTEGER       -- –°—Ç–æ–ª–±—Ü—ã H/K
created_at          TIMESTAMP
updated_at          TIMESTAMP
```

### **–¢–∞–±–ª–∏—Ü–∞: `product_images`**
```sql
id                  SERIAL PRIMARY KEY
product_id          INTEGER FK ‚Üí products.id
table_id            VARCHAR(200)
image_filename      VARCHAR(500)
cell_position       VARCHAR(10)   -- "A1", "N7"
row_number          INTEGER
column_number       INTEGER
created_at          TIMESTAMP
updated_at          TIMESTAMP
```

---

## üöÄ –ü–†–û–¶–ï–°–° –ü–ê–†–°–ò–ù–ì–ê

### –®–∞–≥ 1: –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞
```python
# –î–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (–ë–ï–ó data_only)
workbook_images = load_workbook(file_path, data_only=False)

# –î–ª—è –¥–∞–Ω–Ω—ã—Ö (–° data_only –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π)
workbook_data = load_workbook(file_path, data_only=True)
```

### –®–∞–≥ 2: –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
```python
images_by_row = {}  # {row_idx: [{'filename': ..., 'cell_position': ..., ...}]}

if hasattr(worksheet_images, '_images'):
    for img in worksheet_images._images:
        row = img.anchor._from.row + 1
        col = img.anchor._from.col + 1
        img_data = save_image_from_excel(img, table_id, row, col)
        images_by_row[row].append(img_data)
```

### –®–∞–≥ 3: –ü–∞—Ä—Å–∏–Ω–≥ —Ç–æ–≤–∞—Ä–æ–≤
```python
skip_rows = set()  # –£–∂–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏

for row_idx in range(5, 500):
    if row_idx in skip_rows:
        continue
    
    name = worksheet_data.cell(row_idx, 2).value  # –°—Ç–æ–ª–±–µ—Ü B
    
    if not name or len(name) < 3:
        continue
    
    # –ü–∞—Ä—Å–∏–º –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –∏–∑ —Ç–µ–∫—É—â–µ–π —Å—Ç—Ä–æ–∫–∏
    offers = parse_offers_from_row(row_idx)
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–ª–µ–¥—É—é—â–∏–µ —Å—Ç—Ä–æ–∫–∏ –Ω–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è
    check_row = row_idx + 1
    while check_row < 500:
        next_name = worksheet_data.cell(check_row, 2).value
        next_qty = worksheet_data.cell(check_row, 5).value
        
        if next_name and len(str(next_name)) >= 3:
            break  # –ù–æ–≤—ã–π —Ç–æ–≤–∞—Ä
        
        if next_qty:
            # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –¢–û–ì–û –ñ–ï —Ç–æ–≤–∞—Ä–∞
            additional_offers = parse_offers_from_row(check_row)
            offers.extend(additional_offers)
            skip_rows.add(check_row)
            check_row += 1
        else:
            break
    
    # –ò—â–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (¬±2 —Å—Ç—Ä–æ–∫–∏)
    product_images = []
    for check_row in range(max(1, row_idx - 2), row_idx + 3):
        if check_row in images_by_row:
            product_images.extend(images_by_row[check_row])
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–æ–≤–∞—Ä
    save_product(name, description, custom_field, offers, product_images)
```

### –®–∞–≥ 4: –ü–∞—Ä—Å–∏–Ω–≥ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π
```python
def parse_offers_from_row(row_idx):
    offers = []
    
    # –¢–∏—Ä–∞–∂
    qty_cell = worksheet_data.cell(row_idx, 5)
    if not qty_cell.value:
        return offers
    
    qty_str = str(qty_cell.value).strip()
    if '-' in qty_str:
        qty_str = qty_str.split('-')[0].strip()
    qty = int(''.join(filter(str.isdigit, qty_str)))
    
    # –ñ–î –º–∞—Ä—à—Ä—É—Ç
    price_usd_jd = parse_float(worksheet_data.cell(row_idx, 6).value)
    price_rub_jd = parse_float(worksheet_data.cell(row_idx, 7).value)
    delivery_jd = parse_int(worksheet_data.cell(row_idx, 8).value)
    
    if price_usd_jd or price_rub_jd:
        offers.append({
            'quantity': qty,
            'price_usd': price_usd_jd,
            'price_rub': price_rub_jd,
            'route': '–ñ–î',
            'delivery_time_days': delivery_jd or 60
        })
    
    # –ê–í–ò–ê –º–∞—Ä—à—Ä—É—Ç
    price_usd_avia = parse_float(worksheet_data.cell(row_idx, 9).value)
    price_rub_avia = parse_float(worksheet_data.cell(row_idx, 10).value)
    delivery_avia = parse_int(worksheet_data.cell(row_idx, 11).value)
    
    if price_usd_avia or price_rub_avia:
        offers.append({
            'quantity': qty,
            'price_usd': price_usd_avia,
            'price_rub': price_rub_avia,
            'route': '–ê–í–ò–ê',
            'delivery_time_days': delivery_avia or 30
        })
    
    return offers
```

---

## ‚úÖ –ö–û–ù–¢–†–û–õ–¨ –ö–ê–ß–ï–°–¢–í–ê

### –ú–µ—Ç—Ä–∏–∫–∏ –ø–æ—Å–ª–µ –ø–∞—Ä—Å–∏–Ω–≥–∞:

1. **–£—Å–ø–µ—à–Ω–æ—Å—Ç—å:** ‚â• 70%
2. **–¢–æ–≤–∞—Ä—ã —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏:** ‚â• 85%
3. **–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π –Ω–∞ —Ç–æ–≤–∞—Ä:** ‚â• 2.0 (—É—á–∏—Ç—ã–≤–∞—è –º–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω–æ—Å—Ç—å –∏ –º–∞—Ä—à—Ä—É—Ç—ã)
4. **–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –Ω–∞ —Ç–æ–≤–∞—Ä:** ‚â• 3.0

### –¢–µ–∫—É—â–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã (8,573 —Ç–æ–≤–∞—Ä–∞):
- ‚úÖ –¢–æ–≤–∞—Ä—ã —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏: **93.0%**
- ‚úÖ –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π –Ω–∞ —Ç–æ–≤–∞—Ä: **2.80**
- ‚úÖ –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –Ω–∞ —Ç–æ–≤–∞—Ä: **3.40**

---

## üêõ –û–°–û–ë–´–ï –°–õ–£–ß–ê–ò

### 1. **–°—Ç–æ–ª–±–µ—Ü "–ò—Ç–æ–≥–æ, —Ä—É–±"**
- –ï—Å–ª–∏ –≤ —Ç–∞–±–ª–∏—Ü–µ –µ—Å—Ç—å —Å—Ç–æ–ª–±–µ—Ü "–ò—Ç–æ–≥–æ" ‚Üí **–ø—Ä–æ–ø—É—Å–∫–∞–µ–º –µ–≥–æ**
- –ù–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞, –Ω–æ —É—á–∏—Ç—ã–≤–∞–µ–º –ø—Ä–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã

### 2. **–û–±—Ä–∞–∑—Ü—ã**
- –ò–Ω–æ–≥–¥–∞ —Ç–∏—Ä–∞–∂ = "–û–±—Ä–∞–∑–µ—Ü" (–≤–º–µ—Å—Ç–æ —á–∏—Å–ª–∞)
- –ü–∞—Ä—Å–∏–º –∫–∞–∫ `quantity = 1` —Å route = "–û–±—Ä–∞–∑–µ—Ü"

### 3. **–ü—É—Å—Ç—ã–µ —Ü–µ–Ω—ã**
- –ï—Å–ª–∏ `price_usd = 0` –∏ `price_rub = 0` ‚Üí **–Ω–µ —Å–æ–∑–¥–∞–µ–º –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ**
- –õ–æ–≥–∏—Ä—É–µ–º –¥–ª—è –æ—Ç—á–µ—Ç–∞

### 4. **–î—É–±–ª–∏–∫–∞—Ç—ã**
- –ü–µ—Ä–µ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –ø—Ä–æ–≤–µ—Ä—è–µ–º: —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ —Ç–æ–≤–∞—Ä —Å —Ç–∞–∫–∏–º –∏–º–µ–Ω–µ–º –¥–ª—è —ç—Ç–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞
- –ï—Å–ª–∏ –¥–∞ ‚Üí **–ø—Ä–æ–ø—É—Å–∫–∞–µ–º** (–Ω–µ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ–º)

---

## üìù –õ–û–ì–ò–†–û–í–ê–ù–ò–ï

### –£—Ä–æ–≤–Ω–∏ –ª–æ–≥–æ–≤:

```python
logger.info(f"üìã {i}/{total}: –ü–∞—Ä—Å–∏–Ω–≥ {filename}")
logger.info(f"   ‚úÖ –¢–æ–≤–∞—Ä—ã: {products} | –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è: {offers} | –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è: {images}")
logger.warning(f"   ‚ö†Ô∏è  No products found")
logger.error(f"   ‚ùå –û—à–∏–±–∫–∞: {error_message}")
```

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤ –∫–æ–Ω—Ü–µ:
```
‚úÖ –£—Å–ø–µ—à–Ω–æ: 198/272 (72.8%)
‚ùå –û—à–∏–±–∫–∏: 74
üì¶ –¢–æ–≤–∞—Ä—ã: 759
üí∞ –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è: 2,466
üñºÔ∏è  –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è: 5,868
```

---

## üîÑ –û–ë–ù–û–í–õ–ï–ù–ò–ï –î–ê–ù–ù–´–•

### –ü—Ä–∞–≤–∏–ª–∞:
1. **–ù–ï –ü–ï–†–ï–ó–ê–ü–ò–°–´–í–ê–ï–ú** —É–∂–µ —Å–ø–∞—Ä—Å–µ–Ω–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç—ã (–ø—Ä–æ–≤–µ—Ä—è–µ–º `parsing_status = 'completed'`)
2. **–ù–ï –î–£–ë–õ–ò–†–£–ï–ú** —Ç–æ–≤–∞—Ä—ã (–ø—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ `project_id` + `name`)
3. **–õ–û–ì–ò–†–£–ï–ú** –≤—Å–µ –ø—Ä–æ–ø—É—Å–∫–∏ –∏ –æ—à–∏–±–∫–∏

---

## üì¶ –§–ê–ô–õ–´ –ü–†–û–ï–ö–¢–ê

```
cp_parser/
‚îú‚îÄ‚îÄ parse_validated_272_files.py       # –û—Å–Ω–æ–≤–Ω–æ–π –ø–∞—Ä—Å–µ—Ä
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îî‚îÄ‚îÄ structure_parser.py            # –í–∞–ª–∏–¥–∞—Ü–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
‚îú‚îÄ‚îÄ database/
‚îÇ   ‚îú‚îÄ‚îÄ models.py                      # SQLAlchemy –º–æ–¥–µ–ª–∏
‚îÇ   ‚îî‚îÄ‚îÄ postgresql_manager.py          # –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ PostgreSQL
‚îú‚îÄ‚îÄ storage/
‚îÇ   ‚îú‚îÄ‚îÄ excel_files/                   # –ò—Å—Ö–æ–¥–Ω—ã–µ .xlsx —Ñ–∞–π–ª—ã
‚îÇ   ‚îî‚îÄ‚îÄ images/                        # –ò–∑–≤–ª–µ—á–µ–Ω–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
‚îî‚îÄ‚îÄ PARSING_RULES.md                   # –≠–¢–û –§–ê–ô–õ
```

---

## üéØ –ò–¢–û–ì

**–ì–ª–∞–≤–Ω–æ–µ –ø—Ä–∞–≤–∏–ª–æ:**
> –û–¥–∏–Ω —Ç–æ–≤–∞—Ä = –æ–¥–Ω–∞ –∑–∞–ø–∏—Å—å –≤ `products`, –Ω–æ –º–æ–∂–µ—Ç –∏–º–µ—Ç—å **–ù–ï–°–ö–û–õ–¨–ö–û** —Å—Ç—Ä–æ–∫ –≤ –∏—Å—Ö–æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ (–º–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω–æ—Å—Ç—å), **–ù–ï–°–ö–û–õ–¨–ö–û** price_offers (–ñ–î/–ê–í–ò–ê + —Ä–∞–∑–Ω—ã–µ —Ç–∏—Ä–∞–∂–∏) –∏ **–ù–ï–°–ö–û–õ–¨–ö–û** –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π.

**–ü–∞—Ä—Å–∏–º:**
- ‚úÖ –ú–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã (–ø—É—Å—Ç–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ, –Ω–æ –µ—Å—Ç—å —Ç–∏—Ä–∞–∂)
- ‚úÖ –ù–µ—Å–∫–æ–ª—å–∫–æ –º–∞—Ä—à—Ä—É—Ç–æ–≤ (–ñ–î –∏ –ê–í–ò–ê) –∏–∑ –æ–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏
- ‚úÖ –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–∑ blob –¥–∞–Ω–Ω—ã—Ö Excel
- ‚úÖ –í—Å–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã —Ç–∏—Ä–∞–∂–µ–π (`1000`, `300-500`, `5 000 —à—Ç`)

---

*–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ: 08.10.2025*










