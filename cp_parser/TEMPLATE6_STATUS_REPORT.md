# –û–¢–ß–ï–¢ –ü–û –ü–ê–†–°–ò–ù–ì–£ –®–ê–ë–õ–û–ù–ê 6

## üìä –¢–ï–ö–£–©–ï–ï –°–û–°–¢–û–Ø–ù–ò–ï

### ‚úÖ –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:
- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å—Ç—Ä–æ–∫–∏ –Ω–∞—á–∞–ª–∞ –¥–∞–Ω–Ω—ã—Ö (—Å—Ç—Ä–æ–∫–∞ 3 –∏–ª–∏ 4)
- –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ –∏–∑ —Å—Ç—Ä–æ–∫ 2 –∏ 3
- –ü–∞—Ä—Å–∏–Ω–≥ —Ç–æ–≤–∞—Ä–æ–≤ –∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ 23-44 —Å—Ç–æ–ª–±—Ü–æ–≤

### ‚ö†Ô∏è  –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –ü–†–û–ë–õ–ï–ú–ê:

**–ü–∞—Ä—Å–µ—Ä –Ω–µ –Ω–∞—Ö–æ–¥–∏—Ç –≤—Å–µ —Å—Ç–æ–ª–±—Ü—ã —Å —Ü–µ–Ω–∞–º–∏ RUB!**

**–ü—Ä–∏—á–∏–Ω–∞:**
- –°—Ç—Ä–æ–∫–∞ 2: "–î–æ—Å—Ç–∞–≤–∫–∞ –ñ–î" —Ç–æ–ª—å–∫–æ –≤ –∫–æ–ª–æ–Ω–∫–µ 6
- –ö–æ–ª–æ–Ω–∫–∏ 7-9: –ø—É—Å—Ç—ã–µ –≤ —Å—Ç—Ä–æ–∫–µ 2, –Ω–æ –∏–º–µ—é—Ç –ø–æ–¥–∑–∞–≥–æ–ª–æ–≤–∫–∏ –≤ —Å—Ç—Ä–æ–∫–µ 3
- –¢–µ–∫—É—â–∏–π –∞–ª–≥–æ—Ä–∏—Ç–º –∏—â–µ—Ç "–î–æ—Å—Ç–∞–≤–∫–∞ –ñ–î" + "—Ä—É–±" –≤ –û–î–ù–û–ô –∫–æ–ª–æ–Ω–∫–µ
- –ù–æ "–î–æ—Å—Ç–∞–≤–∫–∞ –ñ–î" –≤ –∫–æ–ª 6, –∞ "—Ä—É–±" –≤ –∫–æ–ª 7!

**–ü—Ä–∏–º–µ—Ä (–ø—Ä–æ–µ–∫—Ç 25):**
```
–°—Ç—Ä–æ–∫–∞ 2:  | –î–æ—Å—Ç–∞–≤–∫–∞ –ñ–î | (–ø—É—Å—Ç–æ) | (–ø—É—Å—Ç–æ) | (–ø—É—Å—Ç–æ) | –î–æ—Å—Ç–∞–≤–∫–∞ –ñ–î –¥–æ–ª–≥–æ–µ |
–°—Ç—Ä–æ–∫–∞ 3:  | –¶–µ–Ω–∞ $      | –¶–µ–Ω–∞ —Ä—É–±| –ò—Ç–æ–≥–æ   | –°—Ä–æ–∫    | –¶–µ–Ω–∞ $             |
–ö–æ–ª–æ–Ω–∫–∏:   |      6      |    7    |    8    |    9    |        10          |
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –ù–∞—Ö–æ–¥–∏—Ç: –∫–æ–ª–æ–Ω–∫–∞ 6 (–ñ–î USD)
- ‚ùå –ù–ï –Ω–∞—Ö–æ–¥–∏—Ç: –∫–æ–ª–æ–Ω–∫–∞ 7 (–ñ–î RUB) - –ø–æ—Ç–æ–º—É —á—Ç–æ –≤ —Å—Ç—Ä–æ–∫–µ 2 –ø—É—Å—Ç–æ!
- ‚úÖ –ù–∞—Ö–æ–¥–∏—Ç: –∫–æ–ª–æ–Ω–∫–∞ 10 (–î–æ–ª–≥–æ–µ –ñ–î USD)
- ‚ùå –ù–ï –Ω–∞—Ö–æ–¥–∏—Ç: –∫–æ–ª–æ–Ω–∫–∞ 11 (–î–æ–ª–≥–æ–µ –ñ–î RUB)

**–ò–∑-–∑–∞ —ç—Ç–æ–≥–æ —Å–æ–∑–¥–∞—é—Ç—Å—è –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –æ—Ñ—Ñ–µ—Ä—ã:**
```
–í–º–µ—Å—Ç–æ:  850 —à—Ç | –ñ–î | $30.94 / 2599.20 —Ä—É–±
–ü–æ–ª—É—á–∞–µ—Ç—Å—è:
  850 —à—Ç | –ñ–î | $30.94 / 0 —Ä—É–±
  850 —à—Ç | –±–µ–∑ –º–∞—Ä—à—Ä—É—Ç–∞ | $0 / 2599.20 —Ä—É–±
```

---

## üîß –†–ï–®–ï–ù–ò–ï

–ù—É–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å `_detect_columns`:

1. **–ù–∞–π—Ç–∏ –≥—Ä—É–ø–ø—ã –º–∞—Ä—à—Ä—É—Ç–æ–≤** (–∫–æ–ª–æ–Ω–∫–∏ –≥–¥–µ —Å—Ç—Ä–æ–∫–∞ 2 = "–î–æ—Å—Ç–∞–≤–∫–∞ –ñ–î", "–î–æ—Å—Ç–∞–≤–∫–∞ –ê–≤–∏–∞" –∏ —Ç.–¥.)
2. **–°–∫–∞–Ω–∏—Ä–æ–≤–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ N –∫–æ–ª–æ–Ω–æ–∫** –ø–æ—Å–ª–µ –Ω–∞–π–¥–µ–Ω–Ω–æ–π –≥—Ä—É–ø–ø—ã
3. **–ò—Å–∫–∞—Ç—å –ø–æ–¥–∑–∞–≥–æ–ª–æ–≤–∫–∏ –≤ —Å—Ç—Ä–æ–∫–µ 3**: "–¶–µ–Ω–∞ $", "–¶–µ–Ω–∞ —Ä—É–±", "–ò—Ç–æ–≥–æ", "–°—Ä–æ–∫"
4. **–ü—Ä–∏–≤—è–∑–∞—Ç—å –∏—Ö –∫ –º–∞—Ä—à—Ä—É—Ç—É** –∏–∑ —à–∞–≥–∞ 1

**–ê–ª–≥–æ—Ä–∏—Ç–º:**
```python
for col in range(1, ws.max_column + 1):
    header2 = ws.cell(2, col).value
    
    if "–î–æ—Å—Ç–∞–≤–∫–∞ –ñ–î" in header2:
        route_start_col = col
        # –°–∫–∞–Ω–∏—Ä—É–µ–º —Å–ª–µ–¥—É—é—â–∏–µ 4-5 –∫–æ–ª–æ–Ω–æ–∫
        for offset in range(5):
            check_col = col + offset
            header3 = ws.cell(3, check_col).value
            
            if "—Ü–µ–Ω–∞" in header3 and "$" in header3:
                columns['jd_usd'] = check_col
            elif "—Ü–µ–Ω–∞" in header3 and "—Ä—É–±" in header3:
                columns['jd_rub'] = check_col
            elif "—Å—Ä–æ–∫" in header3:
                columns['jd_delivery'] = check_col
```

---

## üìù –ü–õ–ê–ù –î–ï–ô–°–¢–í–ò–ô

1. ‚è∏Ô∏è  **–û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å** —Ç–µ–∫—É—â–∏–π –ø–∞—Ä—Å–∏–Ω–≥ (–µ—Å–ª–∏ –∑–∞–ø—É—â–µ–Ω)
2. üîß **–ü–µ—Ä–µ–ø–∏—Å–∞—Ç—å** –º–µ—Ç–æ–¥ `_detect_columns` —Å –≥—Ä—É–ø–ø–æ–≤—ã–º —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ–º
3. üß™ **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å** –Ω–∞ –ø—Ä–æ–µ–∫—Ç–∞—Ö 25, 2101, 30
4. üóëÔ∏è  **–£–¥–∞–ª–∏—Ç—å** –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –®–∞–±–ª–æ–Ω–∞ 6
5. üöÄ **–ó–∞–ø—É—Å—Ç–∏—Ç—å** –ø–æ–ª–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥ 647 –ø—Ä–æ–µ–∫—Ç–æ–≤

---

## üìä –û–ñ–ò–î–ê–ï–ú–´–ô –†–ï–ó–£–õ–¨–¢–ê–¢

**–î–ª—è –ø—Ä–æ–µ–∫—Ç–∞ 25 (2 —Ç–∏—Ä–∞–∂–∞ √ó 2 –º–∞—Ä—à—Ä—É—Ç–∞ = 4 –æ—Ñ—Ñ–µ—Ä–∞):**
```
‚úÖ 850 —à—Ç  | –ñ–î        | $30.94 / 2599.20 —Ä—É–± | 82 –¥–Ω—è
‚úÖ 850 —à—Ç  | –î–æ–ª–≥–æ–µ –ñ–î | $22.44 / 1918.52 —Ä—É–± | 92 –¥–Ω—è
‚úÖ 1000 —à—Ç | –ñ–î        | $30.65 / 2574.33 —Ä—É–± | 82 –¥–Ω—è
‚úÖ 1000 —à—Ç | –î–æ–ª–≥–æ–µ –ñ–î | $22.15 / 1893.65 —Ä—É–± | 92 –¥–Ω—è
```

---

**–î–∞—Ç–∞:** 2025-10-10  
**–°—Ç–∞—Ç—É—Å:** –¢—Ä–µ–±—É–µ—Ç—Å—è –¥–æ—Ä–∞–±–æ—Ç–∫–∞ –ø–∞—Ä—Å–µ—Ä–∞
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π

