<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Price Calculator - –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä —Ü–µ–Ω —Ç–æ–≤–∞—Ä–æ–≤</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <!-- üé® –ú–û–î–£–õ–¨–ù–´–ô CSS - –§–ê–ó–ê 2.1 -->
    <link rel="stylesheet" href="/static/css/main.css">
    <link rel="stylesheet" href="/static/css/components/header.css">
    <link rel="stylesheet" href="/static/css/components/cards.css">
    <link rel="stylesheet" href="/static/css/components/forms.css">
    <link rel="stylesheet" href="/static/css/components/history.css">
</head>
<body>
    <div id="app">
        <!-- Header -->
        <header class="header">
            <div class="header-content">
                <h1 class="header-title">
                    Price Calculator
                    <span class="header-subtitle">–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä —Ü–µ–Ω —Ç–æ–≤–∞—Ä–æ–≤ –∏–∑ –ö–∏—Ç–∞—è</span>
                </h1>
                
                <div class="header-nav">
                    <button @click="activeTab = 'calculator'" 
                            :class="['nav-button', { active: activeTab === 'calculator' }]">
                        üßÆ –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä
                    </button>
                    <button @click="activeTab = 'history'" 
                            :class="['nav-button', { active: activeTab === 'history' }]">
                        üìã –ò—Å—Ç–æ—Ä–∏—è ({{ history.length }})
                    </button>
                </div>
            </div>
        </header>
        
        <main class="main-content">
            <!-- Calculator Tab -->
            <div v-if="activeTab === 'calculator'">
                <!-- Main Form Card -->
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">
                            {{ editingCalculationId ? '–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞—Å—á–µ—Ç–∞' : '–ù–æ–≤—ã–π —Ä–∞—Å—á–µ—Ç' }}
                        </h2>
                        <p class="card-subtitle">
                            {{ editingCalculationId ? '–ò–∑–º–µ–Ω–∏—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏ –ø–µ—Ä–µ—Å—á–∏—Ç–∞–π—Ç–µ' : '–ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Ñ–æ—Ä–º—É –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ —Å—Ç–æ–∏–º–æ—Å—Ç–∏ —Ç–æ–≤–∞—Ä–∞' }}
                        </p>
                    </div>
                    
                    <form @submit.prevent="calculate()" class="calculator-form">
                        <!-- Product Name -->
                        <div class="form-group">
                            <label for="product_name" class="form-label">–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ *</label>
                            <input 
                                type="text" 
                                id="product_name"
                                v-model="form.product_name"
                                @input="onProductNameChange"
                                class="form-input"
                                placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: Bluetooth –Ω–∞—É—à–Ω–∏–∫–∏"
                                required
                            >
                            <!-- Product Category Display -->
                            <div v-if="detectedCategory" class="category-display">
                                <div class="category-info">
                                    <strong>{{ getCleanCategoryName(detectedCategory.category) }}</strong>
                                    <span v-if="detectedCategory.material"> - {{ detectedCategory.material }}</span>
                                </div>
                            </div>
                        </div>

                        <!-- Category Selection -->
                        <div class="form-group">
                            <label for="category" class="form-label">–ö–∞—Ç–µ–≥–æ—Ä–∏—è —Ç–æ–≤–∞—Ä–∞</label>
                            <select 
                                id="category"
                                v-model="selectedCategoryIndex"
                                @change="onCategoryChange"
                                class="form-select"
                            >
                                <option value="" disabled>–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é –∏–ª–∏ –Ω–∞—á–Ω–∏—Ç–µ –≤–≤–æ–¥–∏—Ç—å –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞</option>
                                <option v-for="(category, index) in categories" 
                                        :key="index" 
                                        :value="index">
                                    {{ getCleanCategoryName(category.category) }}
                                    <span v-if="category.material"> - {{ category.material }}</span>
                                </option>
                            </select>
                        </div>

                        <!-- Product URL -->
                        <div class="form-group">
                            <label for="product_url" class="form-label">–°—Å—ã–ª–∫–∞ –Ω–∞ —Ç–æ–≤–∞—Ä</label>
                            <input 
                                type="url" 
                                id="product_url"
                                v-model="form.product_url"
                                class="form-input"
                                placeholder="https://example.com/product"
                            >
                        </div>

                        <!-- Two Column Layout -->
                        <div class="form-grid">
                            <!-- Price in Yuan -->
                            <div class="form-group">
                                <label for="price_yuan" class="form-label">–¶–µ–Ω–∞ –≤ —é–∞–Ω—è—Ö *</label>
                                <input 
                                    type="number" 
                                    id="price_yuan"
                                    v-model="form.price_yuan"
                                    class="form-input"
                                    placeholder="0.00"
                                    step="0.01"
                                    min="0"
                                    required
                                >
                                <!-- Price Recommendations -->
                                <div v-if="detectedCategory && detectedCategory.recommendations" class="recommendations">
                                    <div v-if="detectedCategory.recommendations.price_yuan_min" class="recommendation-item">
                                        –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è —Ü–µ–Ω–∞: {{ detectedCategory.recommendations.price_yuan_min }}¬• - {{ detectedCategory.recommendations.price_yuan_max }}¬•
                                    </div>
                                </div>
                            </div>

                            <!-- Weight -->
                            <div class="form-group">
                                <label for="weight_kg" class="form-label">–û–±—â–∏–π –≤–µ—Å, –∫–≥ *</label>
                                <input 
                                    type="number" 
                                    id="weight_kg"
                                    v-model="form.weight_kg"
                                    class="form-input"
                                    placeholder="0.00"
                                    step="0.01"
                                    min="0"
                                    required
                                >
                                <!-- Weight Recommendations -->
                                <div v-if="detectedCategory && detectedCategory.recommendations && detectedCategory.recommendations.weight_min" class="recommendations">
                                    <div class="recommendation-item">
                                        –û–±—ã—á–Ω—ã–π –≤–µ—Å: {{ detectedCategory.recommendations.weight_min }}–∫–≥ - {{ detectedCategory.recommendations.weight_max }}–∫–≥
                                    </div>
                                </div>
                            </div>

                            <!-- Quantity -->
                            <div class="form-group">
                                <label for="quantity" class="form-label">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ, —à—Ç *</label>
                                <input 
                                    type="number" 
                                    id="quantity"
                                    v-model="form.quantity"
                                    class="form-input"
                                    placeholder="1"
                                    min="1"
                                    required
                                >
                                <!-- Quantity Recommendations -->
                                <div v-if="detectedCategory && detectedCategory.recommendations && detectedCategory.recommendations.quantity_min" class="recommendations">
                                    <div class="recommendation-item">
                                        –û–±—ã—á–Ω—ã–π —Ç–∏—Ä–∞–∂: {{ detectedCategory.recommendations.quantity_min }}—à—Ç - {{ detectedCategory.recommendations.quantity_max }}—à—Ç
                                    </div>
                                </div>
                            </div>

                            <!-- Markup -->
                            <div class="form-group">
                                <label for="markup" class="form-label">–ù–∞—Ü–µ–Ω–∫–∞ *</label>
                                <input 
                                    type="number" 
                                    id="markup"
                                    v-model="form.markup"
                                    class="form-input"
                                    placeholder="1.7"
                                    step="0.1"
                                    min="1"
                                    required
                                >
                                <div class="form-help">
                                    {{ ((form.markup - 1) * 100).toFixed(0) }}% –Ω–∞—Ü–µ–Ω–∫–∞
                                </div>
                            </div>
                        </div>

                        <!-- Delivery Section -->
                        <div class="delivery-section">
                            <h3 class="section-title">–î–æ—Å—Ç–∞–≤–∫–∞ –∏ –ª–æ–≥–∏—Å—Ç–∏–∫–∞</h3>
                            
                            <div class="form-grid">
                                <!-- Delivery Type -->
                                <div class="form-group">
                                    <label class="form-label">–¢–∏–ø –¥–æ—Å—Ç–∞–≤–∫–∏</label>
                                    <div class="radio-group">
                                        <label class="radio-label">
                                            <input 
                                                type="radio" 
                                                v-model="form.delivery_type" 
                                                value="rail"
                                                @change="updateSuggestedRate"
                                                class="radio-input"
                                            >
                                            <span class="radio-text">üöÇ –ñ–î –¥–æ—Å—Ç–∞–≤–∫–∞ (–º–µ–¥–ª–µ–Ω–Ω–æ, –¥–µ—à–µ–≤–æ)</span>
                                        </label>
                                        <label class="radio-label">
                                            <input 
                                                type="radio" 
                                                v-model="form.delivery_type" 
                                                value="air"
                                                @change="updateSuggestedRate"
                                                class="radio-input"
                                            >
                                            <span class="radio-text">‚úàÔ∏è –ê–≤–∏–∞ –¥–æ—Å—Ç–∞–≤–∫–∞ (–±—ã—Å—Ç—Ä–æ, –¥–æ—Ä–æ–≥–æ)</span>
                                        </label>
                                    </div>
                                </div>

                                <!-- Custom Rate -->
                                <div class="form-group">
                                    <label for="custom_rate" class="form-label">–õ–æ–≥–∏—Å—Ç–∏—á–µ—Å–∫–∞—è —Å—Ç–∞–≤–∫–∞, $/–∫–≥</label>
                                    <input 
                                        type="number" 
                                        id="custom_rate"
                                        v-model="form.custom_rate"
                                        class="form-input"
                                        placeholder="–û—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—ã–º –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ä–∞—Å—á–µ—Ç–∞"
                                        step="0.01"
                                        min="0"
                                    >
                                    <div v-if="suggestedRate > 0" class="form-help">
                                        –ü—Ä–µ–¥–ª–∞–≥–∞–µ–º–∞—è —Å—Ç–∞–≤–∫–∞: ${{ suggestedRate }}
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Submit Button -->
                        <div class="form-actions">
                            <button 
                                type="submit" 
                                :disabled="!isFormValid || isCalculating"
                                class="btn btn-primary"
                            >
                                <span v-if="isCalculating" class="loading-spinner"></span>
                                {{ isCalculating ? '–†–∞—Å—á–µ—Ç...' : (editingCalculationId ? '–ü–µ—Ä–µ—Å—á–∏—Ç–∞—Ç—å' : '–†–∞—Å—Å—á–∏—Ç–∞—Ç—å —Å—Ç–æ–∏–º–æ—Å—Ç—å') }}
                            </button>
                            
                            <button 
                                v-if="editingCalculationId" 
                                type="button" 
                                @click="resetForm()" 
                                class="btn btn-secondary"
                            >
                                –û—Ç–º–µ–Ω–∏—Ç—å —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
                            </button>
                        </div>
                    </form>
                </div>

                <!-- Results Section -->
                <transition name="fade">
                    <div v-if="result" class="results-section">
                        <div class="card">
                            <div class="card-header">
                                <h2 class="card-title">–†–µ–∑—É–ª—å—Ç–∞—Ç —Ä–∞—Å—á–µ—Ç–∞</h2>
                                <p class="card-subtitle">–í—Å–µ —Ü–µ–Ω—ã —É–∫–∞–∑–∞–Ω—ã —Å —É—á–µ—Ç–æ–º —Ç–µ–∫—É—â–µ–≥–æ –∫—É—Ä—Å–∞ –≤–∞–ª—é—Ç</p>
                            </div>
                            
                            <!-- Main Results Grid -->
                            <div class="results-grid">
                                <!-- Cost Price -->
                                <div class="result-card cost-price">
                                    <div class="result-header">
                                        <h3>–°–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å</h3>
                                    </div>
                                    <div class="result-main">
                                        <div class="result-total">{{ result.cost_price.total.rub.toLocaleString() }} ‚ÇΩ</div>
                                        <div class="result-unit">{{ (result.cost_price.total.rub / result.quantity).toFixed(0) }} ‚ÇΩ/—à—Ç</div>
                                        <div class="result-secondary">${{ result.cost_price.total.usd.toLocaleString() }}</div>
                                    </div>
                                </div>

                                <!-- Sale Price -->
                                <div class="result-card sale-price">
                                    <div class="result-header">
                                        <h3>–¶–µ–Ω–∞ –ø—Ä–æ–¥–∞–∂–∏</h3>
                                    </div>
                                    <div class="result-main">
                                        <div class="result-total">{{ result.sale_price.total.rub.toLocaleString() }} ‚ÇΩ</div>
                                        <div class="result-unit">{{ (result.sale_price.total.rub / result.quantity).toFixed(0) }} ‚ÇΩ/—à—Ç</div>
                                        <div class="result-secondary">${{ result.sale_price.total.usd.toLocaleString() }}</div>
                                    </div>
                                </div>

                                <!-- Profit -->
                                <div class="result-card profit">
                                    <div class="result-header">
                                        <h3>–ü—Ä–∏–±—ã–ª—å</h3>
                                    </div>
                                    <div class="result-main">
                                        <div class="result-total">{{ result.profit.total.rub.toLocaleString() }} ‚ÇΩ</div>
                                        <div class="result-unit">{{ (result.profit.total.rub / result.quantity).toFixed(0) }} ‚ÇΩ/—à—Ç</div>
                                        <div class="result-secondary">${{ result.profit.total.usd.toLocaleString() }}</div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Detailed Breakdown -->
                            <div class="breakdown-section">
                                <h3 class="section-title">–î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è —Ä–∞—Å—Ö–æ–¥–æ–≤</h3>
                                <div class="breakdown-grid">
                                    <div class="detail-item">
                                        <span class="detail-label">–¢–æ–≤–∞—Ä:</span>
                                        <span class="detail-value">{{ result.cost_breakdown.product_cost_rub.toLocaleString() }} —Ä—É–± ({{ getPercentOfCost(result.cost_breakdown.product_cost_rub, result.cost_price.total.rub) }}%)</span>
                                    </div>
                                    <div class="detail-item">
                                        <span class="detail-label">–õ–æ–≥–∏—Å—Ç–∏–∫–∞:</span>
                                        <span class="detail-value">{{ result.cost_breakdown.logistics_rub.toLocaleString() }} —Ä—É–± ({{ getPercentOfCost(result.cost_breakdown.logistics_rub, result.cost_price.total.rub) }}%)</span>
                                    </div>
                                    <div class="detail-item">
                                        <span class="detail-label">–¢–∞–º–æ–∂–µ–Ω–Ω–∞—è –ø–æ—à–ª–∏–Ω–∞:</span>
                                        <span class="detail-value">{{ result.cost_breakdown.customs_duty_rub.toLocaleString() }} —Ä—É–± ({{ getPercentOfCost(result.cost_breakdown.customs_duty_rub, result.cost_price.total.rub) }}%)</span>
                                    </div>
                                    <div class="detail-item">
                                        <span class="detail-label">–ù–î–°:</span>
                                        <span class="detail-value">{{ result.cost_breakdown.vat_rub.toLocaleString() }} —Ä—É–± ({{ getPercentOfCost(result.cost_breakdown.vat_rub, result.cost_price.total.rub) }}%)</span>
                                    </div>
                                    <div class="detail-item">
                                        <span class="detail-label">–î–æ—Å—Ç–∞–≤–∫–∞ –ø–æ –†–§:</span>
                                        <span class="detail-value">{{ result.additional_costs.local_delivery_rub.toLocaleString() }} —Ä—É–± ({{ getPercentOfCost(result.additional_costs.local_delivery_rub, result.cost_price.total.rub) }}%)</span>
                                    </div>
                                    <div class="detail-item">
                                        <span class="detail-label">–ó–∞–±–æ—Ä –ú–°–ö:</span>
                                        <span class="detail-value">{{ result.additional_costs.msk_pickup_rub.toLocaleString() }} —Ä—É–± ({{ getPercentOfCost(result.additional_costs.msk_pickup_rub, result.cost_price.total.rub) }}%)</span>
                                    </div>
                                    <div class="detail-item">
                                        <span class="detail-label">–ü—Ä–æ—á–∏–µ —Ä–∞—Å—Ö–æ–¥—ã:</span>
                                        <span class="detail-value">{{ result.additional_costs.other_costs_rub.toLocaleString() }} —Ä—É–± ({{ getPercentOfCost(result.additional_costs.other_costs_rub, result.cost_price.total.rub) }}%)</span>
                                    </div>
                                    <div class="detail-item" style="border-top: 1px solid #e5e7eb; padding-top: 8px; margin-top: 8px;">
                                        <span class="detail-label"><strong>–ù–∞—Ü–µ–Ω–∫–∞:</strong></span>
                                        <span class="detail-value"><strong>{{ ((result.markup - 1) * 100).toFixed(0) }}%</strong></span>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Product URL -->
                            <div v-if="result.product_url" style="margin-top: 16px; padding-top: 16px; border-top: 1px solid #e5e7eb;">
                                <a :href="result.product_url" target="_blank" 
                                   style="color: #2563eb; text-decoration: none;">
                                    ‚Üí –û—Ç–∫—Ä—ã—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É —Ç–æ–≤–∞—Ä–∞
                                </a>
                            </div>
                        </div>
                    </div>
                </transition>
            </div>
            
            <!-- History Tab -->
            <div v-if="activeTab === 'history'">
                <div class="card">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px;">
                        <div>
                            <h2 class="card-title" style="margin-bottom: 0;">–ò—Å—Ç–æ—Ä–∏—è —Ä–∞—Å—á–µ—Ç–æ–≤</h2>
                            <p class="card-subtitle" style="margin-bottom: 0;">–í—Å–µ –≤–∞—à–∏ —Ä–∞—Å—á–µ—Ç—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏</p>
                        </div>
                        <button @click="loadHistory" class="refresh-button">
                            –û–±–Ω–æ–≤–∏—Ç—å
                        </button>
                    </div>
                    
                    <!-- Database Status Warning -->
                    <div v-if="!databaseAvailable" class="warning-message" style="background: #fef3cd; border: 1px solid #fde68a; color: #92400e; padding: 16px; border-radius: 8px; margin-bottom: 20px; display: flex; align-items: center; gap: 12px;">
                        <span style="font-size: 20px;">‚ö†Ô∏è</span>
                        <div>
                            <div style="font-weight: 600; margin-bottom: 4px;">–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞</div>
                            <div style="font-size: 14px;">–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç, –Ω–æ –∏—Å—Ç–æ—Ä–∏—è —Ä–∞—Å—á–µ—Ç–æ–≤ –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞. –í–∞—à–∏ —Ä–∞—Å—á–µ—Ç—ã –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è.</div>
                        </div>
                    </div>
                    
                    <div v-if="history.length === 0 && databaseAvailable" class="empty-state">
                        <div class="empty-icon">üìã</div>
                        <h3 style="font-size: 18px; color: #1f2937; margin-bottom: 8px;">–ü–æ–∫–∞ –Ω–µ—Ç —Ä–∞—Å—á–µ—Ç–æ–≤</h3>
                        <p style="color: #6b7280; margin-bottom: 16px;">–°–æ–∑–¥–∞–π—Ç–µ –ø–µ—Ä–≤—ã–π —Ä–∞—Å—á–µ—Ç –≤–æ –≤–∫–ª–∞–¥–∫–µ "–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä"</p>
                        <button @click="activeTab = 'calculator'" class="nav-button active">
                            –°–æ–∑–¥–∞—Ç—å —Ä–∞—Å—á–µ—Ç
                        </button>
                    </div>
                    
                    <div v-else class="history">
                        <div v-for="item in history" :key="item.id" class="history-item" @click="toggleHistoryDetails(item.id)">
                            <!-- –ö—Ä–∞—Ç–∫–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è (–≤—Å–µ–≥–¥–∞ –≤–∏–¥–Ω–∞) -->
                            <div class="history-summary">
                                <div class="history-main-info">
                                    <h3>
                                        {{ item.product_name }}
                                        <span class="history-expand-icon" :class="{ expanded: expandedHistory.includes(item.id) }">
                                            ‚ñº
                                        </span>
                                    </h3>
                                    <p>{{ formatDate(item.created_at) }}</p>
                                    <p v-if="item.product_url" style="color: #3b82f6;">
                                        <a :href="item.product_url" target="_blank" @click.stop style="text-decoration: none; color: inherit;">
                                            ‚Üí –°—Å—ã–ª–∫–∞ –Ω–∞ —Ç–æ–≤–∞—Ä
                                        </a>
                                    </p>
                                </div>
                                <div class="history-prices">
                                    <div class="history-yuan-price">{{ item.price_yuan }}¬• √ó {{ item.quantity }}—à—Ç</div>
                                    <div class="history-unit-price"><strong>{{ (item.sale_price_rub / item.quantity).toFixed(0) }}</strong> ‚ÇΩ/—à—Ç</div>
                                </div>
                            </div>
                            
                            <!-- –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è (—Ä–∞—Å–∫—Ä—ã–≤–∞–µ—Ç—Å—è –ø–æ –∫–ª–∏–∫—É) -->
                            <div v-if="expandedHistory.includes(item.id)" class="history-details">
                                <div class="grid" style="grid-template-columns: repeat(2, 1fr); gap: 16px; margin-bottom: 16px;">
                                    <div>
                                        <div style="font-weight: 600; color: #374151; margin-bottom: 8px;">–ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Ç–æ–≤–∞—Ä–∞</div>
                                        <div style="font-size: 14px; color: #6b7280; line-height: 1.5;">
                                            <div><strong>–ö–∞—Ç–µ–≥–æ—Ä–∏—è:</strong> {{ item.category }}</div>
                                            <div><strong>–í–µ—Å:</strong> {{ item.weight_kg }} –∫–≥</div>
                                            <div><strong>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ:</strong> {{ item.quantity }} —à—Ç</div>
                                            <div><strong>–ù–∞—Ü–µ–Ω–∫–∞:</strong> √ó {{ item.markup }} ({{ ((item.markup - 1) * 100).toFixed(0) }}%)</div>
                                            <div v-if="item.custom_rate"><strong>–õ–æ–≥–∏—Å—Ç–∏—á–µ—Å–∫–∞—è —Å—Ç–∞–≤–∫–∞:</strong> ${{ item.custom_rate }}/–∫–≥</div>
                                        </div>
                                    </div>
                                    <div>
                                        <div style="font-weight: 600; color: #374151; margin-bottom: 8px;">–†–∞—Å—á–µ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏</div>
                                        <div style="font-size: 14px; color: #6b7280; line-height: 1.5;">
                                            <div><strong>–°–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å:</strong> {{ item.cost_price_rub.toLocaleString() }} ‚ÇΩ</div>
                                            <div><strong>–¶–µ–Ω–∞ –ø—Ä–æ–¥–∞–∂–∏:</strong> {{ item.sale_price_rub.toLocaleString() }} ‚ÇΩ</div>
                                            <div><strong>–ü—Ä–∏–±—ã–ª—å:</strong> {{ item.profit_rub.toLocaleString() }} ‚ÇΩ</div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="history-actions" @click.stop>
                                    <button @click="editCalculation(item)" class="btn btn-secondary btn-sm">
                                        ‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
                                    </button>
                                    <button @click="copyCalculation(item)" class="btn btn-secondary btn-sm">
                                        üìã –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- üöÄ –ú–û–î–£–õ–¨–ù–´–ô JAVASCRIPT - –§–ê–ó–ê 2.2 -->
    <!-- –ü–æ—Ä—è–¥–æ–∫ –∑–∞–≥—Ä—É–∑–∫–∏ –ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ï–ù! -->
    <script src="/static/js/app-config.js"></script>
    <script src="/static/js/api-service.js"></script>
    <script src="/static/js/utils.js"></script>
    <script src="/static/js/form-handlers.js"></script>
    <script src="/static/js/history-handlers.js"></script>
    <script src="/static/js/main-app.js"></script>
</body>
</html>
