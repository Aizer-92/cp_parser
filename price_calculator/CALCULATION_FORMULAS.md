# üìê –§–æ—Ä–º—É–ª—ã —Ä–∞—Å—á–µ—Ç–∞ —Å—Ç–æ–∏–º–æ—Å—Ç–∏ —Ç–æ–≤–∞—Ä–æ–≤

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 08.10.2025
**–í–µ—Ä—Å–∏—è:** 2.0
**–°—Ç–∞—Ç—É—Å:** –ê–∫—Ç—É–∞–ª—å–Ω–æ

---

## üéØ –û–±—â–∞—è –∫–æ–Ω—Ü–µ–ø—Ü–∏—è

–°–∏—Å—Ç–µ–º–∞ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç —Å–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å —Ç–æ–≤–∞—Ä–∞ –ø–æ 4 –º–∞—Ä—à—Ä—É—Ç–∞–º –ª–æ–≥–∏—Å—Ç–∏–∫–∏:

1. **Highway –ñ–î** - –∂–µ–ª–µ–∑–Ω–æ–¥–æ—Ä–æ–∂–Ω–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞
2. **Highway –ê–≤–∏–∞** - –∞–≤–∏–∞ –¥–æ—Å—Ç–∞–≤–∫–∞
3. **Highway –ø–æ–¥ –∫–æ–Ω—Ç—Ä–∞–∫—Ç** - —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å—Ç–∞–≤–∫–∏ —Å –ø–æ—à–ª–∏–Ω–∞–º–∏
4. **Prologix** - —Ä–∞—Å—á–µ—Ç –ø–æ –∫—É–±–æ–º–µ—Ç—Ä–∞–º

---

## üí∞ –ë–∞–∑–æ–≤—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ

### –ö—É—Ä—Å—ã –≤–∞–ª—é—Ç

- `yuan_to_usd` = 0.139
- `usd_to_rub` = 85
- `yuan_to_rub` = 11.68

### –ö–æ–º–∏—Å—Å–∏–∏

- `toni_commission` = 5% (–ø–æ—à–ª–∏–Ω–∞ –∑–∞ –≤—ã–∫—É–ø)
- `transfer_commission` = 18% (–∫–æ–º–∏—Å—Å–∏—è –∑–∞ –ø–µ—Ä–µ–≤–æ–¥, —Ç–æ–ª—å–∫–æ –¥–ª—è Highway –ñ–î/–ê–≤–∏–∞)

### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã

- `local_delivery` = 2 —é–∞–Ω–µ–π/–∫–≥ (–ª–æ–∫–∞–ª—å–Ω–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞ –≤ –ö–∏—Ç–∞–µ)
- `msk_pickup` = 1000 —Ä—É–± (–∑–∞–±–æ—Ä –≤ –ú–æ—Å–∫–≤–µ –Ω–∞ –≤–µ—Å—å —Ç–∏—Ä–∞–∂)
- `other_costs` = 2.5% –æ—Ç (—Ü–µ–Ω–∞ —Ç–æ–≤–∞—Ä–∞ + –ª–æ–∫–∞–ª—å–Ω–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞)

---

## üöÇ Highway –ñ–î / ‚úàÔ∏è Highway –ê–≤–∏–∞

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∑–∞—Ç—Ä–∞—Ç (–∑–∞ 1 —à—Ç):

```
–°—Ç–æ–∏–º–æ—Å—Ç—å –≤ –ö–∏—Ç–∞–µ:
‚îú‚îÄ –¶–µ–Ω–∞ –≤ —é–∞–Ω—è—Ö (–±–∞–∑–æ–≤–∞—è)
‚îú‚îÄ –ü–æ—à–ª–∏–Ω–∞ –∑–∞ –≤—ã–∫—É–ø (5%)
‚îú‚îÄ –ö–æ–º–∏—Å—Å–∏—è –∑–∞ –ø–µ—Ä–µ–≤–æ–¥ (18%)
‚îî‚îÄ –õ–æ–∫–∞–ª—å–Ω–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞

–õ–æ–≥–∏—Å—Ç–∏–∫–∞:
‚îî‚îÄ –æ–±—â–∏–π_–≤–µ—Å √ó (–±–∞–∑–æ–≤–∞—è_—Å—Ç–∞–≤–∫–∞ + –Ω–∞–¥–±–∞–≤–∫–∞_–∑–∞_–ø–ª–æ—Ç–Ω–æ—Å—Ç—å)

–ü—Ä–æ—á–∏–µ —Ä–∞—Å—Ö–æ–¥—ã:
‚îú‚îÄ –ó–∞–±–æ—Ä –ú–°–ö (—Ñ–∏–∫—Å)
‚îî‚îÄ –ü—Ä–æ—á–∏–µ —Ä–∞—Å—Ö–æ–¥—ã (2.5%)
```

### –§–æ—Ä–º—É–ª–∞ –ø–æ–ª–Ω–∞—è:

```python
# 1. –°—Ç–æ–∏–º–æ—Å—Ç—å —Ç–æ–≤–∞—Ä–∞ —Å –∫–æ–º–∏—Å—Å–∏—è–º–∏
base_price_rub = price_yuan * yuan_to_rub
toni_commission_rub = base_price_rub * 0.05
transfer_commission_rub = (base_price_rub + toni_commission_rub) * 0.18
factory_price = base_price_rub + toni_commission_rub + transfer_commission_rub

# 2. –õ–æ–∫–∞–ª—å–Ω–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞
local_delivery = local_delivery_yuan_per_kg * weight_kg * yuan_to_rub

# 3. –õ–æ–≥–∏—Å—Ç–∏–∫–∞
# 3.1 –ë–∞–∑–æ–≤–∞—è —Å—Ç–∞–≤–∫–∞ (–∏–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ç–æ–≤–∞—Ä–∞)
base_rate_rail = category["rates"]["rail_base"]  # –Ω–∞–ø—Ä–∏–º–µ—Ä, 7.5 $/–∫–≥
base_rate_air = category["rates"]["air_base"]    # –Ω–∞–ø—Ä–∏–º–µ—Ä, 9.6 $/–∫–≥ (rail + 2.1)

# 3.2 –ù–∞–¥–±–∞–≤–∫–∞ –∑–∞ –ø–ª–æ—Ç–Ω–æ—Å—Ç—å (–µ—Å–ª–∏ density < –ø–æ—Ä–æ–≥)
density_kg_m3 = packing_box_weight / (length * width * height)
density_surcharge_usd = get_density_surcharge(density_kg_m3, delivery_type)

# 3.3 –ò—Ç–æ–≥–æ–≤–∞—è –ª–æ–≥–∏—Å—Ç–∏–∫–∞
logistics_rate = base_rate + density_surcharge
logistics_cost = weight_kg * logistics_rate * usd_to_rub

# 4. –ü—Ä–æ—á–∏–µ —Ä–∞—Å—Ö–æ–¥—ã
msk_pickup = 1000 / quantity  # –Ω–∞ –µ–¥–∏–Ω–∏—Ü—É
other_costs = (factory_price + local_delivery) * 0.025

# 5. –ò–¢–û–ì–û —Å–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å –∑–∞ 1 —à—Ç
cost_per_unit = factory_price + local_delivery + logistics_cost + msk_pickup + other_costs
```

### –û—Ç–ª–∏—á–∏–µ –ê–≤–∏–∞ –æ—Ç –ñ–î:

```python
# –ê–≤–∏–∞ = –ñ–î + 2.1 $/–∫–≥
air_base_rate = rail_base_rate + 2.1
```

---

## üì¶ Highway –ø–æ–¥ –∫–æ–Ω—Ç—Ä–∞–∫—Ç

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∑–∞—Ç—Ä–∞—Ç (–∑–∞ 1 —à—Ç):

```
–°—Ç–æ–∏–º–æ—Å—Ç—å –≤ –ö–∏—Ç–∞–µ:
‚îú‚îÄ –¶–µ–Ω–∞ –≤ —é–∞–Ω—è—Ö (–±–∞–∑–æ–≤–∞—è)
‚îú‚îÄ –ü–æ—à–ª–∏–Ω–∞ –∑–∞ –≤—ã–∫—É–ø (5%)
‚îî‚îÄ –õ–æ–∫–∞–ª—å–Ω–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞

–õ–æ–≥–∏—Å—Ç–∏–∫–∞:
‚îú‚îÄ –æ–±—â–∏–π_–≤–µ—Å √ó (—Å—Ç–∞–≤–∫–∞_–∫–æ–Ω—Ç—Ä–∞–∫—Ç + –Ω–∞–¥–±–∞–≤–∫–∞_–∑–∞_–ø–ª–æ—Ç–Ω–æ—Å—Ç—å)
‚îú‚îÄ –ü–æ—à–ª–∏–Ω—ã (—Ç–∞–º–æ–∂–µ–Ω–Ω–∞—è_—Å—Ç–æ–∏–º–æ—Å—Ç—å √ó duty_rate)
‚îî‚îÄ –ù–î–° ((—Ç–∞–º–æ–∂–µ–Ω–Ω–∞—è_—Å—Ç–æ–∏–º–æ—Å—Ç—å + –ø–æ—à–ª–∏–Ω—ã) √ó vat_rate)

–ü—Ä–æ—á–∏–µ —Ä–∞—Å—Ö–æ–¥—ã:
‚îú‚îÄ –ó–∞–±–æ—Ä –ú–°–ö (—Ñ–∏–∫—Å)
‚îú‚îÄ –ü—Ä–æ—á–∏–µ —Ä–∞—Å—Ö–æ–¥—ã (2.5%)
‚îî‚îÄ –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã (25,000 —Ä—É–±)
```

**–¢–∞–º–æ–∂–µ–Ω–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å** = —Ç–æ–≤–∞—Ä + –ª–æ–∫–∞–ª—å–Ω–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞ + –ª–æ–≥–∏—Å—Ç–∏–∫–∞

### –§–æ—Ä–º—É–ª–∞ –ø–æ–ª–Ω–∞—è:

```python
# 1. –°—Ç–æ–∏–º–æ—Å—Ç—å —Ç–æ–≤–∞—Ä–∞ (–ë–ï–ó –∫–æ–º–∏—Å—Å–∏–∏ –∑–∞ –ø–µ—Ä–µ–≤–æ–¥ 18%)
base_price_rub = price_yuan * yuan_to_rub
toni_commission_rub = base_price_rub * 0.05
factory_price = base_price_rub + toni_commission_rub

# 2. –õ–æ–∫–∞–ª—å–Ω–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞
local_delivery = local_delivery_yuan_per_kg * weight_kg * yuan_to_rub

# 3. –õ–æ–≥–∏—Å—Ç–∏–∫–∞ –ø–æ–¥ –∫–æ–Ω—Ç—Ä–∞–∫—Ç
# 3.1 –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å—Ç–∞–≤–∫–∏
contract_base_rate = 3.4  # $/–∫–≥ –¥–ª—è –ñ–î (5.5 –¥–ª—è –∞–≤–∏–∞)

# 3.2 –ù–∞–¥–±–∞–≤–∫–∞ –∑–∞ –ø–ª–æ—Ç–Ω–æ—Å—Ç—å
density_surcharge = get_density_surcharge(density_kg_m3, delivery_type)

# 3.3 –ò—Ç–æ–≥–æ–≤–∞—è –ª–æ–≥–∏—Å—Ç–∏–∫–∞
contract_logistics_rate = contract_base_rate + density_surcharge
contract_logistics_cost = weight_kg * contract_logistics_rate * usd_to_rub

# 4. –ü–æ—à–ª–∏–Ω—ã –∏ –ù–î–°
# –í–ê–ñ–ù–û: –ü–æ—à–ª–∏–Ω—ã –∏ –ù–î–° —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –æ—Ç —Ç–∞–º–æ–∂–µ–Ω–Ω–æ–π —Å—Ç–æ–∏–º–æ—Å—Ç–∏
# –Ω–æ –≤ —Ç–µ–∫—É—â–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –≤–∫–ª—é—á–µ–Ω—ã –≤ –æ–±—â—É—é —Å—Ç–æ–∏–º–æ—Å—Ç—å
duty_rate = category["duty_rate"]  # –Ω–∞–ø—Ä–∏–º–µ—Ä, 10%
vat_rate = category["vat_rate"]    # –Ω–∞–ø—Ä–∏–º–µ—Ä, 20%

# 5. –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã
fixed_cost = 25000 / quantity  # 25,000 —Ä—É–± –Ω–∞ –≤–µ—Å—å —Ç–∏—Ä–∞–∂

# 6. –ü—Ä–æ—á–∏–µ —Ä–∞—Å—Ö–æ–¥—ã
msk_pickup = 1000 / quantity
other_costs = (factory_price + local_delivery) * 0.025

# 7. –ò–¢–û–ì–û —Å–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å –∑–∞ 1 —à—Ç
cost_per_unit = (
    factory_price + 
    local_delivery + 
    contract_logistics_cost + 
    msk_pickup + 
    other_costs + 
    fixed_cost
)
```

### –ö–ª—é—á–µ–≤—ã–µ –æ—Ç–ª–∏—á–∏—è –æ—Ç Highway –ñ–î/–ê–≤–∏–∞:

- ‚ùå **–ù–ï–¢** –∫–æ–º–∏—Å—Å–∏–∏ –∑–∞ –ø–µ—Ä–µ–≤–æ–¥ 18%
- ‚úÖ **–ï–°–¢–¨** —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å—Ç–∞–≤–∫–∏ –ª–æ–≥–∏—Å—Ç–∏–∫–∏ (3.4 –∏–ª–∏ 5.5 $/–∫–≥)
- ‚úÖ **–ï–°–¢–¨** —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã 25,000 —Ä—É–±
- ‚úÖ **–ï–°–¢–¨** –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ—à–ª–∏–Ω–∞—Ö –∏ –ù–î–° (–æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è —Å–ø—Ä–∞–≤–æ—á–Ω–æ)

---

## üöö Prologix

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∑–∞—Ç—Ä–∞—Ç (–∑–∞ 1 —à—Ç):

```
–°—Ç–æ–∏–º–æ—Å—Ç—å –≤ –ö–∏—Ç–∞–µ:
‚îú‚îÄ –¶–µ–Ω–∞ –≤ —é–∞–Ω—è—Ö (–±–∞–∑–æ–≤–∞—è)
‚îú‚îÄ –ü–æ—à–ª–∏–Ω–∞ –∑–∞ –≤—ã–∫—É–ø (5%)
‚îî‚îÄ –õ–æ–∫–∞–ª—å–Ω–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞

–õ–æ–≥–∏—Å—Ç–∏–∫–∞:
‚îú‚îÄ –æ–±—â–∏–π_–æ–±—ä–µ–º √ó —Å—Ç–∞–≤–∫–∞_prologix (—Ä—É–±/–º¬≥)
‚îú‚îÄ –ü–æ—à–ª–∏–Ω—ã (—Ç–∞–º–æ–∂–µ–Ω–Ω–∞—è_—Å—Ç–æ–∏–º–æ—Å—Ç—å √ó duty_rate)
‚îî‚îÄ –ù–î–° ((—Ç–∞–º–æ–∂–µ–Ω–Ω–∞—è_—Å—Ç–æ–∏–º–æ—Å—Ç—å + –ø–æ—à–ª–∏–Ω—ã) √ó vat_rate)

–ü—Ä–æ—á–∏–µ —Ä–∞—Å—Ö–æ–¥—ã:
‚îú‚îÄ –ó–∞–±–æ—Ä –ú–°–ö (—Ñ–∏–∫—Å)
‚îú‚îÄ –ü—Ä–æ—á–∏–µ —Ä–∞—Å—Ö–æ–¥—ã (2.5%)
‚îî‚îÄ –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã (25,000 —Ä—É–±)
```

**–¢–∞–º–æ–∂–µ–Ω–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å** = —Ç–æ–≤–∞—Ä + –ª–æ–∫–∞–ª—å–Ω–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞ + –ª–æ–≥–∏—Å—Ç–∏–∫–∞

### –§–æ—Ä–º—É–ª–∞ –ø–æ–ª–Ω–∞—è:

```python
# 1. –°—Ç–æ–∏–º–æ—Å—Ç—å —Ç–æ–≤–∞—Ä–∞ (–ë–ï–ó –∫–æ–º–∏—Å—Å–∏–∏ –∑–∞ –ø–µ—Ä–µ–≤–æ–¥ 18%)
base_price_rub = price_yuan * yuan_to_rub
toni_commission_rub = base_price_rub * 0.05
factory_price = base_price_rub + toni_commission_rub

# 2. –õ–æ–∫–∞–ª—å–Ω–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞
local_delivery = local_delivery_yuan_per_kg * weight_kg * yuan_to_rub

# 3. –õ–æ–≥–∏—Å—Ç–∏–∫–∞ Prologix (–ø–æ –∫—É–±–æ–º–µ—Ç—Ä–∞–º)
# 3.1 –†–∞—Å—á–µ—Ç –æ–±—â–µ–≥–æ –æ–±—ä–µ–º–∞
box_volume_m3 = length * width * height  # —Ä–∞–∑–º–µ—Ä—ã –≤ –º–µ—Ç—Ä–∞—Ö!
boxes_count = quantity / packing_units_per_box
total_volume_m3 = box_volume_m3 * boxes_count

# 3.2 –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å—Ç–∞–≤–∫–∏ –ø–æ —Ç–∞—Ä–∏—Ñ–Ω–æ–π —Å–µ—Ç–∫–µ
if 2 <= total_volume_m3 < 8:
    rate_rub_per_m3 = 41000
elif 8 <= total_volume_m3 < 20:
    rate_rub_per_m3 = 20000
elif 20 <= total_volume_m3 < 30:
    rate_rub_per_m3 = 15000
elif total_volume_m3 >= 30:
    rate_rub_per_m3 = 13000

# 3.3 –ò—Ç–æ–≥–æ–≤–∞—è –ª–æ–≥–∏—Å—Ç–∏–∫–∞
prologix_logistics_cost = total_volume_m3 * rate_rub_per_m3

# 4. –ü–æ—à–ª–∏–Ω—ã –∏ –ù–î–°
duty_rate = category["duty_rate"]  # –Ω–∞–ø—Ä–∏–º–µ—Ä, 10%
vat_rate = category["vat_rate"]    # –Ω–∞–ø—Ä–∏–º–µ—Ä, 20%

# 5. –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã
fixed_cost = 25000 / quantity

# 6. –ü—Ä–æ—á–∏–µ —Ä–∞—Å—Ö–æ–¥—ã
msk_pickup = 1000 / quantity
other_costs = (factory_price + local_delivery) * 0.025

# 7. –ò–¢–û–ì–û —Å–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å –∑–∞ 1 —à—Ç
cost_per_unit = (
    factory_price + 
    local_delivery + 
    prologix_logistics_cost / quantity +
    msk_pickup + 
    other_costs + 
    fixed_cost
)
```

### –¢–∞—Ä–∏—Ñ–Ω–∞—è —Å–µ—Ç–∫–∞ Prologix:

| –û–±—ä–µ–º (–º¬≥) | –°—Ç–∞–≤–∫–∞ (—Ä—É–±/–º¬≥) | –°—Ä–æ–∫ –¥–æ—Å—Ç–∞–≤–∫–∏ |
| ----------------- | -------------------------- | ------------------------- |
| 2-8               | 41,000                     | 25-35 –¥–Ω–µ–π            |
| 8-20              | 20,000                     | 25-35 –¥–Ω–µ–π            |
| 20-30             | 15,000                     | 25-35 –¥–Ω–µ–π            |
| 30+               | 13,000                     | 25-35 –¥–Ω–µ–π            |

---

## üìä –ù–∞–¥–±–∞–≤–∫–∞ –∑–∞ –ø–ª–æ—Ç–Ω–æ—Å—Ç—å

### –õ–æ–≥–∏–∫–∞:

–ï—Å–ª–∏ –ø–ª–æ—Ç–Ω–æ—Å—Ç—å —Ç–æ–≤–∞—Ä–∞ **–Ω–∏–∂–µ** –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ –ø–æ—Ä–æ–≥–∞, –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –Ω–∞–¥–±–∞–≤–∫–∞ –∫ –ª–æ–≥–∏—Å—Ç–∏—á–µ—Å–∫–æ–π —Å—Ç–∞–≤–∫–µ.

### –ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö:

`config/density_surcharges.yaml`

### –ü—Ä–∏–º–µ—Ä —Å—Ç—Ä—É–∫—Ç—É—Ä—ã:

```yaml
rail:  # –ñ–î –¥–æ—Å—Ç–∞–≤–∫–∞
  - density: 50    # –∫–≥/–º¬≥
    surcharge: 2.5 # $/–∫–≥
  - density: 100
    surcharge: 1.8
  - density: 150
    surcharge: 1.2
  - density: 200
    surcharge: 0.5
  - density: 250
    surcharge: 0.0

air:   # –ê–≤–∏–∞ –¥–æ—Å—Ç–∞–≤–∫–∞
  - density: 50
    surcharge: 3.2
  - density: 100
    surcharge: 2.3
  - density: 150
    surcharge: 1.5
  - density: 200
    surcharge: 0.8
  - density: 250
    surcharge: 0.0
```

### –ê–ª–≥–æ—Ä–∏—Ç–º —Ä–∞—Å—á–µ—Ç–∞:

```python
def get_density_surcharge(density_kg_m3, delivery_type):
    """
    –õ–∏–Ω–µ–π–Ω–∞—è –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏—è –º–µ–∂–¥—É —Ç–æ—á–∫–∞–º–∏
    """
    surcharge_data = load_yaml("density_surcharges.yaml")[delivery_type]
  
    # –ï—Å–ª–∏ –ø–ª–æ—Ç–Ω–æ—Å—Ç—å >= –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π, –Ω–∞–¥–±–∞–≤–∫–∞ = 0
    if density_kg_m3 >= surcharge_data[-1]["density"]:
        return 0.0
  
    # –ï—Å–ª–∏ –ø–ª–æ—Ç–Ω–æ—Å—Ç—å <= –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π, –∏—Å–ø–æ–ª—å–∑—É–µ–º –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é –Ω–∞–¥–±–∞–≤–∫—É
    if density_kg_m3 <= surcharge_data[0]["density"]:
        return surcharge_data[0]["surcharge"]
  
    # –õ–∏–Ω–µ–π–Ω–∞—è –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏—è –º–µ–∂–¥—É –±–ª–∏–∂–∞–π—à–∏–º–∏ —Ç–æ—á–∫–∞–º–∏
    for i in range(len(surcharge_data) - 1):
        d1 = surcharge_data[i]["density"]
        s1 = surcharge_data[i]["surcharge"]
        d2 = surcharge_data[i+1]["density"]
        s2 = surcharge_data[i+1]["surcharge"]
      
        if d1 <= density_kg_m3 <= d2:
            # –õ–∏–Ω–µ–π–Ω–∞—è –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏—è
            ratio = (density_kg_m3 - d1) / (d2 - d1)
            return s1 + (s2 - s1) * ratio
  
    return 0.0
```

---

## üé® –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ UI (V2)

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–ª–æ–∫–æ–≤:

```
–°—Ç–æ–∏–º–æ—Å—Ç—å –≤ –ö–∏—Ç–∞–µ (XX.X%)
‚îú‚îÄ –¶–µ–Ω–∞ –≤ —é–∞–Ω—è—Ö ‚Üí X.XX ¬• = XXX.XX ‚ÇΩ
‚îú‚îÄ –ü–æ—à–ª–∏–Ω–∞ –∑–∞ –≤—ã–∫—É–ø (5%) ‚Üí XXX.XX ‚ÇΩ
‚îú‚îÄ –ö–æ–º–∏—Å—Å–∏—è –∑–∞ –ø–µ—Ä–µ–≤–æ–¥ (18%) ‚Üí XXX.XX ‚ÇΩ  [—Ç–æ–ª—å–∫–æ –ñ–î/–ê–≤–∏–∞]
‚îî‚îÄ –õ–æ–∫–∞–ª—å–Ω–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞ ‚Üí XXX.XX ‚ÇΩ

–õ–æ–≥–∏—Å—Ç–∏–∫–∞ (XX.X%)
‚îú‚îÄ [–ñ–î/–ê–≤–∏–∞] XXX.X –∫–≥ √ó Y.YY $/–∫–≥ ‚Üí XXX.XX ‚ÇΩ
‚îú‚îÄ [–ö–æ–Ω—Ç—Ä–∞–∫—Ç] XXX.X –∫–≥ √ó Y.YY $/–∫–≥ ‚Üí XXX.XX ‚ÇΩ
‚îú‚îÄ [Prologix] XX.X –º¬≥ √ó YYY ‚ÇΩ/–º¬≥ ‚Üí XXX.XX ‚ÇΩ
‚îî‚îÄ [–ö–æ–Ω—Ç—Ä–∞–∫—Ç/Prologix] –ü–æ—à–ª–∏–Ω—ã + –ù–î–° (XX% + XX%)

–ü—Ä–æ—á–∏–µ —Ä–∞—Å—Ö–æ–¥—ã (XX.X%)
‚îú‚îÄ –ó–∞–±–æ—Ä –ú–°–ö ‚Üí XXX.XX ‚ÇΩ
‚îú‚îÄ –ü—Ä–æ—á–∏–µ (2.5%) ‚Üí XXX.XX ‚ÇΩ
‚îî‚îÄ –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã ‚Üí XXX.XX ‚ÇΩ  [—Ç–æ–ª—å–∫–æ –ö–æ–Ω—Ç—Ä–∞–∫—Ç/Prologix]
```

---

## üîÑ –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π

### v2.0 (08.10.2025)

- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è –∑–∞—Ç—Ä–∞—Ç –≤ breakdown
- ‚úÖ –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ Highway –ñ–î/–ê–≤–∏–∞ –æ—Ç –ö–æ–Ω—Ç—Ä–∞–∫—Ç–∞ –∏ Prologix
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –ø—Ä–æ—Ü–µ–Ω—Ç—ã –æ—Ç –æ–±—â–µ–π —Å–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç–∏
- ‚úÖ –û–±—â–∏–π –≤–µ—Å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –≤ –ª–æ–≥–∏—Å—Ç–∏–∫–µ

### v1.0 (06.10.2025)

- ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –Ω–∞–¥–±–∞–≤–∫–∏ –∑–∞ –ø–ª–æ—Ç–Ω–æ—Å—Ç—å
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω Prologix —Å —Ä–∞—Å—á–µ—Ç–æ–º –ø–æ –∫—É–±–æ–º–µ—Ç—Ä–∞–º
- ‚úÖ Highway –ø–æ–¥ –∫–æ–Ω—Ç—Ä–∞–∫—Ç —Å —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ —Å—Ç–∞–≤–∫–∞–º–∏

---

## ‚ö†Ô∏è –í–ê–ñ–ù–û!

### –ö–ª—é—á–µ–≤—ã–µ —Ä–∞–∑–ª–∏—á–∏—è –º–∞—Ä—à—Ä—É—Ç–æ–≤:

| –ü–∞—Ä–∞–º–µ—Ç—Ä                          | Highway –ñ–î/–ê–≤–∏–∞         | Highway –ö–æ–Ω—Ç—Ä–∞–∫—Ç | Prologix                 |
| ----------------------------------------- | ----------------------------- | ------------------------ | ------------------------ |
| –ö–æ–º–∏—Å—Å–∏—è –ø–µ—Ä–µ–≤–æ–¥ (18%)     | ‚úÖ –î–ê                       | ‚ùå –ù–ï–¢                | ‚ùå –ù–ï–¢                |
| –†–∞—Å—á–µ—Ç –ª–æ–≥–∏—Å—Ç–∏–∫–∏           | –ü–æ –≤–µ—Å—É                 | –ü–æ –≤–µ—Å—É            | –ü–æ –æ–±—ä–µ–º—É        |
| –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã | ‚ùå –ù–ï–¢                     | ‚úÖ 25,000‚ÇΩ              | ‚úÖ 25,000‚ÇΩ              |
| –ü–æ—à–ª–∏–Ω—ã/–ù–î–°                     | –ù–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è | –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è | –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è |
| –ù–∞–¥–±–∞–≤–∫–∞ –∑–∞ –ø–ª–æ—Ç–Ω–æ—Å—Ç—å  | ‚úÖ –î–ê                       | ‚úÖ –î–ê                  | ‚ùå –ù–ï–¢                |

### –§–∞–π–ª—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:

- `config/currencies.yaml` - –∫—É—Ä—Å—ã –≤–∞–ª—é—Ç
- `config/density_surcharges.yaml` - –Ω–∞–¥–±–∞–≤–∫–∏ –∑–∞ –ø–ª–æ—Ç–Ω–æ—Å—Ç—å
- `config/prologix_rates.yaml` - —Ç–∞—Ä–∏—Ñ—ã Prologix
- `config/categories.yaml` - –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ç–æ–≤–∞—Ä–æ–≤ —Å —Å—Ç–∞–≤–∫–∞–º–∏

---

## üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã

–ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ñ–æ—Ä–º—É–ª –æ–±–Ω–æ–≤–ª—è—Ç—å:

1. **Backend:** `price_calculator.py` (–º–µ—Ç–æ–¥—ã `calculate_cost`, `calculate_prologix_cost`)
2. **Frontend:** `static/js/v2/RouteDetailsV2.js` (–æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ breakdown)
3. **–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç:** `CALCULATION_FORMULAS.md`

**–í–µ—Ä—Å–∏—è –∞–∫—Ç—É–∞–ª—å–Ω–∞ –Ω–∞:** 08.10.2025
