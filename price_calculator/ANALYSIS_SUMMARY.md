# üîç –ê–ù–ê–õ–ò–¢–ò–ß–ï–°–ö–ê–Ø –°–í–û–î–ö–ê: –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

**–î–∞—Ç–∞ –∞–Ω–∞–ª–∏–∑–∞:** 10.10.2025  
**–ü—Ä–æ–µ–∫—Ç:** Price Calculator  
**–í–µ—Ä—Å–∏—è:** 2.0 (—Å "–ù–æ–≤–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–µ–π" –∏ –∫–∞—Å—Ç–æ–º–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏)

---

## üìä –ú–ï–¢–†–ò–ö–ò –ü–†–û–ï–ö–¢–ê

### –†–∞–∑–º–µ—Ä –∫–æ–¥–æ–≤–æ–π –±–∞–∑—ã
```
price_calculator.py:  1,896 —Å—Ç—Ä–æ–∫  (–º–æ–Ω–æ–ª–∏—Ç —Ä–∞—Å—á—ë—Ç–æ–≤)
main.py:              2,122 —Å—Ç—Ä–æ–∫  (API + –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞)
database.py:            588 —Å—Ç—Ä–æ–∫  (—Ä–∞–±–æ—Ç–∞ —Å –ë–î)
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
–ò–¢–û–ì–û (—è–¥—Ä–æ):        4,606 —Å—Ç—Ä–æ–∫

Frontend (Vue.js):   ~3,000 —Å—Ç—Ä–æ–∫
–ö–æ–Ω—Ñ–∏–≥–∏ (YAML):        ~500 —Å—Ç—Ä–æ–∫
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
–í–°–ï–ì–û:              ~8,100 —Å—Ç—Ä–æ–∫
```

### –°–ª–æ–∂–Ω–æ—Å—Ç—å
- **–ú–∞—Ä—à—Ä—É—Ç—ã**: 5 (Highway –ñ–î, Highway –ê–≤–∏–∞, Highway –ö–æ–Ω—Ç—Ä–∞–∫—Ç, Prologix, Sea Container)
- **–ö–∞—Ç–µ–≥–æ—Ä–∏–∏**: 109 —Ç–æ–≤–∞—Ä–æ–≤ + 1 "–ù–æ–≤–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è"
- **–¢–∏–ø—ã –ø–æ—à–ª–∏–Ω**: 3 (–ø—Ä–æ—Ü–µ–Ω—Ç–Ω—ã–µ, –≤–µ—Å–æ–≤—ã–µ, –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ)
- **API endpoints**: 25+
- **–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π**: PostgreSQL, SQLite, FastAPI, Vue.js, Railway

---

## ‚ùå –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ü–†–û–ë–õ–ï–ú–´ (—Ç—Ä–µ–±—É—é—Ç –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è)

### 1. **–ö–∞—Å—Ç–æ–º–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ù–ï —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –ë–î**

**–û–ø–∏—Å–∞–Ω–∏–µ:**
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –º–∞—Ä—à—Ä—É—Ç–∞ –Ω–∞ –≠—Ç–∞–ø–µ 2
- –≠—Ç–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ö—Ä–∞–Ω—è—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ –ø–∞–º—è—Ç–∏ –±—Ä–∞—É–∑–µ—Ä–∞ (`this.customLogistics`)
- –ü—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã ‚Üí –ø–∞–º—è—Ç—å –æ—á–∏—â–∞–µ—Ç—Å—è ‚Üí –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ç–µ—Ä—è—é—Ç—Å—è
- –í –ë–î —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ ONE `custom_rate` (legacy –ø–æ–ª–µ –¥–ª—è Highway)

**–ü—Ä–∏–º–µ—Ä –ø–æ—Ç–µ—Ä–∏ –¥–∞–Ω–Ω—ã—Ö:**
```
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: –¢–æ–≤–∞—Ä "XYZ" ‚Üí "–ù–æ–≤–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è"
2. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: –í–≤–æ–¥–∏—Ç custom_rate=4 –¥–ª—è Highway –ñ–î
3. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: –í–≤–æ–¥–∏—Ç duty_rate=10% –¥–ª—è Prologix
4. –ù–∞–∂–∏–º–∞–µ—Ç "–†–∞—Å—Å—á–∏—Ç–∞—Ç—å" ‚Üí –°–æ—Ö—Ä–∞–Ω–µ–Ω–æ –≤ –ë–î
5. –û–±–Ω–æ–≤–ª—è–µ—Ç —Å—Ç—Ä–∞–Ω–∏—Ü—É ‚Üí –û—Ç–∫—Ä—ã–≤–∞–µ—Ç —Ä–∞—Å—á—ë—Ç –∏–∑ –∏—Å—Ç–æ—Ä–∏–∏
6. –†–ï–ó–£–õ–¨–¢–ê–¢: custom_logistics=null ‚Üí –¶–∏—Ñ—Ä—ã –ù–ï–ü–†–ê–í–ò–õ–¨–ù–´–ï
```

**–ó–∞—Ç—Ä–æ–Ω—É—Ç—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:**
- "–ù–æ–≤–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è" (–ø–æ–ª–Ω–æ—Å—Ç—å—é –Ω–µ—Ä–∞–±–æ—á–∞—è –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏)
- –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ª—é–±–æ–≥–æ —Ä–∞—Å—á—ë—Ç–∞ (–ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ç–µ—Ä—è—é—Ç—Å—è)
- –ò—Å—Ç–æ—Ä–∏—è —Ä–∞—Å—á—ë—Ç–æ–≤ (–ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–µ–≤–µ—Ä–Ω—ã–µ —Ü–µ–Ω—ã)

**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:**
- üî¥ **–í–´–°–û–ö–ò–ô**: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Ç–µ—Ä—è–µ—Ç –¥–æ–≤–µ—Ä–∏–µ –∫ —Å–∏—Å—Ç–µ–º–µ
- üî¥ **–í–´–°–û–ö–ò–ô**: –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏ —Ä–∞—Å—á—ë—Ç —á–µ—Ä–µ–∑ –Ω–µ–¥–µ–ª—é
- üü° **–°–†–ï–î–ù–ò–ô**: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∫–ª–∏–µ–Ω—Ç–æ–≤ —É—Å–ª–æ–∂–Ω—è–µ—Ç—Å—è

---

### 2. **–î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –≤ 2 –º–µ—Å—Ç–∞—Ö ‚Üí –≤—ã—Å–æ–∫–∏–π —Ä–∏—Å–∫ –æ—à–∏–±–æ–∫**

**–û–ø–∏—Å–∞–Ω–∏–µ:**
–í `main.py` –µ—Å—Ç—å 2 —Ñ—É–Ω–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã–∑—ã–≤–∞—é—Ç `calculate_cost()` —Å 15+ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏:
1. `_calculate_price_logic` (POST /api/v2/calculate) - —Å—Ç—Ä–æ–∫–∏ 1506-1525
2. `_update_calculation_logic` (PUT /api/v2/calculation/{id}) - —Å—Ç—Ä–æ–∫–∏ 1970-1989

**–ü—Ä–æ–±–ª–µ–º–∞:**
```python
# –í _calculate_price_logic (POST)
result = calc.calculate_cost(
    price_yuan=request.price_yuan,
    weight_kg=calculated_weight_kg,
    quantity=request.quantity,
    # ... 15+ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ ...
    custom_logistics_params=request.custom_logistics,  # ‚úÖ –ï–°–¢–¨
    forced_category=request.forced_category            # ‚úÖ –ï–°–¢–¨
)

# –í _update_calculation_logic (PUT)
result = calculator.calculate_cost(
    product_name=request.product_name,
    price_yuan=request.price_yuan,
    weight_kg=request.weight_kg,
    # ... 15+ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ ...
    custom_logistics_params=request.custom_logistics,  # –¢–û–õ–¨–ö–û –ß–¢–û –î–û–ë–ê–í–ò–õ–ò! (–±—ã–ª–æ –∑–∞–±—ã—Ç–æ)
    forced_category=request.forced_category            # –¢–û–õ–¨–ö–û –ß–¢–û –î–û–ë–ê–í–ò–õ–ò! (–±—ã–ª–æ –∑–∞–±—ã—Ç–æ)
)
```

**–†–µ–∞–ª—å–Ω—ã–π —Å–ª—É—á–∞–π:**
- 9 –æ–∫—Ç—è–±—Ä—è 2025: –ó–∞–±—ã–ª–∏ –¥–æ–±–∞–≤–∏—Ç—å `custom_logistics` –≤ PUT endpoint
- –†–µ–∑—É–ª—å—Ç–∞—Ç: 3 —á–∞—Å–∞ –æ—Ç–ª–∞–¥–∫–∏ "–ø–æ—á–µ–º—É —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç"
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: "–Ω–µ –º–µ–Ω—è–µ—Ç—Å—è —Ä–∞—Å—á–µ—Ç –ø–æ—Å–ª–µ –≤–≤–µ–¥–µ–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏–π –ø—É—Å—Ç—ã—Ö"

**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:**
- üî¥ **–í–´–°–û–ö–ò–ô**: –ü—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –Ω–æ–≤–æ–≥–æ –ø–æ–ª—è –Ω–∞–¥–æ –æ–±–Ω–æ–≤–ª—è—Ç—å 2 –º–µ—Å—Ç–∞
- üü° **–°–†–ï–î–ù–ò–ô**: –õ–µ–≥–∫–æ –∑–∞–±—ã—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä ‚Üí –±–∞–≥ –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ
- üü° **–°–†–ï–î–ù–ò–ô**: –£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –≤—Ä–µ–º—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –Ω–æ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π

---

### 3. **"–ù–æ–≤–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è" —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –≤ —Ä–∞–º–∫–∞—Ö –æ–¥–Ω–æ–π —Å–µ—Å—Å–∏–∏**

**–û–ø–∏—Å–∞–Ω–∏–µ:**
"–ù–æ–≤–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è" —Å–æ–∑–¥–∞–Ω–∞ –¥–ª—è —Ç–æ–≤–∞—Ä–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ —Å–∏—Å—Ç–µ–º–∞ –Ω–µ –º–æ–∂–µ—Ç —Ä–∞—Å–ø–æ–∑–Ω–∞—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–ª–∂–µ–Ω –≤—Ä—É—á–Ω—É—é –≤–≤–µ—Å—Ç–∏:
- –õ–æ–≥–∏—Å—Ç–∏—á–µ—Å–∫—É—é —Å—Ç–∞–≤–∫—É –¥–ª—è Highway –ñ–î
- –ï–¥–∏–Ω—É—é —Å—Ç–∞–≤–∫—É –ø–æ—à–ª–∏–Ω—ã –¥–ª—è Contract/Prologix/Sea Container

**–¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```yaml
# config/categories.yaml
- category: –ù–æ–≤–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è
  material: ''
  tnved_code: ''
  duty_rate: 0%
  vat_rate: 20%
  rates:
    rail_base: 0  # –ü—É—Å—Ç–∞—è —Å—Ç–∞–≤–∫–∞ ‚Üí —Ç—Ä–µ–±—É–µ—Ç —Ä—É—á–Ω–æ–≥–æ –≤–≤–æ–¥–∞
    air_base: 0
```

**–ü—Ä–æ–±–ª–µ–º–∞:**
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ ‚Üí –°–∏—Å—Ç–µ–º–∞ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∫–∞–∫ "–ù–æ–≤–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è"
2. –ù–∞ –≠—Ç–∞–ø–µ 2 –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ ‚Üí –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç `custom_rate=4`
3. –ù–∞–∂–∏–º–∞–µ—Ç "–†–∞—Å—Å—á–∏—Ç–∞—Ç—å" ‚Üí –¶–∏—Ñ—Ä—ã –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ ‚Üí –°–æ—Ö—Ä–∞–Ω–µ–Ω–æ –≤ –ë–î
4. **–ù–û:** –í –ë–î —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ `category="–ù–æ–≤–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è"` –±–µ–∑ `custom_rate`
5. –ü—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –∏–∑ –∏—Å—Ç–æ—Ä–∏–∏ ‚Üí `rail_base=0` + `custom_logistics=null` ‚Üí –¶–∏—Ñ—Ä—ã –ù–ï–í–ï–†–ù–´–ï

**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:**
- üî¥ **–ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô**: –§—É–Ω–∫—Ü–∏—è –ø–æ–ª–Ω–æ—Å—Ç—å—é –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- üî¥ **–í–´–°–û–ö–ò–ô**: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç –¥–∞–Ω–Ω—ã–µ –∑—Ä—è (–æ–Ω–∏ –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è)
- üü° **–°–†–ï–î–ù–ò–ô**: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∫–ª–∏–µ–Ω—Ç–æ–≤: "—Ü–µ–Ω—ã –≤ –∏—Å—Ç–æ—Ä–∏–∏ –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç"

---

## üü° –í–´–°–û–ö–ò–ï –ü–†–û–ë–õ–ï–ú–´ (—É—Å–ª–æ–∂–Ω—è—é—Ç —Ä–∞–∑–≤–∏—Ç–∏–µ)

### 4. **–î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–æ–≥–∏–∫–∏ —Ä–∞—Å—á—ë—Ç–∞ –º–∞—Ä—à—Ä—É—Ç–æ–≤**

**–û–ø–∏—Å–∞–Ω–∏–µ:**
–ö–∞–∂–¥—ã–π –º–∞—Ä—à—Ä—É—Ç —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –ø–æ-—Å–≤–æ–µ–º—É, –Ω–æ —É –≤—Å–µ—Ö –µ—Å—Ç—å –æ–±—â–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:

**–û–±—â–∏–µ –¥–ª—è –í–°–ï–• –º–∞—Ä—à—Ä—É—Ç–æ–≤:**
```python
# 1. –°—Ç–æ–∏–º–æ—Å—Ç—å —Ç–æ–≤–∞—Ä–∞ —Å –∫–æ–º–∏—Å—Å–∏–µ–π –¢–æ–Ω–∏ (5%)
goods_with_toni_rub = base_goods_cost_yuan * (1 + 5/100) * yuan_to_rub

# 2. –õ–æ–∫–∞–ª—å–Ω–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞ (2¬•/–∫–≥)
local_delivery = 2 * weight_kg * yuan_to_rub * quantity

# 3. –ó–∞–±–æ—Ä –ú–°–ö (1000‚ÇΩ –Ω–∞ –≤–µ—Å—å —Ç–∏—Ä–∞–∂)
msk_pickup = 1000

# 4. –ü—Ä–æ—á–∏–µ —Ä–∞—Å—Ö–æ–¥—ã (2.5%)
other_costs = (goods + local_delivery) * 0.025
```

**–ù–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã 3 –†–ê–ó–ê —Å —Ä–∞–∑–Ω—ã–º–∏ –Ω–∞–∑–≤–∞–Ω–∏—è–º–∏:**

```python
# –í calculate_prologix_cost (—Å—Ç—Ä–æ–∫–∏ 300-302)
goods_with_toni_rub = base_goods_cost_yuan * (1 + 5/100) * yuan_to_rub

# –í calculate_sea_container_cost (—Å—Ç—Ä–æ–∫–∏ 680-682)
goods_with_toni_rub = base_goods_cost_yuan * (1 + 5/100) * yuan_to_rub

# –í calculate_cost –¥–ª—è Highway (—Å—Ç—Ä–æ–∫–∏ 1120-1130)
goods_with_transfer = base_price_yuan * 1.05 * 1.18 * yuan_to_rub  # ‚ö†Ô∏è –î—Ä—É–≥–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ!
```

**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:**
- üü° **–°–†–ï–î–ù–ò–ô**: –ï—Å–ª–∏ –º–µ–Ω—è–µ–º –∫–æ–º–∏—Å—Å–∏—é –¢–æ–Ω–∏ —Å 5% –Ω–∞ 6% ‚Üí –Ω–∞–¥–æ –æ–±–Ω–æ–≤–ª—è—Ç—å 5 –º–µ—Å—Ç
- üü° **–°–†–ï–î–ù–ò–ô**: –†–∏—Å–∫ –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è (–≥–¥–µ-—Ç–æ –æ–±–Ω–æ–≤–∏–ª–∏, –≥–¥–µ-—Ç–æ –∑–∞–±—ã–ª–∏)
- üü¢ **–ù–ò–ó–ö–ò–ô**: –£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —Ä–∞–∑–º–µ—Ä –∫–æ–¥–∞ (+500 —Å—Ç—Ä–æ–∫ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è)

---

### 5. **–°–º–µ—à–∏–≤–∞–Ω–∏–µ —É—Ä–æ–≤–Ω–µ–π –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–∏ –≤ `calculate_cost()`**

**–û–ø–∏—Å–∞–Ω–∏–µ:**
–ú–µ—Ç–æ–¥ `calculate_cost()` (1,896 —Å—Ç—Ä–æ–∫) –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ:
1. –ó–∞–≥—Ä—É–∂–∞–µ—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏—é –∏–∑ –ë–î
2. –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç –ø–ª–æ—Ç–Ω–æ—Å—Ç—å
3. **–í—ã—á–∏—Å–ª—è–µ—Ç Highway –ñ–î –Ω–∞–ø—Ä—è–º—É—é (200 —Å—Ç—Ä–æ–∫)**
4. –í—ã–∑—ã–≤–∞–µ—Ç `calculate_prologix_cost()`
5. –í—ã–∑—ã–≤–∞–µ—Ç `calculate_sea_container_cost()`
6. –§–æ—Ä–º–∏—Ä—É–µ—Ç –∏—Ç–æ–≥–æ–≤—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É `result`
7. –ü–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç –∫–æ—Ä–Ω–µ–≤—ã–µ –ø–æ–ª—è (`cost_price`, `sale_price`) –Ω–∞ –æ—Å–Ω–æ–≤–µ cheapest –º–∞—Ä—à—Ä—É—Ç–∞

**–ü—Ä–æ–±–ª–µ–º–∞:**
- Highway –ñ–î/–ê–≤–∏–∞ –≤—Å—Ç—Ä–æ–µ–Ω—ã –≤ `calculate_cost`, –∞ Prologix/Sea Container - –æ—Ç–¥–µ–ª—å–Ω—ã–µ –º–µ—Ç–æ–¥—ã
- –ù–∞—Ä—É—à–µ–Ω–∏–µ –ø—Ä–∏–Ω—Ü–∏–ø–∞ **Single Responsibility**
- –°–ª–æ–∂–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å Highway –ñ–î –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ

**–ü—Ä–∏–º–µ—Ä:**
```python
def calculate_cost(...):
    # ... 100 —Å—Ç—Ä–æ–∫ –æ–±—â–µ–π –ª–æ–≥–∏–∫–∏ ...
    
    # Highway –ñ–î - –í–°–¢–†–û–ï–ù (—Å—Ç—Ä–æ–∫–∏ 1200-1400)
    logistics_rate_usd_per_kg = base_rate + density_surcharge
    logistics_cost_per_unit_rub = weight_kg * logistics_rate_usd_per_kg * usd_to_rub
    # ... –µ—â—ë 100 —Å—Ç—Ä–æ–∫ –¥–ª—è Highway –ñ–î ...
    
    # Prologix - –û–¢–î–ï–õ–¨–ù–´–ô –ú–ï–¢–û–î
    prologix_result = calculate_prologix_cost(...)
    
    # Sea Container - –û–¢–î–ï–õ–¨–ù–´–ô –ú–ï–¢–û–î
    sea_result = calculate_sea_container_cost(...)
```

**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:**
- üü° **–°–†–ï–î–ù–ò–ô**: –¢—è–∂–µ–ª–æ –ø–æ–Ω—è—Ç—å –ª–æ–≥–∏–∫—É (–Ω–∞–¥–æ —á–∏—Ç–∞—Ç—å 1,896 —Å—Ç—Ä–æ–∫)
- üü° **–°–†–ï–î–ù–ò–ô**: –ù–µ–ª—å–∑—è –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å Highway –ñ–î –æ—Ç–¥–µ–ª—å–Ω–æ
- üü¢ **–ù–ò–ó–ö–ò–ô**: –°–ª–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å 6-–π –º–∞—Ä—à—Ä—É—Ç (–Ω–µ–ø–æ–Ω—è—Ç–Ω–æ –∫—É–¥–∞ –≤—Å—Ç—Ä–∞–∏–≤–∞—Ç—å)

---

### 6. **–†—É—á–Ω–æ–π –ø–µ—Ä–µ—Å—á—ë—Ç –∫–æ—Ä–Ω–µ–≤—ã—Ö –ø–æ–ª–µ–π –ø–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è custom_rate**

**–û–ø–∏—Å–∞–Ω–∏–µ:**
–í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ —Ä–∞—Å—á—ë—Ç–∞ –µ—Å—Ç—å –∫–æ—Ä–Ω–µ–≤—ã–µ –ø–æ–ª—è:
```python
result = {
    "cost_price": {"total": {"rub": X}, "per_unit": {"rub": Y}},
    "sale_price": {"total": {"rub": X}, "per_unit": {"rub": Y}},
    "profit": {"total": {"rub": X}, "per_unit": {"rub": Y}},
    "routes": {
        "highway_rail": {...},
        "prologix": {...},
        # ...
    }
}
```

**–ü—Ä–æ–±–ª–µ–º–∞:**
1. –°–Ω–∞—á–∞–ª–∞ –∫–æ—Ä–Ω–µ–≤—ã–µ –ø–æ–ª—è –∑–∞–ø–æ–ª–Ω—è—é—Ç—Å—è –Ω–∞ –æ—Å–Ω–æ–≤–µ Highway –ñ–î (—Å—Ç—Ä–æ–∫–∏ 1764-1793)
2. –ü–æ—Ç–æ–º –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è `custom_rate` –¥–ª—è –º–∞—Ä—à—Ä—É—Ç–æ–≤ (—Å—Ç—Ä–æ–∫–∏ 1513-1526, 1571-1576)
3. –ú–∞—Ä—à—Ä—É—Ç—ã –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è, –ù–û –∫–æ—Ä–Ω–µ–≤—ã–µ –ø–æ–ª—è –æ—Å—Ç–∞—é—Ç—Å—è —Å—Ç–∞—Ä—ã–º–∏
4. –ü—Ä–∏—Ö–æ–¥–∏—Ç—Å—è –∏—Å–∫–∞—Ç—å cheapest –º–∞—Ä—à—Ä—É—Ç –∏ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞—Ç—å –∫–æ—Ä–Ω–µ–≤—ã–µ –ø–æ–ª—è (—Å—Ç—Ä–æ–∫–∏ 1813-1860)

**–ö–æ–¥:**
```python
# –°—Ç—Ä–æ–∫–∏ 1764-1793: –ü–µ—Ä–≤—ã–π —Ä–∞—Å—á—ë—Ç (–Ω–∞ –æ—Å–Ω–æ–≤–µ Highway –ñ–î)
result["cost_price"] = {"total": {"rub": highway_rail_cost}, ...}

# –°—Ç—Ä–æ–∫–∏ 1513-1526: –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ custom_rate ‚Üí Highway –ñ–î –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è
if custom_rates and 'highway_rail' in custom_rates:
    # –ü–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ–º –ª–æ–≥–∏—Å—Ç–∏–∫—É
    logistics_cost_per_unit_rub = ...
    # –ù–û –∫–æ—Ä–Ω–µ–≤—ã–µ –ø–æ–ª—è –ù–ï –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è!

# –°—Ç—Ä–æ–∫–∏ 1813-1860: –ö–û–°–¢–´–õ–¨ - –∏—â–µ–º cheapest –∏ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ–º
cheapest_route_key = None
cheapest_cost = float('inf')
for route_key, route_data in result.get('routes', {}).items():
    if route_cost < cheapest_cost:
        cheapest_route_key = route_key

result["cost_price"] = cheapest_route["cost_price"]  # –ü–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ–º –∑–∞–Ω–æ–≤–æ!
```

**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:**
- üü° **–°–†–ï–î–ù–ò–ô**: –î–∞–Ω–Ω—ã–µ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –î–í–ê –†–ê–ó–ê (–Ω–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ)
- üü° **–°–†–ï–î–ù–ò–ô**: –õ–æ–≥–∏–∫–∞ —Ä–∞–∑–±—Ä–æ—Å–∞–Ω–∞ –ø–æ 3 –º–µ—Å—Ç–∞–º
- üü° **–°–†–ï–î–ù–ò–ô**: –ü—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –Ω–æ–≤–æ–≥–æ –ø–æ–ª—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, `profit_margin`) –Ω–∞–¥–æ –æ–±–Ω–æ–≤–ª—è—Ç—å 3 –º–µ—Å—Ç–∞

---

## üü¢ –°–†–ï–î–ù–ò–ï –ü–†–û–ë–õ–ï–ú–´ (–º–æ–∂–Ω–æ –æ—Ç–ª–æ–∂–∏—Ç—å)

### 7. **–ù–µ—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –Ω–∞ –≤—Ö–æ–¥–µ API**

**–û–ø–∏—Å–∞–Ω–∏–µ:**
```python
class CalculationRequest(BaseModel):
    weight_kg: Optional[float] = None          # –ú–æ–∂–µ—Ç –±—ã—Ç—å None!
    packing_box_weight: Optional[float] = None  # –¢–æ–∂–µ None
    packing_units_per_box: Optional[int] = None # –ò —ç—Ç–æ None
```

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ú–æ–∂–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å `weight_kg=None` + `packing_box_weight=None` ‚Üí —Ä–∞—Å—á—ë—Ç —É–ø–∞–¥—ë—Ç —Å `NaN`
- –ú–æ–∂–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å `duty_type="combined"` –±–µ–∑ `specific_rate` ‚Üí –æ—à–∏–±–∫–∞ –≤ —Å–µ—Ä–µ–¥–∏–Ω–µ —Ä–∞—Å—á—ë—Ç–∞

**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:**
- üü¢ **–ù–ò–ó–ö–ò–ô**: –û—à–∏–±–∫–∏ –ø—Ä–æ–∏—Å—Ö–æ–¥—è—Ç –≥–ª—É–±–æ–∫–æ –≤ –∫–æ–¥–µ (—Å–ª–æ–∂–Ω–æ –æ—Ç–ª–∞–∂–∏–≤–∞—Ç—å)
- üü¢ **–ù–ò–ó–ö–ò–ô**: –ù–µ—Ç –ø–æ–Ω—è—Ç–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

---

### 8. **–•—Ä—É–ø–∫–∞—è —Å–∏—Å—Ç–µ–º–∞ custom_logistics (–Ω–µ—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Ç–∏–ø–æ–≤)**

**–û–ø–∏—Å–∞–Ω–∏–µ:**
```python
custom_logistics = {
    "highway_rail": {
        "custom_rate": "—á–µ—Ç—ã—Ä–µ",  # ‚ùå –°—Ç—Ä–æ–∫–∞ –≤–º–µ—Å—Ç–æ —á–∏—Å–ª–∞!
        "duty_type": "specific",  # ‚úÖ OK
        "specific_rate": null     # ‚ùå –î–æ–ª–∂–µ–Ω –±—ã—Ç—å –∑–∞–ø–æ–ª–Ω–µ–Ω –¥–ª—è "specific"!
    }
}
```

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ù–µ—Ç Pydantic –º–æ–¥–µ–ª–∏ –¥–ª—è `custom_logistics` ‚Üí –º–æ–∂–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å —á—Ç–æ —É–≥–æ–¥–Ω–æ
- –û—à–∏–±–∫–∞ –æ–±–Ω–∞—Ä—É–∂–∏—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ `calculate_combined_duty()` ‚Üí –¥–∞–ª–µ–∫–æ –æ—Ç –≤—Ö–æ–¥–Ω–æ–π —Ç–æ—á–∫–∏

**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:**
- üü¢ **–ù–ò–ó–ö–ò–ô**: –°–ª–æ–∂–Ω–æ –æ—Ç–ª–∞–∂–∏–≤–∞—Ç—å (–≥–¥–µ –∏–º–µ–Ω–Ω–æ –æ—à–∏–±–∫–∞?)
- üü¢ **–ù–ò–ó–ö–ò–ô**: –ù–µ—Ç –∞–≤—Ç–æ–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ (–∫–∞–∫–∏–µ –ø–æ–ª—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ?)

---

### 9. **–ò–∑–±—ã—Ç–æ—á–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞**

**–û–ø–∏—Å–∞–Ω–∏–µ:**
```python
print(f"üîß –û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –∫–∞—Å—Ç–æ–º–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã: {custom_logistics_params}")
print(f"   –¢–∏–ø: {type(custom_logistics_params)}")
print(f"   –ö–ª—é—á–∏: {list(custom_logistics_params.keys())}")
print(f"   üîç –û–±—Ä–∞–±–æ—Ç–∫–∞ –º–∞—Ä—à—Ä—É—Ç–∞: {route_key}")
print(f"      –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: {params}")
print(f"      –¢–∏–ø –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤: {type(params)}")
print(f"   ‚úÖ {route_key}: custom_rate = {params['custom_rate']}")
```

**–ü—Ä–æ–±–ª–µ–º–∞:**
- 7 —Å—Ç—Ä–æ–∫ –ª–æ–≥–æ–≤ –¥–ª—è –ö–ê–ñ–î–û–ì–û —Ä–∞—Å—á—ë—Ç–∞
- –ü—Ä–∏ 100 —Ä–∞—Å—á—ë—Ç–æ–≤ –≤ –¥–µ–Ω—å ‚Üí 700 —Å—Ç—Ä–æ–∫ –ª–æ–≥–æ–≤
- Railway: –ø–ª–∞—Ç–Ω—ã–π –ø–ª–∞–Ω –∑–∞ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –ª–æ–≥–æ–≤

**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:**
- üü¢ **–ù–ò–ó–ö–ò–ô**: –ó–∞–º–µ–¥–ª—è–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (–Ω–µ–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ)
- üü¢ **–ù–ò–ó–ö–ò–ô**: –£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —Ä–∞—Å—Ö–æ–¥—ã –Ω–∞ Railway
- üü¢ **–ù–ò–ó–ö–ò–ô**: –°–ª–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ –≤–∞–∂–Ω—ã–µ –ª–æ–≥–∏ —Å—Ä–µ–¥–∏ debug-–º—É—Å–æ—Ä–∞

---

## üìà IMPACT MATRIX (–≤–ª–∏—è–Ω–∏–µ vs. —Å–ª–æ–∂–Ω–æ—Å—Ç—å)

```
–í—ã—Å–æ–∫–æ–µ –≤–ª–∏—è–Ω–∏–µ
‚îÇ
‚îÇ  1Ô∏è‚É£ custom_logistics      2Ô∏è‚É£ –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ
‚îÇ     –≤ –ë–î                    –≤—ã–∑–æ–≤–æ–≤
‚îÇ     (–ö—Ä–∏—Ç–∏—á–Ω–æ!)            (–ö—Ä–∏—Ç–∏—á–Ω–æ!)
‚îÇ                           
‚îÇ                           
‚îÇ  3Ô∏è‚É£ "–ù–æ–≤–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è"    4Ô∏è‚É£ –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ
‚îÇ     –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏      –±–∞–∑–æ–≤—ã—Ö —Ä–∞—Å—á—ë—Ç–æ–≤
‚îÇ     (–ö—Ä–∏—Ç–∏—á–Ω–æ!)            (–í—ã—Å–æ–∫–æ–µ)
‚îÇ
‚îÇ                           5Ô∏è‚É£ BaseRoute
‚îÇ                              —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥
‚îÇ                              (–í—ã—Å–æ–∫–æ–µ)
‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚Üí –°–ª–æ–∂–Ω–æ—Å—Ç—å
   –ù–∏–∑–∫–∞—è                           –í—ã—Å–æ–∫–∞—è

–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: –ù–∞—á–∞—Ç—å —Å 1Ô∏è‚É£ –∏ 2Ô∏è‚É£ (–∫—Ä–∏—Ç–∏—á–Ω–æ + –Ω–∏–∑–∫–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å)
```

---

## üéØ –û–¶–ï–ù–ö–ê –¢–†–£–î–û–ó–ê–¢–†–ê–¢

### –≠—Ç–∞–ø 0-2 (–ö–†–ò–¢–ò–ß–ï–°–ö–û–ï) - 5 –¥–Ω–µ–π
- –î–µ–Ω—å 1-2: –ú–∏–≥—Ä–∞—Ü–∏—è –ë–î + Pydantic –º–æ–¥–µ–ª–∏
- –î–µ–Ω—å 3: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ/–∑–∞–≥—Ä—É–∑–∫–∞ custom_logistics
- –î–µ–Ω—å 4: Helper –¥–ª—è —É–Ω–∏—Ñ–∏–∫–∞—Ü–∏–∏ –≤—ã–∑–æ–≤–æ–≤
- –î–µ–Ω—å 5: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

**–í—ã–≥–æ–¥–∞:**
- ‚úÖ "–ù–æ–≤–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è" –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ –ö–∞—Å—Ç–æ–º–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è
- ‚úÖ –ù–æ–≤—ã–µ –ø–æ–ª—è –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –≤ 1 –º–µ—Å—Ç–µ

---

### –≠—Ç–∞–ø 3-4 (–í–´–°–û–ö–û–ï) - 7 –¥–Ω–µ–π
- –î–µ–Ω—å 6-7: CostComponents (–±–∞–∑–æ–≤—ã–µ —Ä–∞—Å—á—ë—Ç—ã)
- –î–µ–Ω—å 8-10: BaseRoute + —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –º–∞—Ä—à—Ä—É—Ç–æ–≤
- –î–µ–Ω—å 11: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è + —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

**–í—ã–≥–æ–¥–∞:**
- ‚úÖ –ö–æ–¥ —Å–æ–∫—Ä–∞—â—ë–Ω —Å 4,600 –¥–æ ~2,000 —Å—Ç—Ä–æ–∫
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –º–∞—Ä—à—Ä—É—Ç–∞: 1 –¥–µ–Ω—å
- ‚úÖ –ö–∞–∂–¥—ã–π –º–∞—Ä—à—Ä—É—Ç –ª–µ–≥–∫–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å

---

### –≠—Ç–∞–ø 5 (–û–ü–¶–ò–û–ù–ê–õ–¨–ù–û) - 2 –¥–Ω—è
- –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞—Å—á—ë—Ç–æ–≤
- –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π

---

## üö¶ –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–Ø

### ‚úÖ –ù–∞—á–∞—Ç—å –°–ï–ô–ß–ê–° —Å –≠—Ç–∞–ø–∞ 0-2 (–∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ)

**–ü—Ä–∏—á–∏–Ω—ã:**
1. "–ù–æ–≤–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è" –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç ‚Üí –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –Ω–µ –º–æ–≥—É—Ç —Ä–∞—Å—á–∏—Ç–∞—Ç—å –Ω–µ—Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã
2. –ö–∞—Å—Ç–æ–º–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ç–µ—Ä—è—é—Ç—Å—è ‚Üí –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Ç–µ—Ä—è—é—Ç –¥–æ–≤–µ—Ä–∏–µ
3. –í—ã—Å–æ–∫–∏–π —Ä–∏—Å–∫ –æ—à–∏–±–æ–∫ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –Ω–æ–≤—ã—Ö –ø–æ–ª–µ–π

**–ü–ª–∞–Ω:**
```
–ù–µ–¥–µ–ª—è 1: –≠—Ç–∞–ø—ã 0-2 (–∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ)
  ‚îú‚îÄ –î–µ–Ω—å 1-2: –ë–î + –º–æ–¥–µ–ª–∏
  ‚îú‚îÄ –î–µ–Ω—å 3: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
  ‚îú‚îÄ –î–µ–Ω—å 4: Helper
  ‚îî‚îÄ –î–µ–Ω—å 5: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ù–µ–¥–µ–ª—è 2-3: –≠—Ç–∞–ø—ã 3-4 (–≤—ã—Å–æ–∫–æ–µ)
  ‚îú‚îÄ –î–µ–Ω—å 6-7: CostComponents
  ‚îú‚îÄ –î–µ–Ω—å 8-10: BaseRoute
  ‚îî‚îÄ –î–µ–Ω—å 11: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ü–æ–∑–∂–µ: –≠—Ç–∞–ø 5 (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
```

---

## üìù –ß–ï–ö–õ–ò–°–¢ –ü–ï–†–ï–î –°–¢–ê–†–¢–û–ú

- [ ] –°–æ–∑–¥–∞—Ç—å –±—ç–∫–∞–ø –ë–î (SQLite + PostgreSQL)
- [ ] –°–æ–∑–¥–∞—Ç—å –≤–µ—Ç–∫—É `refactoring/v2-with-custom-params`
- [ ] –ù–∞–ø–∏—Å–∞—Ç—å baseline —Ç–µ—Å—Ç—ã (—Ç–µ–∫—É—â–∏–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª)
- [ ] –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –ø–ª–∞–Ω –æ—Ç–∫–∞—Ç–∞
- [ ] –î–æ–≥–æ–≤–æ—Ä–∏—Ç—å—Å—è –æ –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥

---

## üìö –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –î–û–ö–£–ú–ï–ù–¢–´

1. **REFACTORING_PLAN_V2.md** - –¥–µ—Ç–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏ –∫–æ–¥–∞
2. **ARCHITECTURE_IMPROVEMENT_PLAN.md** - –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ–µ –≤–∏–¥–µ–Ω–∏–µ (—Å—Ç–∞—Ä–∞—è –≤–µ—Ä—Å–∏—è)
3. **CALCULATION_FORMULAS.md** - —Ñ–æ—Ä–º—É–ª—ã —Ä–∞—Å—á—ë—Ç–∞ (–µ–¥–∏–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –∏—Å—Ç–∏–Ω—ã)

---

**–ì–æ—Ç–æ–≤ –Ω–∞—á–∏–Ω–∞—Ç—å? –ù–∞—á–Ω—ë–º —Å —Å–æ–∑–¥–∞–Ω–∏—è –≤–µ—Ç–∫–∏ –∏ –±—ç–∫–∞–ø–∞ –ë–î!** üöÄ







